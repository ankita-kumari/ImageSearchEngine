function Placeholdem(t){"use strict";!function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var n=(new Date).getTime(),o=Math.max(0,16-(n-t)),r=window.setTimeout(function(){e(n+o)},o);return t=n+o,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var e={};return e.customElems=["password"],e.defaultInputAttributeName="data-defaultinputtype",e.init=function(){if(e.elems=[],t&&t.length)for(var i=0;i<t.length;i++)e.hasPlaceholder(t[i])&&e.elems.push(new e.PlaceholdemElem(t[i]));else t&&e.hasPlaceholder(t)&&e.elems.push(new e.PlaceholdemElem(t))},e.hasPlaceholder=function(t){return"function"==typeof t.hasAttribute&&t.hasAttribute("placeholder")},e.PlaceholdemElem=function(t){var i=this;i.init=function(){i.elem=t,i.form=t.form,i.placeholder=i.elem.getAttribute("placeholder"),i.elem.removeAttribute("placeholder"),i.rAF=null,i.animating=0,i.elem.setAttribute("data-placeholder",i.placeholder),i.elem.setAttribute("data-animating",i.animating),i.defaultInputType=i.elem.getAttribute("type"),i.resetDefaultType(),i.elem.value||(i.elem.value=i.placeholder),i.on(i.elem,"focus",i.onFocus),i.on(i.elem,"blur",i.onBlur),i.on(i.elem,"keydown",i.onKeydown),i.form&&i.on(i.form,"reset",i.onReset)},i.on=function(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent("on"+e,i)},i.onFocus=function(){(i.animating||i.elem.value===i.placeholder)&&(i.animating=1,i.elem.setAttribute("data-animating",i.animating),window.cancelAnimationFrame(i.rAF),i.deletePlaceholder(),i.restoreDefaultType())},i.onBlur=function(){(i.animating||""===i.elem.value)&&(i.animating=1,i.elem.setAttribute("data-animating",i.animating),window.cancelAnimationFrame(i.rAF),i.restorePlaceholder(),i.resetDefaultType())},i.onKeydown=function(){i.animating&&(i.animating=0,i.elem.setAttribute("data-animating",i.animating),window.cancelAnimationFrame(i.rAF),i.elem.value="")},i.onReset=function(){setTimeout(function(){i.onBlur()})},i.deletePlaceholder=function(){i.elem.value.length>0?(i.elem.value=i.elem.value.slice(0,-1),i.rAF=window.requestAnimationFrame(i.deletePlaceholder)):(i.animating=0,i.elem.setAttribute("data-animating",i.animating))},i.restorePlaceholder=function(){i.elem.value.length<i.placeholder.length?(i.elem.value+=i.placeholder[i.elem.value.length],i.rAF=window.requestAnimationFrame(i.restorePlaceholder)):(i.animating=0,i.elem.setAttribute("data-animating",i.animating))},i.restoreDefaultType=function(){var t=i.elem.getAttribute(e.defaultInputAttributeName);t&&-1!=e.customElems.indexOf(t)&&t!=i.elem.getAttribute("type")&&i.elem.setAttribute("type",t)},i.resetDefaultType=function(){-1!=e.customElems.indexOf(i.defaultInputType)&&(i.elem.setAttribute(e.defaultInputAttributeName,i.defaultInputType),i.elem.setAttribute("type","text"))},i.init()},e.init(),e}function goHome(){window.location="/"}function hasScrolled(){var t=$(this).scrollTop();0>=t&&$("nav").removeClass("nav-up").addClass("nav-down"),Math.abs(lastScrollTop-t)<=delta||(t>lastScrollTop&&t>navbarHeight?$("nav").removeClass("nav-down").addClass("nav-up"):_mip.isRendering||t+$(window).height()<$(document).height()&&$("nav").removeClass("nav-up").addClass("nav-down"),lastScrollTop=t,lastScrollTop>1010&&showPrmPopUp())}function removeAllPopovers(){$currentPopover&&!Modernizr.touch&&($($currentPopover).popover("hide"),$currentPopover="")}function checkGNavPos(){var t=$(".sortd").length>0?!0:!1,e=$("body").hasClass("hasJumbotron"),i=e?.75*parseFloat($(window).height()):55;$("body").hasClass("hasProfileTop")&&(i=380);var n=300,o=parseFloat($("body").scrollTop()),r=parseFloat($(window).height()),a=0;($(".sticky").length>0||$("#wrapper").hasClass("srchopen"))&&(a+=60),"none"!=$(".scrllInterface").css("display")&&i>o||n>r?(a+=i-o+20,t&&($("#wrapper .page-content .sort").css({top:a}),a+=45),$("#wrapper .gnav").css({top:a})):(t&&$("#wrapper .page-content .sort").css({top:a+80}),$("#wrapper .gnav").css({top:"auto"}))}function encodeHTML(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/#/g,"%23").replace(/ /g,"%20")}function setContxtMod(t){$.contextMenu({zIndex:9999,selector:t,build:function(t,e){var i={openwin:{name:"Open in new window"},openjpg:{name:"View jpeg"}};return __mipo.moderator&&(t.attr("data-hashtag")&&(i.removeq={name:"Remove from Quest"}),t.find(".unapproved").length>0?i.approve={name:"Approve image"}:t.find(".featured").length<=0&&(i.feature={name:"Feature image"}),i.reject={name:"Reject image"},i["delete"]={name:"Delete"}),{callback:function(e,i){var n,o,r=t.attr("data-id");switch(e){case"openwin":n="/p/"+t.attr("data-id"),o=window.open(n,"_blank"),o.focus();break;case"openjpg":n=t.attr("data-jpg"),o=window.open(n,"_blank"),o.focus();break;case"delete":confirm("Delete this image?")===!0&&commitModFunction(r,"/image/deleteimg");break;case"reject":confirm("Reject this image?")===!0&&commitModFunction(r,"/image/rejectimg");break;case"removeq":confirm("Remove this image from a quest?")===!0&&$.ajax({method:"POST",data:{imgid:r,hashtag:t.attr("data-hashtag")},dataType:"json",url:"/quest/remove",success:function(t){_scrolld.refresh()}});break;case"approve":commitModFunction(r,"/image/acceptimg");break;case"feature":commitModFunction(r,"/image/addfeature",function(){alert("Image added to feature")})}},items:i}}})}function commitModFunction(t,e,i){$.ajax({method:"POST",data:{files:t},dataType:"json",url:e,success:function(t){i?i():_scrolld.refresh()}})}function createSurvey(t){$(".innr.thanks").hide(),$(".innr.form").show();$("#sldrAdjstSurvy").slider();$("#sldrAdjstSurvy").slider("setValue",5),$(t).find(".submit").off("click").on("click",function(){var e=$(t).find(".feedbk").val(),i=$("#sldrAdjstSurvy").val();$.ajax({method:"POST",data:{message:e,rank:i},dataType:"json",url:"/feedback",success:function(t){}}),$(".innr.form").fadeOut("fast",function(){$(".innr.thanks").fadeIn("fast"),setTimeout(function(){$(".modal").modal("hide")},1e3)})})}function getClickPosition(t){t.clientX,t.clientY}function altSearchClick(){var t=$("#altSearch").val();t&&(t=t.sanitize(),window.open("http://istockphoto.7eer.net/c/160458/258922/4205?subId1=SearchBox&sharedid=SearchBox&url=http://www.istockphoto.com/photos/"+t),_scrolld&&_scrolld.changeAffiliate("iStock"),_mip.track("Affiliate","SearchboxIStock",t))}function pickRndmiSTCK(){return"undefined"!=typeof istckMSGS?istckMSGS[Math.floor(Math.random()*istckMSGS.length)]:{msg:"Explore millions of royalty-free images, illustrations and videos at ridiculously great prices",id:"0_default"}}function showPrmPopUp(){if(!___ad_prompt){var t="V5S1R0PgbB",e=_mip.getCookie(t);if(!e){var i=pickRndmiSTCK(),n=new Date;n.setDate(n.getDate()+1),_mip.setCookie(t,1,n),___ad_prompt=!0;var o=Math.floor(2*Math.random()+1);_mip.track("iStock_ads","View","Popup_"+i.id),$("#pop-up-istock-prmosroll .istck_msg_txt").html(i.msg),$("#pop-up-istock-prmosroll").addClass("pop-up-istock-prmosroll-bg"+o),$("#pop-up-istock-prmosroll").fadeIn(),$("#pop-up-istock-prmosroll .close-pop").on("click",function(t){return t.stopPropagation(),$("#pop-up-istock-prmosroll").fadeOut(),_mip.track("iStock_ads","Close","Popup_"+i.id),!1}),$("#pop-up-istock-prmosroll").on("click",function(t){_mip.track("iStock_ads","Click","Popup_"+o),window.open("http://istockphoto.7eer.net/c/160458/258922/4205?subId1=popupscroll_bg_"+o+"&sharedid=popupscroll_bg_"+o+"&url=http://www.istockphoto.com/plans-and-pricing")})}}}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)}}(),window.requestTimeout=function(t,e){function i(){var r=(new Date).getTime(),a=r-n;a>=e?t.call():o.value=requestAnimFrame(i)}if(!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame&&window.mozCancelRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame))return window.setTimeout(t,e);var n=(new Date).getTime(),o={};return o.value=requestAnimFrame(i),o},window.clearRequestTimeout=function(t){window.cancelAnimationFrame?window.cancelAnimationFrame(t.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(t.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(t.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(t.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(t.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(t.value):clearTimeout(t)},window.requestInterval=function(t,e){function i(){var r=(new Date).getTime(),a=r-n;a>=e&&(t.call(),n=(new Date).getTime()),o.value=requestAnimFrame(i)}if(!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame&&window.mozCancelRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame))return window.setInterval(t,e);var n=(new Date).getTime(),o={};return o.value=requestAnimFrame(i),o},window.clearRequestInterval=function(t){window.cancelAnimationFrame?window.cancelAnimationFrame(t.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(t.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(t.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(t.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(t.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(t.value):clearInterval(t)},+function(t){"use strict";var e=!1,i=function(i,n){var o=this;this.init("confirmation",i,n),t(i).on("show.bs.confirmation",function(e){o.options.onShow(e,this),t(this).addClass("open");var i=o.options,n=i.all_selector;i.singleton&&t(n).not(o.$element).each(function(){t(this).hasClass("open")&&t(this).confirmation("hide")})}),t(i).on("hide.bs.confirmation",function(e){o.options.onHide(e,this),t(this).removeClass("open")}),t(i).on("shown.bs.confirmation",function(i){{var n=o.options;n.all_selector}o.isPopout()&&(e||(e=t("body").on("click",function(i){o.$element.is(i.target)||o.$element.has(i.target).length||t(".popover").has(i.target).length||(o.hide(),o.inState.click=!1,t("body").unbind(i),e=!1)})))}),n.selector?t(i).on("click.bs.confirmation",n.selector,function(t){t.preventDefault()}):t(i).on("click.bs.confirmation",function(t){t.preventDefault()})};if(!t.fn.popover||!t.fn.tooltip)throw new Error("Confirmation requires popover.js and tooltip.js");i.VERSION="1.0.5",i.DEFAULTS=t.extend({},t.fn.popover.Constructor.DEFAULTS,{placement:"right",title:"Are you sure?",btnOkClass:"btn btn-sm btn-danger",btnOkLabel:"Delete",btnOkIcon:"glyphicon glyphicon-ok",btnCancelClass:"btn btn-sm btn-default",btnCancelLabel:"Cancel",btnCancelIcon:"glyphicon glyphicon-remove",href:"#",target:"_self",singleton:!0,popout:!0,onShow:function(t,e){},onHide:function(t,e){},onConfirm:function(t,e){},onCancel:function(t,e){},template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"><a data-apply="confirmation">Yes</a><a data-dismiss="confirmation">No</a></div></div>'}),i.prototype=t.extend({},t.fn.popover.Constructor.prototype),i.prototype.constructor=i,i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.setContent=function(){var e=this,i=this.tip(),n=this.getTitle(),o=i.find('[data-apply="confirmation"]'),r=i.find('[data-dismiss="confirmation"]'),a=this.options;o.addClass(this.getBtnOkClass()).html(this.getBtnOkLabel()).prepend(t("<i></i>").addClass(this.getBtnOkIcon())," ").attr("href",this.getHref()).attr("target",this.getTarget()).off("click").on("click",function(t){a.onConfirm(t,e.$element),"submit"==e.$element.attr("type")&&e.$element.closest("form").first().submit(),e.hide(),e.inState.click=!1}),r.addClass(this.getBtnCancelClass()).html(this.getBtnCancelLabel()).prepend(t("<i></i>").addClass(this.getBtnCancelIcon())," ").off("click").on("click",function(t){a.onCancel(t,e.$element),e.hide(),e.inState.click=!1}),i.find(".popover-title")[this.options.html?"html":"text"](n),i.removeClass("fade top bottom left right in"),i.find(".popover-title").html()||i.find(".popover-title").hide()},i.prototype.getBtnOkClass=function(){var t=this.$element,e=this.options;return t.attr("data-btnOkClass")||("function"==typeof e.btnOkClass?e.btnOkClass.call(this,t[0]):e.btnOkClass)},i.prototype.getBtnOkLabel=function(){var t=this.$element,e=this.options;return t.attr("data-btnOkLabel")||("function"==typeof e.btnOkLabel?e.btnOkLabel.call(this,t[0]):e.btnOkLabel)},i.prototype.getBtnOkIcon=function(){var t=this.$element,e=this.options;return t.attr("data-btnOkIcon")||("function"==typeof e.btnOkIcon?e.btnOkIcon.call(this,t[0]):e.btnOkIcon)},i.prototype.getBtnCancelClass=function(){var t=this.$element,e=this.options;return t.attr("data-btnCancelClass")||("function"==typeof e.btnCancelClass?e.btnCancelClass.call(this,t[0]):e.btnCancelClass)},i.prototype.getBtnCancelLabel=function(){var t=this.$element,e=this.options;return t.attr("data-btnCancelLabel")||("function"==typeof e.btnCancelLabel?e.btnCancelLabel.call(this,t[0]):e.btnCancelLabel)},i.prototype.getBtnCancelIcon=function(){var t=this.$element,e=this.options;return t.attr("data-btnCancelIcon")||("function"==typeof e.btnCancelIcon?e.btnCancelIcon.call(this,t[0]):e.btnCancelIcon)},i.prototype.getHref=function(){var t=this.$element,e=this.options;return t.attr("data-href")||("function"==typeof e.href?e.href.call(this,t[0]):e.href)},i.prototype.getTarget=function(){var t=this.$element,e=this.options;return t.attr("data-target")||("function"==typeof e.target?e.target.call(this,t[0]):e.target)},i.prototype.isPopout=function(){var t,e=this.$element,i=this.options;return t=e.attr("data-popout")||("function"==typeof i.popout?i.popout.call(this,e[0]):i.popout),"false"==t&&(t=!1),t};var n=t.fn.confirmation;t.fn.confirmation=function(e){var n=this;return this.each(function(){var o=t(this),r=o.data("bs.confirmation"),a="object"==typeof e&&e;a=a||{},a.all_selector=n.selector,(r||"destroy"!=e)&&(r||o.data("bs.confirmation",r=new i(this,a)),"string"==typeof e&&r[e]())})},t.fn.confirmation.Constructor=i,t.fn.confirmation.noConflict=function(){return t.fn.confirmation=n,this}}(jQuery),!function(t){var e=function(e,i){this.element=t(e),this.picker=t('<div class="slider"><div class="slider-track"><div class="slider-selection"></div><div class="slider-handle"></div><div class="slider-handle"></div></div><div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div></div>').insertBefore(this.element).append(this.element),this.id=this.element.data("slider-id")||i.id,this.id&&(this.picker[0].id=this.id),"undefined"!=typeof Modernizr&&Modernizr.touch&&(this.touchCapable=!0);var n=this.element.data("slider-tooltip")||i.tooltip;switch(this.tooltip=this.picker.find(".tooltip"),this.tooltipInner=this.tooltip.find("div.tooltip-inner"),this.orientation=this.element.data("slider-orientation")||i.orientation,this.orientation){case"vertical":this.picker.addClass("slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight",this.tooltip.addClass("right")[0].style.left="100%";break;default:this.picker.addClass("slider-horizontal").css("width",this.element.outerWidth()),this.orientation="horizontal",this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth",this.tooltip.addClass("top")[0].style.top=-this.tooltip.outerHeight()-14+"px"}this.min=this.element.data("slider-min")||i.min,this.max=this.element.data("slider-max")||i.max,this.step=this.element.data("slider-step")||i.step,this.value=this.element.data("slider-value")||i.value,this.value[1]&&(this.range=!0),this.selection=this.element.data("slider-selection")||i.selection,this.selectionEl=this.picker.find(".slider-selection"),"none"===this.selection&&this.selectionEl.addClass("hide"),this.selectionElStyle=this.selectionEl[0].style,this.handle1=this.picker.find(".slider-handle:first"),this.handle1Stype=this.handle1[0].style,this.handle2=this.picker.find(".slider-handle:last"),this.handle2Stype=this.handle2[0].style;var o=this.element.data("slider-handle")||i.handle;switch(o){case"round":this.handle1.addClass("round"),this.handle2.addClass("round");break;case"triangle":this.handle1.addClass("triangle"),this.handle2.addClass("triangle")}this.range?(this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0])),this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))):(this.value=[Math.max(this.min,Math.min(this.max,this.value))],this.handle2.addClass("hide"),this.value[1]="after"==this.selection?this.max:this.min),this.diff=this.max-this.min,this.percentage=[100*(this.value[0]-this.min)/this.diff,100*(this.value[1]-this.min)/this.diff,100*this.step/this.diff],this.offset=this.picker.offset(),this.size=this.picker[0][this.sizePos],this.formater=i.formater,this.layout(),this.picker.on(this.touchCapable?{touchstart:t.proxy(this.mousedown,this)}:{mousedown:t.proxy(this.mousedown,this)}),"show"===n?this.picker.on({mouseenter:t.proxy(this.showTooltip,this),mouseleave:t.proxy(this.hideTooltip,this)}):this.tooltip.addClass("hide")};e.prototype={constructor:e,over:!1,inDrag:!1,showTooltip:function(){this.tooltip.addClass("in"),this.over=!0},hideTooltip:function(){this.inDrag===!1&&this.tooltip.removeClass("in"),this.over=!1},layout:function(){this.handle1Stype[this.stylePos]=this.percentage[0]+"%",this.handle2Stype[this.stylePos]=this.percentage[1]+"%","vertical"==this.orientation?(this.selectionElStyle.top=Math.min(this.percentage[0],this.percentage[1])+"%",this.selectionElStyle.height=Math.abs(this.percentage[0]-this.percentage[1])+"%"):(this.selectionElStyle.left=Math.min(this.percentage[0],this.percentage[1])+"%",this.selectionElStyle.width=Math.abs(this.percentage[0]-this.percentage[1])+"%"),this.range?(this.tooltipInner.text(this.formater(this.value[0])+" : "+this.formater(this.value[1])),this.tooltip[0].style[this.stylePos]=this.size*(this.percentage[0]+(this.percentage[1]-this.percentage[0])/2)/100-("vertical"===this.orientation?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px"):(this.tooltipInner.text(this.formater(this.value[0])),this.tooltip[0].style[this.stylePos]=this.size*this.percentage[0]/100-("vertical"===this.orientation?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px")},mousedown:function(e){this.touchCapable&&"touchstart"===e.type&&(e=e.originalEvent),this.offset=this.picker.offset(),this.size=this.picker[0][this.sizePos];var i=this.getPercentage(e);if(this.range){var n=Math.abs(this.percentage[0]-i),o=Math.abs(this.percentage[1]-i);this.dragged=o>n?0:1}else this.dragged=0;this.percentage[this.dragged]=i,this.layout(),t(document).on(this.touchCapable?{touchmove:t.proxy(this.mousemove,this),touchend:t.proxy(this.mouseup,this)}:{mousemove:t.proxy(this.mousemove,this),mouseup:t.proxy(this.mouseup,this)}),this.inDrag=!0;var r=this.calculateValue();return this.element.trigger({type:"slideStart",value:r}).trigger({type:"slide",value:r}),!1},mousemove:function(t){this.touchCapable&&"touchmove"===t.type&&(t=t.originalEvent);var e=this.getPercentage(t);this.range&&(0===this.dragged&&this.percentage[1]<e?(this.percentage[0]=this.percentage[1],this.dragged=1):1===this.dragged&&this.percentage[0]>e&&(this.percentage[1]=this.percentage[0],this.dragged=0)),this.percentage[this.dragged]=e,this.layout();var i=this.calculateValue();return this.element.trigger({type:"slide",value:i}).data("value",i).prop("value",i),!1},mouseup:function(e){t(document).off(this.touchCapable?{touchmove:this.mousemove,touchend:this.mouseup}:{mousemove:this.mousemove,mouseup:this.mouseup}),this.inDrag=!1,0==this.over&&this.hideTooltip(),this.element;var i=this.calculateValue();return this.element.trigger({type:"slideStop",value:i}).data("value",i).prop("value",i),!1},calculateValue:function(){var t;return this.range?(t=[this.min+Math.round(this.diff*this.percentage[0]/100/this.step)*this.step,this.min+Math.round(this.diff*this.percentage[1]/100/this.step)*this.step],this.value=t):(t=this.min+Math.round(this.diff*this.percentage[0]/100/this.step)*this.step,this.value=[t,this.value[1]]),t},getPercentage:function(t){this.touchCapable&&(t=t.touches[0]);var e=100*(t[this.mousePos]-this.offset[this.stylePos])/this.size;return e=Math.round(e/this.percentage[2])*this.percentage[2],Math.max(0,Math.min(100,e))},getValue:function(){return this.range?this.value:this.value[0]},setValue:function(t){this.value=t,this.range?(this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0])),this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))):(this.value=[Math.max(this.min,Math.min(this.max,this.value))],this.handle2.addClass("hide"),this.value[1]="after"==this.selection?this.max:this.min),this.diff=this.max-this.min,this.percentage=[100*(this.value[0]-this.min)/this.diff,100*(this.value[1]-this.min)/this.diff,100*this.step/this.diff],this.layout()}},t.fn.slider=function(i,n){return this.each(function(){var o=t(this),r=o.data("slider"),a="object"==typeof i&&i;r||o.data("slider",r=new e(this,t.extend({},t.fn.slider.defaults,a))),"string"==typeof i&&r[i](n)})},t.fn.slider.defaults={min:0,max:10,step:1,orientation:"horizontal",value:5,selection:"before",tooltip:"show",handle:"round",formater:function(t){return t}},t.fn.slider.Constructor=e}(window.jQuery),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Clipboard=t()}}(function(){var t;return function e(t,i,n){function o(a,s){if(!i[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[a]={exports:{}};t[a][0].call(u.exports,function(e){var i=t[a][1][e];return o(i?i:e)},u,u.exports,e,t,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,i){var n=t("matches-selector");e.exports=function(t,e,i){for(var o=i?t:t.parentNode;o&&o!==document;){if(n(o,e))return o;o=o.parentNode}}},{"matches-selector":5}],2:[function(t,e,i){function n(t,e,i,n,r){var a=o.apply(this,arguments);return t.addEventListener(i,a,r),{destroy:function(){t.removeEventListener(i,a,r)}}}function o(t,e,i,n){return function(i){i.delegateTarget=r(i.target,e,!0),i.delegateTarget&&n.call(t,i)}}var r=t("closest");e.exports=n},{closest:1}],3:[function(t,e,i){i.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},i.nodeList=function(t){var e=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in t&&(0===t.length||i.node(t[0]))},i.string=function(t){return"string"==typeof t||t instanceof String},i.fn=function(t){var e=Object.prototype.toString.call(t);return"[object Function]"===e}},{}],4:[function(t,e,i){function n(t,e,i){if(!t&&!e&&!i)throw new Error("Missing required arguments");if(!s.string(e))throw new TypeError("Second argument must be a String");if(!s.fn(i))throw new TypeError("Third argument must be a Function");if(s.node(t))return o(t,e,i);if(s.nodeList(t))return r(t,e,i);if(s.string(t))return a(t,e,i);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function o(t,e,i){return t.addEventListener(e,i),{destroy:function(){t.removeEventListener(e,i)}}}function r(t,e,i){return Array.prototype.forEach.call(t,function(t){t.addEventListener(e,i)}),{destroy:function(){Array.prototype.forEach.call(t,function(t){t.removeEventListener(e,i)})}}}function a(t,e,i){return l(document.body,t,e,i)}var s=t("./is"),l=t("delegate");e.exports=n},{"./is":3,delegate:2}],5:[function(t,e,i){function n(t,e){if(r)return r.call(t,e);for(var i=t.parentNode.querySelectorAll(e),n=0;n<i.length;++n)if(i[n]==t)return!0;return!1}var o=Element.prototype,r=o.matchesSelector||o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector;e.exports=n},{}],6:[function(t,e,i){function n(t){var e;if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName)t.focus(),t.setSelectionRange(0,t.value.length),e=t.value;else{t.hasAttribute("contenteditable")&&t.focus();var i=window.getSelection(),n=document.createRange();n.selectNodeContents(t),i.removeAllRanges(),i.addRange(n),e=i.toString()}return e}e.exports=n},{}],7:[function(t,e,i){function n(){}n.prototype={on:function(t,e,i){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:i}),this},once:function(t,e,i){function n(){o.off(t,n),e.apply(i,arguments)}var o=this;return n._=e,this.on(t,n,i)},emit:function(t){var e=[].slice.call(arguments,1),i=((this.e||(this.e={}))[t]||[]).slice(),n=0,o=i.length;for(n;o>n;n++)i[n].fn.apply(i[n].ctx,e);return this},off:function(t,e){var i=this.e||(this.e={}),n=i[t],o=[];if(n&&e)for(var r=0,a=n.length;a>r;r++)n[r].fn!==e&&n[r].fn._!==e&&o.push(n[r]);return o.length?i[t]=o:delete i[t],this}},e.exports=n},{}],8:[function(e,i,n){!function(o,r){if("function"==typeof t&&t.amd)t(["module","select"],r);else if("undefined"!=typeof n)r(i,e("select"));else{var a={exports:{}};r(a,o.select),o.clipboardAction=a.exports}}(this,function(t,e){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=i(e),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(){function t(e){n(this,t),this.resolveOptions(e),this.initSelection()}return t.prototype.resolveOptions=function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.action=t.action,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""},t.prototype.initSelection=function(){this.text?this.selectFake():this.target&&this.selectTarget()},t.prototype.selectFake=function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandler=document.body.addEventListener("click",function(){return t.removeFake()}),this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="fixed",this.fakeElem.style[e?"right":"left"]="-9999px",this.fakeElem.style.top=(window.pageYOffset||document.documentElement.scrollTop)+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,document.body.appendChild(this.fakeElem),this.selectedText=o["default"](this.fakeElem),this.copyText()},t.prototype.removeFake=function(){this.fakeHandler&&(document.body.removeEventListener("click"),this.fakeHandler=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)},t.prototype.selectTarget=function(){this.selectedText=o["default"](this.target),this.copyText()},t.prototype.copyText=function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)},t.prototype.handleResult=function(t){t?this.emitter.emit("success",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)}):this.emitter.emit("error",{action:this.action,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})},t.prototype.clearSelection=function(){this.target&&this.target.blur(),window.getSelection().removeAllRanges()},t.prototype.destroy=function(){this.removeFake()},a(t,[{key:"action",set:function(){var t=arguments.length<=0||void 0===arguments[0]?"copy":arguments[0];if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==("undefined"==typeof t?"undefined":r(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}();t.exports=s})},{select:6}],9:[function(e,i,n){!function(o,r){if("function"==typeof t&&t.amd)t(["module","./clipboard-action","tiny-emitter","good-listener"],r);else if("undefined"!=typeof n)r(i,e("./clipboard-action"),e("tiny-emitter"),e("good-listener"));else{var a={exports:{}};r(a,o.clipboardAction,o.tinyEmitter,o.goodListener),o.clipboard=a.exports}}(this,function(t,e,i,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(t,e){var i="data-clipboard-"+t;if(e.hasAttribute(i))return e.getAttribute(i)}var c=o(e),u=o(i),d=o(n),h=function(t){function e(i,n){r(this,e);var o=a(this,t.call(this));return o.resolveOptions(n),o.listenClick(i),o}return s(e,t),e.prototype.resolveOptions=function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText},e.prototype.listenClick=function(t){var e=this;this.listener=d["default"](t,"click",function(t){return e.onClick(t)})},e.prototype.onClick=function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new c["default"]({action:this.action(e),target:this.target(e),text:this.text(e),trigger:e,emitter:this})},e.prototype.defaultAction=function(t){return l("action",t)},e.prototype.defaultTarget=function(t){var e=l("target",t);return e?document.querySelector(e):void 0},e.prototype.defaultText=function(t){return l("text",t)},e.prototype.destroy=function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)},e}(u["default"]);t.exports=h})},{"./clipboard-action":8,"good-listener":4,"tiny-emitter":7}]},{},[9])(9)}),function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("Cropper requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){"use strict";function i(t){return ae.call(t).slice(8,-1).toLowerCase()}function n(t){return"number"==typeof t&&!isNaN(t);

}function o(t){return"undefined"==typeof t}function r(t){return"object"==typeof t&&null!==t}function a(t){var e,i;if(!r(t))return!1;try{return e=t.constructor,i=e.prototype,e&&i&&se.call(i,"isPrototypeOf")}catch(n){return!1}}function s(t){return"function"===i(t)}function l(t){return G.isArray?G.isArray(t):"array"===i(t)}function c(t,e){return e=e>=0?e:0,G.from?G.from(t).slice(e):le.call(t,e)}function u(t){return"string"==typeof t&&(t=t.trim?t.trim():t.replace(St,"$1")),t}function d(t,e){var i,o;if(t&&s(e))if(l(t)||n(t.length))for(o=0,i=t.length;i>o&&e.call(t,t[o],o,t)!==!1;o++);else if(r(t))for(o in t)if(t.hasOwnProperty(o)&&e.call(t,t[o],o,t)===!1)break;return t}function h(t){var e;if(arguments.length>1){if(e=c(arguments),J.assign)return J.assign.apply(J,e);e.shift(),d(e,function(e){d(e,function(e,i){t[i]=e})})}return t}function p(t,e){var i=c(arguments,2);return function(){return t.apply(e,i.concat(c(arguments)))}}function f(t,e){var i=t.style;d(e,function(t,e){Tt.test(e)&&n(t)&&(t+="px"),i[e]=t})}function m(t,e){return t.classList?t.classList.contains(e):t.className.indexOf(e)>-1}function g(t,e){var i;return n(t.length)?d(t,function(t){g(t,e)}):t.classList?t.classList.add(e):(i=u(t.className),void(i?i.indexOf(e)<0&&(t.className=i+" "+e):t.className=e))}function v(t,e){return n(t.length)?d(t,function(t){v(t,e)}):t.classList?t.classList.remove(e):void(t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,"")))}function y(t,e,i){return n(t.length)?d(t,function(t){y(t,e,i)}):void(i?g(t,e):v(t,e))}function w(t,e){return r(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-"+e)}function b(t,e,i){r(i)&&o(t[e])?t[e]=i:t.dataset?t.dataset[e]=i:t.setAttribute("data-"+e,i)}function _(t,e){r(t[e])?delete t[e]:t.dataset?delete t.dataset[e]:t.removeAttribute("data-"+e)}function x(t,e,i,n){var o=u(e).split(Et),r=i;return o.length>1?d(o,function(e){x(t,e,i)}):(n&&(i=function(){return $(t,e,i),r.apply(t,arguments)}),void(t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i)))}function $(t,e,i){var n=u(e).split(Et);return n.length>1?d(n,function(e){$(t,e,i)}):void(t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent&&t.detachEvent("on"+e,i))}function k(t,e,i){var n;return t.dispatchEvent?(s(Event)&&s(CustomEvent)?n=o(i)?new Event(e,{bubbles:!0,cancelable:!0}):new CustomEvent(e,{detail:i,bubbles:!0,cancelable:!0}):o(i)?(n=X.createEvent("Event"),n.initEvent(e,!0,!0)):(n=X.createEvent("CustomEvent"),n.initCustomEvent(e,!0,!0,i)),t.dispatchEvent(n)):t.fireEvent?t.fireEvent("on"+e):void 0}function C(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function T(e){var i,o=e||t.event;return o.target||(o.target=o.srcElement||X),n(o.pageX)||(i=X.documentElement,o.pageX=o.clientX+(t.scrollX||i&&i.scrollLeft||0)-(i&&i.clientLeft||0),o.pageY=o.clientY+(t.scrollY||i&&i.scrollTop||0)-(i&&i.clientTop||0)),o}function I(e){var i=X.documentElement,n=e.getBoundingClientRect();return{left:n.left+(t.scrollX||i&&i.scrollLeft||0)-(i&&i.clientLeft||0),top:n.top+(t.scrollY||i&&i.scrollTop||0)-(i&&i.clientTop||0)}}function S(t){var e=t.length,i=0,n=0;return e&&(d(t,function(t){i+=t.pageX,n+=t.pageY}),i/=e,n/=e),{pageX:i,pageY:n}}function E(t,e){return t.getElementsByTagName(e)}function A(t,e){return t.getElementsByClassName?t.getElementsByClassName(e):t.querySelectorAll("."+e)}function D(t){return X.createElement(t)}function O(t,e){t.appendChild(e)}function P(t){t.parentNode&&t.parentNode.removeChild(t)}function M(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function N(t){var e=t.match(It);return e&&(e[1]!==Y.protocol||e[2]!==Y.hostname||e[3]!==Y.port)}function R(t){var e="timestamp="+(new Date).getTime();return t+(-1===t.indexOf("?")?"?":"&")+e}function L(t,e){var i;return t.naturalWidth&&!Qt?e(t.naturalWidth,t.naturalHeight):(i=D("img"),i.onload=function(){e(this.width,this.height)},void(i.src=t.src))}function j(t){var e=[],i=t.rotate,o=t.scaleX,r=t.scaleY;return n(i)&&e.push("rotate("+i+"deg)"),n(o)&&n(r)&&e.push("scale("+o+","+r+")"),e.length?e.join(" "):"none"}function F(t,e){var i,n,o=Kt(t.degree)%180,r=(o>90?180-o:o)*oe/180,a=Zt(r),s=te(r),l=t.width,c=t.height,u=t.aspectRatio;return e?(i=l/(s+a/u),n=i/u):(i=l*s+c*a,n=l*a+c*s),{width:i,height:n}}function q(t,e){var i,o,r,a=D("canvas"),s=a.getContext("2d"),l=0,c=0,u=e.naturalWidth,d=e.naturalHeight,h=e.rotate,p=e.scaleX,f=e.scaleY,m=n(p)&&n(f)&&(1!==p||1!==f),g=n(h)&&0!==h,v=g||m,y=u*Kt(p||1),w=d*Kt(f||1);return m&&(i=y/2,o=w/2),g&&(r=F({width:y,height:w,degree:h}),y=r.width,w=r.height,i=y/2,o=w/2),a.width=y,a.height=w,v&&(l=-u/2,c=-d/2,s.save(),s.translate(i,o)),g&&s.rotate(h*oe/180),m&&s.scale(p,f),s.drawImage(t,ne(l),ne(c),ne(u),ne(d)),v&&s.restore(),a}function U(t,e,i){var n="",o=e;for(i+=e;i>o;o++)n+=ce(t.getUint8(o));return n}function z(t){var e,i,n,o,r,a,s,l,c,u,d=new DataView(t),h=d.byteLength;if(255===d.getUint8(0)&&216===d.getUint8(1))for(c=2;h>c;){if(255===d.getUint8(c)&&225===d.getUint8(c+1)){s=c;break}c++}if(s&&(i=s+4,n=s+10,"Exif"===U(d,i,4)&&(a=d.getUint16(n),r=18761===a,(r||19789===a)&&42===d.getUint16(n+2,r)&&(o=d.getUint32(n+4,r),o>=8&&(l=n+o)))),l)for(h=d.getUint16(l,r),u=0;h>u;u++)if(c=l+12*u+2,274===d.getUint16(c,r)){c+=8,e=d.getUint16(c,r),Qt&&d.setUint16(c,1,r);break}return e}function W(t){var e,i=t.replace(Dt,""),n=atob(i),o=n.length,r=new Q(o),a=new Uint8Array(r);for(e=0;o>e;e++)a[e]=n.charCodeAt(e);return r}function B(t){var e,i=new Uint8Array(t),n=i.length,o="";for(e=0;n>e;e++)o+=ce(i[e]);return"data:image/jpeg;base64,"+btoa(o)}function H(t,e){var i=this;i.element=t,i.options=h({},H.DEFAULTS,a(e)&&e),i.ready=!1,i.built=!1,i.complete=!1,i.rotated=!1,i.cropped=!1,i.disabled=!1,i.replaced=!1,i.limited=!1,i.wheeling=!1,i.isImg=!1,i.originalUrl="",i.canvasData=null,i.cropBoxData=null,i.previews=null,i.init()}var X=t.document,Y=t.location,V=t.navigator,Q=t.ArrayBuffer,J=t.Object,G=t.Array,K=t.String,Z=t.Number,tt=t.Math,et="cropper",it=et+"-modal",nt=et+"-hide",ot=et+"-hidden",rt=et+"-invisible",at=et+"-move",st=et+"-crop",lt=et+"-disabled",ct=et+"-bg",ut="mousedown touchstart pointerdown MSPointerDown",dt="mousemove touchmove pointermove MSPointerMove",ht="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",pt="wheel mousewheel DOMMouseScroll",ft="dblclick",mt="resize",gt="error",vt="load",yt="build",wt="built",bt="cropstart",_t="cropmove",xt="cropend",$t="crop",kt="zoom",Ct=/e|w|s|n|se|sw|ne|nw|all|crop|move|zoom/,Tt=/width|height|left|top|marginLeft|marginTop/,It=/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i,St=/^\s+(.*)\s+$/,Et=/\s+/,At=/^data\:/,Dt=/^data\:([^\;]+)\;base64,/,Ot=/^data\:image\/jpeg.*;base64,/,Pt="preview",Mt="action",Nt="e",Rt="w",Lt="s",jt="n",Ft="se",qt="sw",Ut="ne",zt="nw",Wt="all",Bt="crop",Ht="move",Xt="zoom",Yt="none",Vt=!!X.createElement("canvas").getContext,Qt=V&&/safari/i.test(V.userAgent)&&/apple computer/i.test(V.vendor),Jt=tt.min,Gt=tt.max,Kt=tt.abs,Zt=tt.sin,te=tt.cos,ee=tt.sqrt,ie=tt.round,ne=tt.floor,oe=tt.PI,re=J.prototype,ae=re.toString,se=re.hasOwnProperty,le=G.prototype.slice,ce=K.fromCharCode;H.prototype={constructor:H,init:function(){var t,e=this,i=e.element,n=i.tagName.toLowerCase();if(!w(i,et)){if(b(i,et,e),"img"===n){if(e.isImg=!0,e.originalUrl=t=i.getAttribute("src"),!t)return;t=i.src}else"canvas"===n&&Vt&&(t=i.toDataURL());e.load(t)}},load:function(t){var e,i=this,n=i.options,o=i.element;if(t&&(s(n.build)&&x(o,yt,n.build,!0),k(o,yt)!==!1)){if(i.url=t,i.imageData={},!n.checkOrientation||!Q)return i.clone();if(At.test(t))return Ot.test(t)?i.read(W(t)):i.clone();e=new XMLHttpRequest,e.onerror=e.onabort=function(){i.clone()},e.onload=function(){i.read(this.response)},e.open("get",t),e.responseType="arraybuffer",e.send()}},read:function(t){var e,i,n,o=this,r=o.options,a=z(t),s=o.imageData;if(a>1)switch(o.url=B(t),a){case 2:i=-1;break;case 3:e=-180;break;case 4:n=-1;break;case 5:e=90,n=-1;break;case 6:e=90;break;case 7:e=90,i=-1;break;case 8:e=-90}r.rotatable&&(s.rotate=e),r.scalable&&(s.scaleX=i,s.scaleY=n),o.clone()},clone:function(){var t,e,i,n,o,r=this,a=r.element,s=r.url;r.options.checkCrossOrigin&&N(s)&&(t=a.crossOrigin,t?e=s:(t="anonymous",e=R(s))),r.crossOrigin=t,r.crossOriginUrl=e,i=D("img"),t&&(i.crossOrigin=t),i.src=e||s,r.image=i,r._start=n=p(r.start,r),r._stop=o=p(r.stop,r),r.isImg?a.complete?r.start():x(a,vt,n):(x(i,vt,n),x(i,gt,o),g(i,nt),a.parentNode.insertBefore(i,a.nextSibling))},start:function(t){var e=this,i=e.isImg?e.element:e.image;t&&($(i,vt,e._start),$(i,gt,e._stop)),L(i,function(t,i){h(e.imageData,{naturalWidth:t,naturalHeight:i,aspectRatio:t/i}),e.ready=!0,e.build()})},stop:function(){var t=this,e=t.image;$(e,vt,t._start),$(e,gt,t._stop),P(e),t.image=null},build:function(){var t,e,i,n,o,r,a,l=this,c=l.options,u=l.element,d=l.image;l.ready&&(l.built&&l.unbuild(),e=D("div"),e.innerHTML=H.TEMPLATE,l.container=t=u.parentNode,l.cropper=i=A(e,"cropper-container")[0],l.canvas=n=A(i,"cropper-canvas")[0],l.dragBox=o=A(i,"cropper-drag-box")[0],l.cropBox=r=A(i,"cropper-crop-box")[0],l.viewBox=A(i,"cropper-view-box")[0],l.face=a=A(r,"cropper-face")[0],O(n,d),g(u,ot),t.insertBefore(i,u.nextSibling),l.isImg||v(d,nt),l.initPreview(),l.bind(),c.aspectRatio=Gt(0,c.aspectRatio)||0/0,c.viewMode=Gt(0,Jt(3,ie(c.viewMode)))||0,c.autoCrop?(l.cropped=!0,c.modal&&g(o,it)):g(r,ot),c.guides||g(A(r,"cropper-dashed"),ot),c.center||g(A(r,"cropper-center"),ot),c.background&&g(i,ct),c.highlight||g(a,rt),c.cropBoxMovable&&(g(a,at),b(a,Mt,Wt)),c.cropBoxResizable||(g(A(r,"cropper-line"),ot),g(A(r,"cropper-point"),ot)),l.setDragMode(c.dragMode),l.render(),l.built=!0,l.setData(c.data),setTimeout(function(){s(c.built)&&x(u,wt,c.built,!0),k(u,wt),k(u,$t,l.getData()),l.complete=!0},0))},unbuild:function(){var t=this;t.built&&(t.built=!1,t.complete=!1,t.initialImageData=null,t.initialCanvasData=null,t.initialCropBoxData=null,t.containerData=null,t.canvasData=null,t.cropBoxData=null,t.unbind(),t.resetPreview(),t.previews=null,t.viewBox=null,t.cropBox=null,t.dragBox=null,t.canvas=null,t.container=null,P(t.cropper),t.cropper=null)},render:function(){var t=this;t.initContainer(),t.initCanvas(),t.initCropBox(),t.renderCanvas(),t.cropped&&t.renderCropBox()},initContainer:function(){var t,e=this,i=e.options,n=e.element,o=e.container,r=e.cropper;g(r,ot),v(n,ot),e.containerData=t={width:Gt(o.offsetWidth,Z(i.minContainerWidth)||200),height:Gt(o.offsetHeight,Z(i.minContainerHeight)||100)},f(r,{width:t.width,height:t.height}),g(n,ot),v(r,ot)},initCanvas:function(){var t,e=this,i=e.options.viewMode,n=e.containerData,o=e.imageData,r=90===Kt(o.rotate),a=r?o.naturalHeight:o.naturalWidth,s=r?o.naturalWidth:o.naturalHeight,l=a/s,c=n.width,u=n.height;n.height*l>n.width?3===i?c=n.height*l:u=n.width/l:3===i?u=n.width/l:c=n.height*l,t={naturalWidth:a,naturalHeight:s,aspectRatio:l,width:c,height:u},t.oldLeft=t.left=(n.width-c)/2,t.oldTop=t.top=(n.height-u)/2,e.canvasData=t,e.limited=1===i||2===i,e.limitCanvas(!0,!0),e.initialImageData=h({},o),e.initialCanvasData=h({},t)},limitCanvas:function(t,e){var i,n,o,r,a=this,s=a.options,l=s.viewMode,c=a.containerData,u=a.canvasData,d=u.aspectRatio,h=a.cropBoxData,p=a.cropped&&h;t&&(i=Z(s.minCanvasWidth)||0,n=Z(s.minCanvasHeight)||0,l>1?(i=Gt(i,c.width),n=Gt(n,c.height),3===l&&(n*d>i?i=n*d:n=i/d)):l>0&&(i?i=Gt(i,p?h.width:0):n?n=Gt(n,p?h.height:0):p&&(i=h.width,n=h.height,n*d>i?i=n*d:n=i/d)),i&&n?n*d>i?n=i/d:i=n*d:i?n=i/d:n&&(i=n*d),u.minWidth=i,u.minHeight=n,u.maxWidth=1/0,u.maxHeight=1/0),e&&(l?(o=c.width-u.width,r=c.height-u.height,u.minLeft=Jt(0,o),u.minTop=Jt(0,r),u.maxLeft=Gt(0,o),u.maxTop=Gt(0,r),p&&a.limited&&(u.minLeft=Jt(h.left,h.left+h.width-u.width),u.minTop=Jt(h.top,h.top+h.height-u.height),u.maxLeft=h.left,u.maxTop=h.top,2===l&&(u.width>=c.width&&(u.minLeft=Jt(0,o),u.maxLeft=Gt(0,o)),u.height>=c.height&&(u.minTop=Jt(0,r),u.maxTop=Gt(0,r))))):(u.minLeft=-u.width,u.minTop=-u.height,u.maxLeft=c.width,u.maxTop=c.height))},renderCanvas:function(t){var e,i,n=this,o=n.canvasData,r=n.imageData,a=r.rotate;n.rotated&&(n.rotated=!1,i=F({width:r.width,height:r.height,degree:a}),e=i.width/i.height,e!==o.aspectRatio&&(o.left-=(i.width-o.width)/2,o.top-=(i.height-o.height)/2,o.width=i.width,o.height=i.height,o.aspectRatio=e,o.naturalWidth=r.naturalWidth,o.naturalHeight=r.naturalHeight,a%180&&(i=F({width:r.naturalWidth,height:r.naturalHeight,degree:a}),o.naturalWidth=i.width,o.naturalHeight=i.height),n.limitCanvas(!0,!1))),(o.width>o.maxWidth||o.width<o.minWidth)&&(o.left=o.oldLeft),(o.height>o.maxHeight||o.height<o.minHeight)&&(o.top=o.oldTop),o.width=Jt(Gt(o.width,o.minWidth),o.maxWidth),o.height=Jt(Gt(o.height,o.minHeight),o.maxHeight),n.limitCanvas(!1,!0),o.oldLeft=o.left=Jt(Gt(o.left,o.minLeft),o.maxLeft),o.oldTop=o.top=Jt(Gt(o.top,o.minTop),o.maxTop),f(n.canvas,{width:o.width,height:o.height,left:o.left,top:o.top}),n.renderImage(),n.cropped&&n.limited&&n.limitCropBox(!0,!0),t&&n.output()},renderImage:function(t){var e,i,n,o,r,a=this,s=a.canvasData,l=a.imageData;l.rotate&&(i=F({width:s.width,height:s.height,degree:l.rotate,aspectRatio:l.aspectRatio},!0),n=i.width,o=i.height,e={width:n,height:o,left:(s.width-n)/2,top:(s.height-o)/2}),h(l,e||{width:s.width,height:s.height,left:0,top:0}),r=j(l),f(a.image,{width:l.width,height:l.height,marginLeft:l.left,marginTop:l.top,WebkitTransform:r,msTransform:r,transform:r}),t&&a.output()},initCropBox:function(){var t=this,e=t.options,i=e.aspectRatio,n=Z(e.autoCropArea)||.8,o=t.canvasData,r={width:o.width,height:o.height};i&&(o.height*i>o.width?r.height=r.width/i:r.width=r.height*i),t.cropBoxData=r,t.limitCropBox(!0,!0),r.width=Jt(Gt(r.width,r.minWidth),r.maxWidth),r.height=Jt(Gt(r.height,r.minHeight),r.maxHeight),r.width=Gt(r.minWidth,r.width*n),r.height=Gt(r.minHeight,r.height*n),r.oldLeft=r.left=o.left+(o.width-r.width)/2,r.oldTop=r.top=o.top+(o.height-r.height)/2,t.initialCropBoxData=h({},r)},limitCropBox:function(t,e){var i,n,o,r,a=this,s=a.options,l=s.aspectRatio,c=a.containerData,u=a.canvasData,d=a.cropBoxData,h=a.limited;t&&(i=Z(s.minCropBoxWidth)||0,n=Z(s.minCropBoxHeight)||0,i=Jt(i,c.width),n=Jt(n,c.height),o=Jt(c.width,h?u.width:c.width),r=Jt(c.height,h?u.height:c.height),l&&(i&&n?n*l>i?n=i/l:i=n*l:i?n=i/l:n&&(i=n*l),r*l>o?r=o/l:o=r*l),d.minWidth=Jt(i,o),d.minHeight=Jt(n,r),d.maxWidth=o,d.maxHeight=r),e&&(h?(d.minLeft=Gt(0,u.left),d.minTop=Gt(0,u.top),d.maxLeft=Jt(c.width,u.left+u.width)-d.width,d.maxTop=Jt(c.height,u.top+u.height)-d.height):(d.minLeft=0,d.minTop=0,d.maxLeft=c.width-d.width,d.maxTop=c.height-d.height))},renderCropBox:function(){var t=this,e=t.options,i=t.containerData,n=t.cropBoxData;(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft),(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop),n.width=Jt(Gt(n.width,n.minWidth),n.maxWidth),n.height=Jt(Gt(n.height,n.minHeight),n.maxHeight),t.limitCropBox(!1,!0),n.oldLeft=n.left=Jt(Gt(n.left,n.minLeft),n.maxLeft),n.oldTop=n.top=Jt(Gt(n.top,n.minTop),n.maxTop),e.movable&&e.cropBoxMovable&&b(t.face,Mt,n.width===i.width&&n.height===i.height?Ht:Wt),f(t.cropBox,{width:n.width,height:n.height,left:n.left,top:n.top}),t.cropped&&t.limited&&t.limitCanvas(!0,!0),t.disabled||t.output()},output:function(){var t=this;t.preview(),t.complete&&k(t.element,$t,t.getData())},initPreview:function(){var t,e=this,i=e.options.preview,n=D("img"),o=e.crossOrigin,r=o?e.crossOriginUrl:e.url;o&&(n.crossOrigin=o),n.src=r,O(e.viewBox,n),e.image2=n,i&&(e.previews=t=X.querySelectorAll(i),d(t,function(t){var e=D("img");b(t,Pt,{width:t.offsetWidth,height:t.offsetHeight,html:t.innerHTML}),o&&(e.crossOrigin=o),e.src=r,e.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',M(t),O(t,e)}))},resetPreview:function(){d(this.previews,function(t){var e=w(t,Pt);f(t,{width:e.width,height:e.height}),t.innerHTML=e.html,_(t,Pt)})},preview:function(){var t=this,e=t.imageData,i=t.canvasData,n=t.cropBoxData,o=n.width,r=n.height,a=e.width,s=e.height,l=n.left-i.left-e.left,c=n.top-i.top-e.top,u=j(e),p={WebkitTransform:u,msTransform:u,transform:u};t.cropped&&!t.disabled&&(f(t.image2,h({width:a,height:s,marginLeft:-l,marginTop:-c},p)),d(t.previews,function(t){var e=w(t,Pt),i=e.width,n=e.height,u=i,d=n,m=1;o&&(m=i/o,d=r*m),r&&d>n&&(m=n/r,u=o*m,d=n),f(t,{width:u,height:d}),f(E(t,"img")[0],h({width:a*m,height:s*m,marginLeft:-l*m,marginTop:-c*m},p))}))},bind:function(){var e=this,i=e.options,n=e.element,o=e.cropper;s(i.cropstart)&&x(n,bt,i.cropstart),s(i.cropmove)&&x(n,_t,i.cropmove),s(i.cropend)&&x(n,xt,i.cropend),s(i.crop)&&x(n,$t,i.crop),s(i.zoom)&&x(n,kt,i.zoom),x(o,ut,e._cropStart=p(e.cropStart,e)),i.zoomable&&i.zoomOnWheel&&x(o,pt,e._wheel=p(e.wheel,e)),i.toggleDragModeOnDblclick&&x(o,ft,e._dblclick=p(e.dblclick,e)),x(X,dt,e._cropMove=p(e.cropMove,e)),x(X,ht,e._cropEnd=p(e.cropEnd,e)),i.responsive&&x(t,mt,e._resize=p(e.resize,e))},unbind:function(){var e=this,i=e.options,n=e.element,o=e.cropper;s(i.cropstart)&&$(n,bt,i.cropstart),s(i.cropmove)&&$(n,_t,i.cropmove),s(i.cropend)&&$(n,xt,i.cropend),s(i.crop)&&$(n,$t,i.crop),s(i.zoom)&&$(n,kt,i.zoom),$(o,ut,e._cropStart),i.zoomable&&i.zoomOnWheel&&$(o,pt,e._wheel),i.toggleDragModeOnDblclick&&$(o,ft,e._dblclick),$(X,dt,e._cropMove),$(X,ht,e._cropEnd),i.responsive&&$(t,mt,e._resize)},resize:function(){var t,e,i,n=this,o=n.options.restore,r=n.container,a=n.containerData;!n.disabled&&a&&(i=r.offsetWidth/a.width,(1!==i||r.offsetHeight!==a.height)&&(o&&(t=n.getCanvasData(),e=n.getCropBoxData()),n.render(),o&&(n.setCanvasData(d(t,function(e,n){t[n]=e*i})),n.setCropBoxData(d(e,function(t,n){e[n]=t*i})))))},dblclick:function(){var t=this;t.disabled||t.setDragMode(m(t.dragBox,st)?Ht:Bt)},wheel:function(t){var e=this,i=T(t),n=Z(e.options.wheelZoomRatio)||.1,o=1;e.disabled||(C(i),e.wheeling||(e.wheeling=!0,setTimeout(function(){e.wheeling=!1},50),i.deltaY?o=i.deltaY>0?1:-1:i.wheelDelta?o=-i.wheelDelta/120:i.detail&&(o=i.detail>0?1:-1),e.zoom(-o*n,i)))},cropStart:function(t){var e,i,n,o=this,r=o.options,a=T(t),s=a.touches;if(!o.disabled){if(s){if(e=s.length,e>1){if(!r.zoomable||!r.zoomOnTouch||2!==e)return;i=s[1],o.startX2=i.pageX,o.startY2=i.pageY,n=Xt}i=s[0]}if(n=n||w(a.target,Mt),Ct.test(n)){if(k(o.element,bt,{originalEvent:a,action:n})===!1)return;C(a),o.action=n,o.cropping=!1,o.startX=i?i.pageX:a.pageX,o.startY=i?i.pageY:a.pageY,n===Bt&&(o.cropping=!0,g(o.dragBox,it))}}},cropMove:function(t){var e,i,n=this,o=n.options,r=T(t),a=r.touches,s=n.action;if(!n.disabled){if(a){if(e=a.length,e>1){if(!o.zoomable||!o.zoomOnTouch||2!==e)return;i=a[1],n.endX2=i.pageX,n.endY2=i.pageY}i=a[0]}if(s){if(k(n.element,_t,{originalEvent:r,action:s})===!1)return;C(r),n.endX=i?i.pageX:r.pageX,n.endY=i?i.pageY:r.pageY,n.change(r.shiftKey,s===Xt?r:null)}}},cropEnd:function(t){var e=this,i=e.options,n=T(t),o=e.action;e.disabled||o&&(C(n),e.cropping&&(e.cropping=!1,y(e.dragBox,it,e.cropped&&i.modal)),e.action="",k(e.element,xt,{originalEvent:n,action:o}))},change:function(t,e){var i,n,o=this,r=o.options,a=r.aspectRatio,s=o.action,l=o.containerData,c=o.canvasData,u=o.cropBoxData,d=u.width,h=u.height,p=u.left,f=u.top,m=p+d,g=f+h,y=0,w=0,b=l.width,_=l.height,x=!0;switch(!a&&t&&(a=d&&h?d/h:1),o.limited&&(y=u.minLeft,w=u.minTop,b=y+Jt(l.width,c.left+c.width),_=w+Jt(l.height,c.top+c.height)),n={x:o.endX-o.startX,y:o.endY-o.startY},a&&(n.X=n.y*a,n.Y=n.x/a),s){case Wt:p+=n.x,f+=n.y;break;case Nt:if(n.x>=0&&(m>=b||a&&(w>=f||g>=_))){x=!1;break}d+=n.x,a&&(h=d/a,f-=n.Y/2),0>d&&(s=Rt,d=0);break;case jt:if(n.y<=0&&(w>=f||a&&(y>=p||m>=b))){x=!1;break}h-=n.y,f+=n.y,a&&(d=h*a,p+=n.X/2),0>h&&(s=Lt,h=0);break;case Rt:if(n.x<=0&&(y>=p||a&&(w>=f||g>=_))){x=!1;break}d-=n.x,p+=n.x,a&&(h=d/a,f+=n.Y/2),0>d&&(s=Nt,d=0);break;case Lt:if(n.y>=0&&(g>=_||a&&(y>=p||m>=b))){x=!1;break}h+=n.y,a&&(d=h*a,p-=n.X/2),0>h&&(s=jt,h=0);break;case Ut:if(a){if(n.y<=0&&(w>=f||m>=b)){x=!1;break}h-=n.y,f+=n.y,d=h*a}else n.x>=0?b>m?d+=n.x:n.y<=0&&w>=f&&(x=!1):d+=n.x,n.y<=0?f>w&&(h-=n.y,f+=n.y):(h-=n.y,f+=n.y);0>d&&0>h?(s=qt,h=0,d=0):0>d?(s=zt,d=0):0>h&&(s=Ft,h=0);break;case zt:if(a){if(n.y<=0&&(w>=f||y>=p)){x=!1;break}h-=n.y,f+=n.y,d=h*a,p+=n.X}else n.x<=0?p>y?(d-=n.x,p+=n.x):n.y<=0&&w>=f&&(x=!1):(d-=n.x,p+=n.x),n.y<=0?f>w&&(h-=n.y,f+=n.y):(h-=n.y,f+=n.y);0>d&&0>h?(s=Ft,h=0,d=0):0>d?(s=Ut,d=0):0>h&&(s=qt,h=0);break;case qt:if(a){if(n.x<=0&&(y>=p||g>=_)){x=!1;break}d-=n.x,p+=n.x,h=d/a}else n.x<=0?p>y?(d-=n.x,p+=n.x):n.y>=0&&g>=_&&(x=!1):(d-=n.x,p+=n.x),n.y>=0?_>g&&(h+=n.y):h+=n.y;0>d&&0>h?(s=Ut,h=0,d=0):0>d?(s=Ft,d=0):0>h&&(s=zt,h=0);break;case Ft:if(a){if(n.x>=0&&(m>=b||g>=_)){x=!1;break}d+=n.x,h=d/a}else n.x>=0?b>m?d+=n.x:n.y>=0&&g>=_&&(x=!1):d+=n.x,n.y>=0?_>g&&(h+=n.y):h+=n.y;0>d&&0>h?(s=zt,h=0,d=0):0>d?(s=qt,d=0):0>h&&(s=Ut,h=0);break;case Ht:o.move(n.x,n.y),x=!1;break;case Xt:o.zoom(function(t,e,i,n){var o=ee(t*t+e*e),r=ee(i*i+n*n);return(r-o)/o}(Kt(o.startX-o.startX2),Kt(o.startY-o.startY2),Kt(o.endX-o.endX2),Kt(o.endY-o.endY2)),e),o.startX2=o.endX2,o.startY2=o.endY2,x=!1;break;case Bt:if(!n.x||!n.y){x=!1;break}i=I(o.cropper),p=o.startX-i.left,f=o.startY-i.top,d=u.minWidth,h=u.minHeight,n.x>0?s=n.y>0?Ft:Ut:n.x<0&&(p-=d,s=n.y>0?qt:zt),n.y<0&&(f-=h),o.cropped||(v(o.cropBox,ot),o.cropped=!0,o.limited&&o.limitCropBox(!0,!0))}x&&(u.width=d,u.height=h,u.left=p,u.top=f,o.action=s,o.renderCropBox()),o.startX=o.endX,o.startY=o.endY},crop:function(){var t=this;return t.built&&!t.disabled&&(t.cropped||(t.cropped=!0,t.limitCropBox(!0,!0),t.options.modal&&g(t.dragBox,it),v(t.cropBox,ot)),t.setCropBoxData(t.initialCropBoxData)),t},reset:function(){var t=this;return t.built&&!t.disabled&&(t.imageData=h({},t.initialImageData),t.canvasData=h({},t.initialCanvasData),t.cropBoxData=h({},t.initialCropBoxData),t.renderCanvas(),t.cropped&&t.renderCropBox()),t},clear:function(){var t=this;return t.cropped&&!t.disabled&&(h(t.cropBoxData,{left:0,top:0,width:0,height:0}),t.cropped=!1,t.renderCropBox(),t.limitCanvas(),t.renderCanvas(),v(t.dragBox,it),g(t.cropBox,ot)),t},replace:function(t,e){var i=this;return!i.disabled&&t&&(i.isImg&&(i.element.src=t),e?(i.url=t,i.image.src=t,i.built&&(i.image2.src=t,d(i.previews,function(e){E(e,"img")[0].src=t}))):(i.isImg&&(i.replaced=!0),i.options.data=null,i.load(t))),i},enable:function(){var t=this;return t.built&&(t.disabled=!1,v(t.cropper,lt)),t},disable:function(){var t=this;return t.built&&(t.disabled=!0,g(t.cropper,lt)),t},destroy:function(){var t=this,e=t.element,i=t.image;return t.ready?(t.isImg&&t.replaced&&(e.src=t.originalUrl),t.unbuild(),v(e,ot)):t.isImg?$(e,vt,t.start):i&&P(i),_(e,et),t},move:function(t,e){var i=this,n=i.canvasData;return i.moveTo(o(t)?t:n.left+Z(t),o(e)?e:n.top+Z(e))},moveTo:function(t,e){var i=this,r=i.canvasData,a=!1;return o(e)&&(e=t),t=Z(t),e=Z(e),i.built&&!i.disabled&&i.options.movable&&(n(t)&&(r.left=t,a=!0),n(e)&&(r.top=e,a=!0),a&&i.renderCanvas(!0)),i},zoom:function(t,e){var i=this,n=i.canvasData;return t=Z(t),t=0>t?1/(1-t):1+t,i.zoomTo(n.width*t/n.naturalWidth,e)},zoomTo:function(t,e){var i,n,o,r,a=this,s=a.options,l=a.canvasData,c=l.width,u=l.height,d=l.naturalWidth,h=l.naturalHeight;if(t=Z(t),t>=0&&a.built&&!a.disabled&&s.zoomable){if(i=d*t,n=h*t,k(a.element,kt,{originalEvent:e,oldRatio:c/d,ratio:i/d})===!1)return a;e?(o=I(a.cropper),r=e.touches?S(e.touches):{pageX:e.pageX,pageY:e.pageY},l.left-=(i-c)*((r.pageX-o.left-l.left)/c),l.top-=(n-u)*((r.pageY-o.top-l.top)/u)):(l.left-=(i-c)/2,l.top-=(n-u)/2),l.width=i,l.height=n,a.renderCanvas(!0)}return a},rotate:function(t){var e=this;return e.rotateTo((e.imageData.rotate||0)+Z(t))},rotateTo:function(t){var e=this;return t=Z(t),n(t)&&e.built&&!e.disabled&&e.options.rotatable&&(e.imageData.rotate=t%360,e.rotated=!0,e.renderCanvas(!0)),e},scale:function(t,e){var i=this,r=i.imageData,a=!1;return o(e)&&(e=t),t=Z(t),e=Z(e),i.built&&!i.disabled&&i.options.scalable&&(n(t)&&(r.scaleX=t,a=!0),n(e)&&(r.scaleY=e,a=!0),a&&i.renderImage(!0)),i},scaleX:function(t){var e=this,i=e.imageData.scaleY;return e.scale(t,n(i)?i:1)},scaleY:function(t){var e=this,i=e.imageData.scaleX;return e.scale(n(i)?i:1,t)},getData:function(t){var e,i,n=this,o=n.options,r=n.imageData,a=n.canvasData,s=n.cropBoxData;return n.built&&n.cropped?(i={x:s.left-a.left,y:s.top-a.top,width:s.width,height:s.height},e=r.width/r.naturalWidth,d(i,function(n,o){n/=e,i[o]=t?ie(n):n})):i={x:0,y:0,width:0,height:0},o.rotatable&&(i.rotate=r.rotate||0),o.scalable&&(i.scaleX=r.scaleX||1,i.scaleY=r.scaleY||1),i},setData:function(t){var e,i,o,r=this,l=r.options,c=r.imageData,u=r.canvasData,d={};return s(t)&&(t=t.call(r.element)),r.built&&!r.disabled&&a(t)&&(l.rotatable&&n(t.rotate)&&t.rotate!==c.rotate&&(c.rotate=t.rotate,r.rotated=e=!0),l.scalable&&(n(t.scaleX)&&t.scaleX!==c.scaleX&&(c.scaleX=t.scaleX,i=!0),n(t.scaleY)&&t.scaleY!==c.scaleY&&(c.scaleY=t.scaleY,i=!0)),e?r.renderCanvas():i&&r.renderImage(),o=c.width/c.naturalWidth,n(t.x)&&(d.left=t.x*o+u.left),n(t.y)&&(d.top=t.y*o+u.top),n(t.width)&&(d.width=t.width*o),n(t.height)&&(d.height=t.height*o),r.setCropBoxData(d)),r},getContainerData:function(){var t=this;return t.built?t.containerData:{}},getImageData:function(){var t=this;return t.ready?t.imageData:{}},getCanvasData:function(){var t=this,e=t.canvasData,i={};return t.built&&d(["left","top","width","height","naturalWidth","naturalHeight"],function(t){i[t]=e[t]}),i},setCanvasData:function(t){var e=this,i=e.canvasData,o=i.aspectRatio;return s(t)&&(t=t.call(e.element)),e.built&&!e.disabled&&a(t)&&(n(t.left)&&(i.left=t.left),n(t.top)&&(i.top=t.top),n(t.width)?(i.width=t.width,i.height=t.width/o):n(t.height)&&(i.height=t.height,i.width=t.height*o),e.renderCanvas(!0)),e},getCropBoxData:function(){var t,e=this,i=e.cropBoxData;return e.built&&e.cropped&&(t={left:i.left,top:i.top,width:i.width,height:i.height}),t||{}},setCropBoxData:function(t){var e,i,o=this,r=o.cropBoxData,l=o.options.aspectRatio;return s(t)&&(t=t.call(o.element)),o.built&&o.cropped&&!o.disabled&&a(t)&&(n(t.left)&&(r.left=t.left),n(t.top)&&(r.top=t.top),n(t.width)&&(e=!0,r.width=t.width),n(t.height)&&(i=!0,r.height=t.height),l&&(e?r.height=r.width/l:i&&(r.width=r.height*l)),o.renderCropBox()),o},getCroppedCanvas:function(t){var e,i,n,o,r,s,l,c,u,d,h,p=this;return p.built&&p.cropped&&Vt?(a(t)||(t={}),h=p.getData(),e=h.width,i=h.height,c=e/i,a(t)&&(r=t.width,s=t.height,r?(s=r/c,l=r/e):s&&(r=s*c,l=s/i)),n=ne(r||e),o=ne(s||i),u=D("canvas"),u.width=n,u.height=o,d=u.getContext("2d"),t.fillColor&&(d.fillStyle=t.fillColor,d.fillRect(0,0,n,o)),d.drawImage.apply(d,function(){var t,n,o,r,a,s,c=q(p.image,p.imageData),u=c.width,d=c.height,f=p.canvasData,m=[c],g=h.x+f.naturalWidth*(Kt(h.scaleX||1)-1)/2,v=h.y+f.naturalHeight*(Kt(h.scaleY||1)-1)/2;return-e>=g||g>u?g=t=o=a=0:0>=g?(o=-g,g=0,t=a=Jt(u,e+g)):u>=g&&(o=0,t=a=Jt(e,u-g)),0>=t||-i>=v||v>d?v=n=r=s=0:0>=v?(r=-v,v=0,n=s=Jt(d,i+v)):d>=v&&(r=0,n=s=Jt(i,d-v)),m.push(ne(g),ne(v),ne(t),ne(n)),l&&(o*=l,r*=l,a*=l,s*=l),a>0&&s>0&&m.push(ne(o),ne(r),ne(a),ne(s)),m}.call(p)),u):void 0},setAspectRatio:function(t){var e=this,i=e.options;return e.disabled||o(t)||(i.aspectRatio=Gt(0,t)||0/0,e.built&&(e.initCropBox(),e.cropped&&e.renderCropBox())),e},setDragMode:function(t){var e,i,n=this,o=n.options,r=n.dragBox,a=n.face;return n.ready&&!n.disabled&&(e=t===Bt,i=o.movable&&t===Ht,t=e||i?t:Yt,b(r,Mt,t),y(r,st,e),y(r,at,i),o.cropBoxMovable||(b(a,Mt,t),y(a,st,e),y(a,at,i))),n}},H.DEFAULTS={viewMode:0,dragMode:"crop",aspectRatio:0/0,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},H.TEMPLATE=function(t,e){return e=e.split(","),t.replace(/\d+/g,function(t){return e[t]})}('<0 6="5-container"><0 6="5-wrap-9"><0 6="5-canvas"></0></0><0 6="5-drag-9"></0><0 6="5-crop-9"><1 6="5-view-9"></1><1 6="5-8 8-h"></1><1 6="5-8 8-v"></1><1 6="5-center"></1><1 6="5-face"></1><1 6="5-7 7-e" 3-2="e"></1><1 6="5-7 7-n" 3-2="n"></1><1 6="5-7 7-w" 3-2="w"></1><1 6="5-7 7-s" 3-2="s"></1><1 6="5-4 4-e" 3-2="e"></1><1 6="5-4 4-n" 3-2="n"></1><1 6="5-4 4-w" 3-2="w"></1><1 6="5-4 4-s" 3-2="s"></1><1 6="5-4 4-ne" 3-2="ne"></1><1 6="5-4 4-nw" 3-2="nw"></1><1 6="5-4 4-sw" 3-2="sw"></1><1 6="5-4 4-se" 3-2="se"></1></0></0>',"div,span,action,data,point,cropper,class,line,dashed,box");var ue=t.Cropper;return H.noConflict=function(){return t.Cropper=ue,H},H.setDefaults=function(t){h(H.DEFAULTS,t)},"function"==typeof define&&define.amd&&define("cropper",[],function(){return H}),e||(t.Cropper=H),H}),function(t,e){"use strict";"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.returnExports=e()}(this,function(){var t,e=Array,i=e.prototype,n=Object,o=n.prototype,r=Function.prototype,a=String,s=a.prototype,l=Number,c=l.prototype,u=i.slice,d=i.splice,h=i.push,p=i.unshift,f=i.concat,m=r.call,g=Math.max,v=Math.min,y=o.toString,w="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,b=Function.prototype.toString,_=function(t){try{return b.call(t),!0}catch(e){return!1}},x="[object Function]",$="[object GeneratorFunction]";t=function(t){if("function"!=typeof t)return!1;if(w)return _(t);var e=y.call(t);return e===x||e===$};var k,C=RegExp.prototype.exec,T=function(t){try{return C.call(t),!0}catch(e){return!1}},I="[object RegExp]";k=function(t){return"object"!=typeof t?!1:w?T(t):y.call(t)===I};var S,E=String.prototype.valueOf,A=function(t){try{return E.call(t),!0}catch(e){return!1}},D="[object String]";S=function(t){return"string"==typeof t?!0:"object"!=typeof t?!1:w?A(t):y.call(t)===D};var O=function(t){var e,i=n.defineProperty&&function(){try{var t={};n.defineProperty(t,"x",{enumerable:!1,value:t});for(var e in t)return!1;return t.x===t}catch(i){return!1}}();return e=i?function(t,e,i,o){!o&&e in t||n.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:!0,value:i})}:function(t,e,i,n){!n&&e in t||(t[e]=i)},function(i,n,o){for(var r in n)t.call(n,r)&&e(i,r,n[r],o)}}(o.hasOwnProperty),P=function(t){var e=typeof t;return null===t||"object"!==e&&"function"!==e},M=l.isNaN||function(t){return t!==t},N={ToInteger:function(t){var e=+t;return M(e)?e=0:0!==e&&e!==1/0&&e!==-(1/0)&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e},ToPrimitive:function(e){var i,n,o;if(P(e))return e;if(n=e.valueOf,t(n)&&(i=n.call(e),P(i)))return i;if(o=e.toString,t(o)&&(i=o.call(e),P(i)))return i;throw new TypeError},ToObject:function(t){if(null==t)throw new TypeError("can't convert "+t+" to object");return n(t)},ToUint32:function(t){return t>>>0}},R=function(){};O(r,{bind:function(e){var i=this;if(!t(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var o,r=u.call(arguments,1),a=function(){if(this instanceof o){var t=i.apply(this,f.call(r,u.call(arguments)));return n(t)===t?t:this}return i.apply(e,f.call(r,u.call(arguments)))},s=g(0,i.length-r.length),l=[],c=0;s>c;c++)h.call(l,"$"+c);return o=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this, arguments); }")(a),i.prototype&&(R.prototype=i.prototype,o.prototype=new R,R.prototype=null),o}});var L=m.bind(o.hasOwnProperty),j=m.bind(o.toString),F=m.bind(s.slice),q=m.bind(s.split),U=e.isArray||function(t){return"[object Array]"===j(t)},z=1!==[].unshift(0);O(i,{unshift:function(){return p.apply(this,arguments),this.length}},z),O(e,{isArray:U});var W=n("a"),B="a"!==W[0]||!(0 in W),H=function(t){var e=!0,i=!0;return t&&(t.call("foo",function(t,i,n){"object"!=typeof n&&(e=!1)}),t.call([1],function(){"use strict";i="string"==typeof this},"x")),!!t&&e&&i};O(i,{forEach:function(e){var i,n=N.ToObject(this),o=B&&S(this)?q(this,""):n,r=-1,a=N.ToUint32(o.length);if(arguments.length>1&&(i=arguments[1]),
!t(e))throw new TypeError("Array.prototype.forEach callback must be a function");for(;++r<a;)r in o&&("undefined"==typeof i?e(o[r],r,n):e.call(i,o[r],r,n))}},!H(i.forEach)),O(i,{map:function(i){var n,o=N.ToObject(this),r=B&&S(this)?q(this,""):o,a=N.ToUint32(r.length),s=e(a);if(arguments.length>1&&(n=arguments[1]),!t(i))throw new TypeError("Array.prototype.map callback must be a function");for(var l=0;a>l;l++)l in r&&(s[l]="undefined"==typeof n?i(r[l],l,o):i.call(n,r[l],l,o));return s}},!H(i.map)),O(i,{filter:function(e){var i,n,o=N.ToObject(this),r=B&&S(this)?q(this,""):o,a=N.ToUint32(r.length),s=[];if(arguments.length>1&&(n=arguments[1]),!t(e))throw new TypeError("Array.prototype.filter callback must be a function");for(var l=0;a>l;l++)l in r&&(i=r[l],("undefined"==typeof n?e(i,l,o):e.call(n,i,l,o))&&h.call(s,i));return s}},!H(i.filter)),O(i,{every:function(e){var i,n=N.ToObject(this),o=B&&S(this)?q(this,""):n,r=N.ToUint32(o.length);if(arguments.length>1&&(i=arguments[1]),!t(e))throw new TypeError("Array.prototype.every callback must be a function");for(var a=0;r>a;a++)if(a in o&&!("undefined"==typeof i?e(o[a],a,n):e.call(i,o[a],a,n)))return!1;return!0}},!H(i.every)),O(i,{some:function(e){var i,n=N.ToObject(this),o=B&&S(this)?q(this,""):n,r=N.ToUint32(o.length);if(arguments.length>1&&(i=arguments[1]),!t(e))throw new TypeError("Array.prototype.some callback must be a function");for(var a=0;r>a;a++)if(a in o&&("undefined"==typeof i?e(o[a],a,n):e.call(i,o[a],a,n)))return!0;return!1}},!H(i.some));var X=!1;i.reduce&&(X="object"==typeof i.reduce.call("es5",function(t,e,i,n){return n})),O(i,{reduce:function(e){var i=N.ToObject(this),n=B&&S(this)?q(this,""):i,o=N.ToUint32(n.length);if(!t(e))throw new TypeError("Array.prototype.reduce callback must be a function");if(0===o&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var r,a=0;if(arguments.length>=2)r=arguments[1];else for(;;){if(a in n){r=n[a++];break}if(++a>=o)throw new TypeError("reduce of empty array with no initial value")}for(;o>a;a++)a in n&&(r=e(r,n[a],a,i));return r}},!X);var Y=!1;i.reduceRight&&(Y="object"==typeof i.reduceRight.call("es5",function(t,e,i,n){return n})),O(i,{reduceRight:function(e){var i=N.ToObject(this),n=B&&S(this)?q(this,""):i,o=N.ToUint32(n.length);if(!t(e))throw new TypeError("Array.prototype.reduceRight callback must be a function");if(0===o&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var r,a=o-1;if(arguments.length>=2)r=arguments[1];else for(;;){if(a in n){r=n[a--];break}if(--a<0)throw new TypeError("reduceRight of empty array with no initial value")}if(0>a)return r;do a in n&&(r=e(r,n[a],a,i));while(a--);return r}},!Y);var V=i.indexOf&&-1!==[0,1].indexOf(1,2);O(i,{indexOf:function(t){var e=B&&S(this)?q(this,""):N.ToObject(this),i=N.ToUint32(e.length);if(0===i)return-1;var n=0;for(arguments.length>1&&(n=N.ToInteger(arguments[1])),n=n>=0?n:g(0,i+n);i>n;n++)if(n in e&&e[n]===t)return n;return-1}},V);var Q=i.lastIndexOf&&-1!==[0,1].lastIndexOf(0,-3);O(i,{lastIndexOf:function(t){var e=B&&S(this)?q(this,""):N.ToObject(this),i=N.ToUint32(e.length);if(0===i)return-1;var n=i-1;for(arguments.length>1&&(n=v(n,N.ToInteger(arguments[1]))),n=n>=0?n:i-Math.abs(n);n>=0;n--)if(n in e&&t===e[n])return n;return-1}},Q);var J=function(){var t=[1,2],e=t.splice();return 2===t.length&&U(e)&&0===e.length}();O(i,{splice:function(t,e){return 0===arguments.length?[]:d.apply(this,arguments)}},!J);var G=function(){var t={};return i.splice.call(t,0,0,1),1===t.length}();O(i,{splice:function(t,e){if(0===arguments.length)return[];var i=arguments;return this.length=g(N.ToInteger(this.length),0),arguments.length>0&&"number"!=typeof e&&(i=u.call(arguments),i.length<2?h.call(i,this.length-t):i[1]=N.ToInteger(e)),d.apply(this,i)}},!G);var K=function(){var t=new e(1e5);return t[8]="x",t.splice(1,1),7===t.indexOf("x")}(),Z=function(){var t=256,e=[];return e[t]="a",e.splice(t+1,0,"b"),"a"===e[t]}();O(i,{splice:function(t,e){for(var i,n=N.ToObject(this),o=[],r=N.ToUint32(n.length),s=N.ToInteger(t),l=0>s?g(r+s,0):v(s,r),c=v(g(N.ToInteger(e),0),r-l),d=0;c>d;)i=a(l+d),L(n,i)&&(o[d]=n[i]),d+=1;var h,p=u.call(arguments,2),f=p.length;if(c>f){for(d=l;r-c>d;)i=a(d+c),h=a(d+f),L(n,i)?n[h]=n[i]:delete n[h],d+=1;for(d=r;d>r-c+f;)delete n[d-1],d-=1}else if(f>c)for(d=r-c;d>l;)i=a(d+c-1),h=a(d+f-1),L(n,i)?n[h]=n[i]:delete n[h],d-=1;d=l;for(var m=0;m<p.length;++m)n[d]=p[m],d+=1;return n.length=r-c+f,o}},!K||!Z);var tt=!{toString:null}.propertyIsEnumerable("toString"),et=function(){}.propertyIsEnumerable("prototype"),it=!L("x","0"),nt=function(t){var e=t.constructor;return e&&e.prototype===t},ot={$window:!0,$console:!0,$parent:!0,$self:!0,$frames:!0,$frameElement:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0},rt=function(){if("undefined"==typeof window)return!1;for(var t in window)try{!ot["$"+t]&&L(window,t)&&null!==window[t]&&"object"==typeof window[t]&&nt(window[t])}catch(e){return!0}return!1}(),at=function(t){if("undefined"==typeof window||!rt)return nt(t);try{return nt(t)}catch(e){return!1}},st=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],lt=st.length,ct=function(t){return"[object Arguments]"===j(t)},ut=function(e){return null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&!U(e)&&t(e.callee)},dt=ct(arguments)?ct:ut;O(n,{keys:function(e){var i=t(e),n=dt(e),o=null!==e&&"object"==typeof e,r=o&&S(e);if(!o&&!i&&!n)throw new TypeError("Object.keys called on a non-object");var s=[],l=et&&i;if(r&&it||n)for(var c=0;c<e.length;++c)h.call(s,a(c));if(!n)for(var u in e)l&&"prototype"===u||!L(e,u)||h.call(s,a(u));if(tt)for(var d=at(e),p=0;lt>p;p++){var f=st[p];d&&"constructor"===f||!L(e,f)||h.call(s,f)}return s}});var ht=n.keys&&function(){return 2===n.keys(arguments).length}(1,2),pt=n.keys&&function(){var t=n.keys(arguments);return 1!==arguments.length||1!==t.length||1!==t[0]}(1),ft=n.keys;O(n,{keys:function(t){return ft(dt(t)?u.call(t):t)}},!ht||pt);var mt=-621987552e5,gt="-000001",vt=Date.prototype.toISOString&&-1===new Date(mt).toISOString().indexOf(gt),yt=Date.prototype.toISOString&&"1969-12-31T23:59:59.999Z"!==new Date(-1).toISOString();O(Date.prototype,{toISOString:function(){var t,e,i,n,o;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(n=this.getUTCFullYear(),o=this.getUTCMonth(),n+=Math.floor(o/12),o=(o%12+12)%12,t=[o+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],n=(0>n?"-":n>9999?"+":"")+F("00000"+Math.abs(n),n>=0&&9999>=n?-4:-6),e=t.length;e--;)i=t[e],10>i&&(t[e]="0"+i);return n+"-"+u.call(t,0,2).join("-")+"T"+u.call(t,2).join(":")+"."+F("000"+this.getUTCMilliseconds(),-3)+"Z"}},vt||yt);var wt=function(){try{return Date.prototype.toJSON&&null===new Date(0/0).toJSON()&&-1!==new Date(mt).toJSON().indexOf(gt)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(t){return!1}}();wt||(Date.prototype.toJSON=function(e){var i=n(this),o=N.ToPrimitive(i);if("number"==typeof o&&!isFinite(o))return null;var r=i.toISOString;if(!t(r))throw new TypeError("toISOString property is not callable");return r.call(i)});var bt=1e15===Date.parse("+033658-09-27T01:46:40.000Z"),_t=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z")),xt=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));(xt||_t||!bt)&&(Date=function(t){var e=function(i,n,o,r,s,l,c){var u,d=arguments.length;return u=this instanceof t?1===d&&a(i)===i?new t(e.parse(i)):d>=7?new t(i,n,o,r,s,l,c):d>=6?new t(i,n,o,r,s,l):d>=5?new t(i,n,o,r,s):d>=4?new t(i,n,o,r):d>=3?new t(i,n,o):d>=2?new t(i,n):d>=1?new t(i):new t:t.apply(this,arguments),P(u)||O(u,{constructor:e},!0),u},i=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),n=[0,31,59,90,120,151,181,212,243,273,304,334,365],o=function(t,e){var i=e>1?1:0;return n[e]+Math.floor((t-1969+i)/4)-Math.floor((t-1901+i)/100)+Math.floor((t-1601+i)/400)+365*(t-1970)},r=function(e){return l(new t(1970,0,1,0,0,0,e))};for(var s in t)L(t,s)&&(e[s]=t[s]);O(e,{now:t.now,UTC:t.UTC},!0),e.prototype=t.prototype,O(e.prototype,{constructor:e},!0);var c=function(e){var n=i.exec(e);if(n){var a,s=l(n[1]),c=l(n[2]||1)-1,u=l(n[3]||1)-1,d=l(n[4]||0),h=l(n[5]||0),p=l(n[6]||0),f=Math.floor(1e3*l(n[7]||0)),m=Boolean(n[4]&&!n[8]),g="-"===n[9]?1:-1,v=l(n[10]||0),y=l(n[11]||0),w=h>0||p>0||f>0;return(w?24:25)>d&&60>h&&60>p&&1e3>f&&c>-1&&12>c&&24>v&&60>y&&u>-1&&u<o(s,c+1)-o(s,c)&&(a=60*(24*(o(s,c)+u)+d+v*g),a=1e3*(60*(a+h+y*g)+p)+f,m&&(a=r(a)),a>=-864e13&&864e13>=a)?a:0/0}return t.parse.apply(this,arguments)};return O(e,{parse:c}),e}(Date)),Date.now||(Date.now=function(){return(new Date).getTime()});var $t=c.toFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==0xde0b6b3a7640080.toFixed(0)),kt={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function(t,e){for(var i=-1,n=e;++i<kt.size;)n+=t*kt.data[i],kt.data[i]=n%kt.base,n=Math.floor(n/kt.base)},divide:function(t){for(var e=kt.size,i=0;--e>=0;)i+=kt.data[e],kt.data[e]=Math.floor(i/t),i=i%t*kt.base},numToString:function(){for(var t=kt.size,e="";--t>=0;)if(""!==e||0===t||0!==kt.data[t]){var i=a(kt.data[t]);""===e?e=i:e+=F("0000000",0,7-i.length)+i}return e},pow:function Nt(t,e,i){return 0===e?i:e%2===1?Nt(t,e-1,i*t):Nt(t*t,e/2,i)},log:function(t){for(var e=0,i=t;i>=4096;)e+=12,i/=4096;for(;i>=2;)e+=1,i/=2;return e}};O(c,{toFixed:function(t){var e,i,n,o,r,s,c,u;if(e=l(t),e=M(e)?0:Math.floor(e),0>e||e>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(i=l(this),M(i))return"NaN";if(-1e21>=i||i>=1e21)return a(i);if(n="",0>i&&(n="-",i=-i),o="0",i>1e-21)if(r=kt.log(i*kt.pow(2,69,1))-69,s=0>r?i*kt.pow(2,-r,1):i/kt.pow(2,r,1),s*=4503599627370496,r=52-r,r>0){for(kt.multiply(0,s),c=e;c>=7;)kt.multiply(1e7,0),c-=7;for(kt.multiply(kt.pow(10,c,1),0),c=r-1;c>=23;)kt.divide(1<<23),c-=23;kt.divide(1<<c),kt.multiply(1,1),kt.divide(2),o=kt.numToString()}else kt.multiply(0,s),kt.multiply(1<<-r,0),o=kt.numToString()+F("0.00000000000000000000",2,2+e);return e>0?(u=o.length,o=e>=u?n+F("0.0000000000000000000",0,e-u+2)+o:n+F(o,0,u-e)+"."+F(o,u-e)):o=n+o,o}},$t),2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var t="undefined"==typeof/()??/.exec("")[1],e=Math.pow(2,32)-1;s.split=function(i,n){var o=this;if("undefined"==typeof i&&0===n)return[];if(!k(i))return q(this,i,n);var r,a,s,l,c=[],d=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),p=0,f=new RegExp(i.source,d+"g");o+="",t||(r=new RegExp("^"+f.source+"$(?!\\s)",d));var m="undefined"==typeof n?e:N.ToUint32(n);for(a=f.exec(o);a&&(s=a.index+a[0].length,!(s>p&&(h.call(c,F(o,p,a.index)),!t&&a.length>1&&a[0].replace(r,function(){for(var t=1;t<arguments.length-2;t++)"undefined"==typeof arguments[t]&&(a[t]=void 0)}),a.length>1&&a.index<o.length&&h.apply(c,u.call(a,1)),l=a[0].length,p=s,c.length>=m)));)f.lastIndex===a.index&&f.lastIndex++,a=f.exec(o);return p===o.length?(l||!f.test(""))&&h.call(c,""):h.call(c,F(o,p)),c.length>m?F(c,0,m):c}}():"0".split(void 0,0).length&&(s.split=function(t,e){return"undefined"==typeof t&&0===e?[]:q(this,t,e)});var Ct=s.replace,Tt=function(){var t=[];return"x".replace(/x(.)?/g,function(e,i){h.call(t,i)}),1===t.length&&"undefined"==typeof t[0]}();Tt||(s.replace=function(e,i){var n=t(i),o=k(e)&&/\)[*?]/.test(e.source);if(n&&o){var r=function(t){var n=arguments.length,o=e.lastIndex;e.lastIndex=0;var r=e.exec(t)||[];return e.lastIndex=o,h.call(r,arguments[n-2],arguments[n-1]),i.apply(this,r)};return Ct.call(this,e,r)}return Ct.call(this,e,i)});var It=s.substr,St="".substr&&"b"!=="0b".substr(-1);O(s,{substr:function(t,e){var i=t;return 0>t&&(i=g(this.length+t,0)),It.call(this,i,e)}},St);var Et="	\n\f\r   ᠎             　\u2028\u2029\ufeff",At="​",Dt="["+Et+"]",Ot=new RegExp("^"+Dt+Dt+"*"),Pt=new RegExp(Dt+Dt+"*$"),Mt=s.trim&&(Et.trim()||!At.trim());O(s,{trim:function(){if("undefined"==typeof this||null===this)throw new TypeError("can't convert "+this+" to object");return a(this).replace(Ot,"").replace(Pt,"")}},Mt),(8!==parseInt(Et+"08")||22!==parseInt(Et+"0x16"))&&(parseInt=function(t){var e=/^0[xX]/;return function(i,n){var o=a(i).trim(),r=l(n)||(e.test(o)?16:10);return t(o,r)}}(parseInt))}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.stream=e():t.stream=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="dist/",e(0)}([function(t,e,i){(function(e){"use strict";function n(t,i,n,r){if("undefined"!=typeof e&&e.env.STREAM_URL&&!t){var a=/https\:\/\/(\w+)\:(\w+)\@([\w-]*).*\?app_id=(\d+)/.exec(e.env.STREAM_URL);t=a[1],i=a[2];var s=a[3];n=a[4],void 0===r&&(r={}),"getstream"!==s&&(r.location=s)}return new o(t,i,n,r)}var o=i(2),r=i(5),a=i(3);t.exports.connect=n,t.exports.errors=r,t.exports.request=a,t.exports.Client=o}).call(e,i(1))},function(t,e){function i(){d&&c&&(d=!1,c.length?u=c.concat(u):h=-1,u.length&&n())}function n(){if(!d){var t=a(i);d=!0;for(var e=u.length;e;){for(c=u,u=[];++h<e;)c&&c[h].run();h=-1,e=u.length}c=null,d=!1,s(t)}}function o(t,e){this.fun=t,this.array=e}function r(){}var a,s,l=t.exports={};!function(){try{a=setTimeout}catch(t){a=function(){throw new Error("setTimeout is not defined")}}try{s=clearTimeout}catch(t){s=function(){throw new Error("clearTimeout is not defined")}}}();var c,u=[],d=!1,h=-1;l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];u.push(new o(t,e)),1!==u.length||d||a(n,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=r,l.addListener=r,l.once=r,l.off=r,l.removeListener=r,l.removeAllListeners=r,l.emit=r,l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(t,e,i){(function(e){"use strict";var n=i(3),o=i(4),r=i(7),a=i(5),s=i(6),l=i(9),c=i(11),u=i(9),d=i(15),h=i(16),p=function(){this.initialize.apply(this,arguments)};if(p.prototype={baseUrl:"https://api.getstream.io/api/",baseAnalyticsUrl:"https://analytics.getstream.io/analytics/",initialize:function(t,i,n,o){if(this.apiKey=t,this.apiSecret=i,this.appId=n,this.options=o||{},this.version=this.options.version||"v1.0",this.fayeUrl=this.options.fayeUrl||"https://faye.getstream.io/faye",this.fayeClient=null,this.group=this.options.group||"unspecified",this.subscriptions={},this.expireTokens=this.options.expireTokens?this.options.expireTokens:!1,this.location=this.options.location,this.location&&(this.baseUrl="https://"+this.location+"-api.getstream.io/api/"),"undefined"!=typeof e&&e.env.LOCAL&&(this.baseUrl="http://localhost:8000/api/"),"undefined"!=typeof e&&e.env.LOCAL_FAYE&&(this.fayeUrl="http://localhost:9999/faye/"),"undefined"!=typeof e&&e.env.STREAM_BASE_URL&&(this.baseUrl=e.env.STREAM_BASE_URL),this.handlers={},this.browser="undefined"!=typeof window,this.node=!this.browser,this.browser&&this.apiSecret)throw new a.FeedError("You are publicly sharing your private key. Dont use the private key while in the browser.")},on:function(t,e){this.handlers[t]=e},off:function(t){void 0===t?this.handlers={}:delete this.handlers[t]},send:function(){var t=Array.prototype.slice.call(arguments),e=t[0];t=t.slice(1),this.handlers[e]&&this.handlers[e].apply(this,t)},wrapPromiseTask:function(t,e,i){var n=this,o=this.wrapCallback(t);return function(t,r,a){t?i({error:t,response:r}):/^2/.test(""+r.statusCode)?e(a):i({error:a,response:r}),o.apply(n,arguments)}},wrapCallback:function(t){function e(){var e=Array.prototype.slice.call(arguments),n=["response"].concat(e);i.send.apply(i,n),void 0!==t&&t.apply(i,e)}var i=this;return e},userAgent:function(){var t=this.node?"node":"browser",e="unknown";return"stream-javascript-client-"+t+"-"+e},getReadOnlyToken:function(t,e){return this.feed(t,e).getReadOnlyToken()},getReadWriteToken:function(t,e){return this.feed(t,e).getReadWriteToken()},feed:function m(t,e,i,n,l){if(l=l||{},!t||!e)throw new a.FeedError('Please provide a feed slug and user id, ie client.feed("user", "1")');if(-1!==t.indexOf(":"))throw new a.FeedError('Please initialize the feed using client.feed("user", "1") not client.feed("user:1")');if(s.validateFeedSlug(t),s.validateUserId(e),!this.apiSecret&&!i)throw new a.FeedError("Missing token, in client side mode please provide a feed secret");if(this.apiSecret&&!i){var c=""+t+e;i=l.readOnly?this.getReadOnlyToken(t,e):r.sign(this.apiSecret,c)}var m=new o(this,t,e,i,n);return m},enrichUrl:function(t){var e=this.baseUrl+this.version+"/"+t;return e},enrichKwargs:function(t){t.url=this.enrichUrl(t.url),void 0===t.qs&&(t.qs={}),t.qs.api_key=this.apiKey,t.qs.location=this.group,t.json=!0;var e=t.signature||this.signature;return t.headers={},r.isJWTSignature(e)?(t.headers["stream-auth-type"]="jwt",e=e.split(" ").reverse()[0]):t.headers["stream-auth-type"]="simple",t.headers.Authorization=e,t.headers["X-Stream-Client"]=this.userAgent(),t},signActivity:function(t){return this.signActivities([t])[0]},signActivities:function(t){if(!this.apiSecret)return t;for(var e=0;e<t.length;e++){for(var i=t[e],n=i.to||[],o=[],r=0;r<n.length;r++){var a=n[r],s=a.split(":")[0],l=a.split(":")[1],c=this.feed(s,l).token,u=a+" "+c;o.push(u)}i.to=o}return t},getFayeAuthorization:function(){var t=this.apiKey,e=this;return{incoming:function(t,e){e(t)},outgoing:function(i,n){if(i.subscription&&e.subscriptions[i.subscription]){var o=e.subscriptions[i.subscription];i.ext={user_id:o.userId,api_key:t,signature:o.token}}n(i)}}},getFayeClient:function(){if(null===this.fayeClient){this.fayeClient=new h.Client(this.fayeUrl);var t=this.getFayeAuthorization();this.fayeClient.addExtension(t)}return this.fayeClient},get:function(t,e){return new c(function(i,o){this.send("request","get",t,e),t=this.enrichKwargs(t),t.method="GET";var r=this.wrapPromiseTask(e,i,o);n(t,r)}.bind(this))},post:function(t,e){return new c(function(i,o){this.send("request","post",t,e),t=this.enrichKwargs(t),t.method="POST";var r=this.wrapPromiseTask(e,i,o);n(t,r)}.bind(this))},"delete":function(t,e){return new c(function(i,o){this.send("request","delete",t,e),t=this.enrichKwargs(t),t.method="DELETE";var r=this.wrapPromiseTask(e,i,o);n(t,r)}.bind(this))},updateActivities:function(t,e){if(!(t instanceof Array))throw new TypeError("The activities argument should be an Array");var i=r.JWTScopeToken(this.apiSecret,"activities","*",{feedId:"*",expireTokens:this.expireTokens}),n={activities:t};return this.post({url:"activities/",body:n,signature:i},e)},updateActivity:function(t){return this.updateActivities([t])}},u&&(p.prototype.createRedirectUrl=function(t,e,i){var n=d.parse(t);if(!(n.host||n.hostname&&n.port||n.isUnix))throw new a.MissingSchemaError('Invalid URI: "'+d.format(n)+'"');var o=r.JWTScopeToken(this.apiSecret,"redirect_and_track","*",{userId:e,expireTokens:this.expireTokens}),l=this.baseAnalyticsUrl+"redirect/",c={auth_type:"jwt",authorization:o,url:t,api_key:this.apiKey,events:JSON.stringify(i)},h=s.rfc3986(u.stringify(c,null,null,{}));return l+"?"+h}),l)for(var f in l)l.hasOwnProperty(f)&&(p.prototype[f]=l[f]);t.exports=p}).call(e,i(1))},function(t,e){function i(t,e){if("function"!=typeof e)throw new Error("Bad callback given: "+e);if(!t)throw new Error("No options given");var a=t.onResponse;if(t="string"==typeof t?{uri:t}:JSON.parse(JSON.stringify(t)),t.onResponse=a,t.verbose&&(i.log=r()),t.url&&(t.uri=t.url,delete t.url),!t.uri&&""!==t.uri)throw new Error("options.uri is a required argument");if("string"!=typeof t.uri)throw new Error("options.uri must be a string");for(var s=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],c=0;c<s.length;c++)if(t[s[c]])throw new Error("options."+s[c]+" is not supported");if(t.callback=e,t.method=t.method||"GET",t.headers=t.headers||{},t.body=t.body||null,t.timeout=t.timeout||i.DEFAULT_TIMEOUT,t.headers.host)throw new Error("Options.headers.host is not supported");t.json&&(t.headers.accept=t.headers.accept||"application/json","GET"!==t.method&&(t.headers["content-type"]="application/json"),"boolean"!=typeof t.json?t.body=JSON.stringify(t.json):"string"!=typeof t.body&&null!==t.body&&(t.body=JSON.stringify(t.body)));var u=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e.join("&")};if(t.qs){var d="string"==typeof t.qs?t.qs:u(t.qs);t.uri=-1!==t.uri.indexOf("?")?t.uri+"&"+d:t.uri+"?"+d}var h=function(t){var e={};e.boundry="-------------------------------"+Math.floor(1e9*Math.random());var i=[];for(var n in t)t.hasOwnProperty(n)&&i.push("--"+e.boundry+'\nContent-Disposition: form-data; name="'+n+'"\n\n'+t[n]+"\n");return i.push("--"+e.boundry+"--"),e.body=i.join(""),e.length=e.body.length,e.type="multipart/form-data; boundary="+e.boundry,e};if(t.form){if("string"==typeof t.form)throw"form name unsupported";if("POST"===t.method){var p=(t.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(t.headers["content-type"]=p,p){case"application/x-www-form-urlencoded":t.body=u(t.form).replace(/%20/g,"+");break;case"multipart/form-data":var f=h(t.form);t.body=f.body,t.headers["content-type"]=f.type;break;default:throw new Error("unsupported encoding:"+p)}}}return t.onResponse=t.onResponse||o,t.onResponse===!0&&(t.onResponse=e,t.callback=o),!t.headers.authorization&&t.auth&&(t.headers.authorization="Basic "+l(t.auth.username+":"+t.auth.password)),n(t)}function n(t){function e(){u=!0;var e=new Error("ETIMEDOUT");return e.code="ETIMEDOUT",e.duration=t.timeout,i.log.error("Timeout",{id:l._id,milliseconds:t.timeout}),t.callback(e,l)}function n(t){return u?i.log.debug("Ignoring timed out state change",{state:l.readyState,id:l.id}):(i.log.debug("State change",{state:l.readyState,id:l.id,timed_out:u}),void(1===l.readyState?i.log.debug("Request started",{id:l.id}):2===l.readyState?o():3===l.readyState?(o(),r()):4===l.readyState&&(o(),r(),a())))}function o(){if(!m.response){if(m.response=!0,i.log.debug("Got response",{id:l.id,status:l.status}),clearTimeout(l.timeoutTimer),l.statusCode=l.status,h&&0==l.statusCode){var e=new Error("CORS request rejected: "+t.uri);return e.cors="rejected",m.loading=!0,m.end=!0,t.callback(e,l)}t.onResponse(null,l)}}function r(){m.loading||(m.loading=!0,i.log.debug("Response body loading",{id:l.id}))}function a(){if(!m.end){if(m.end=!0,i.log.debug("Request done",{id:l.id}),l.body=l.responseText,t.json)try{l.body=JSON.parse(l.responseText)}catch(e){return t.callback(e,l)}t.callback(null,l,l.body)}}var l=new c,u=!1,h=s(t.uri),p="withCredentials"in l;if(d+=1,l.seq_id=d,l.id=d+": "+t.method+" "+t.uri,l._id=l.id,h&&!p){var f=new Error("Browser does not support cross-origin request: "+t.uri);return f.cors="unsupported",t.callback(f,l)}l.timeoutTimer=setTimeout(e,t.timeout);var m={response:!1,loading:!1,end:!1};l.onreadystatechange=n,l.open(t.method,t.uri,!0),h&&(l.withCredentials=!!t.withCredentials);for(var g in t.headers)l.setRequestHeader(g,t.headers[g]);return l.send(t.body),l}function o(){}function r(){var t,e,i={},n=["trace","debug","info","warn","error"];for(e=0;e<n.length;e++)t=n[e],i[t]=o,"undefined"!=typeof console&&console&&console[t]&&(i[t]=a(console,t));return i}function a(t,e){function i(i,n){return"object"==typeof n&&(i+=" "+JSON.stringify(n)),t[e].call(t,i)}return i}function s(t){if(!window.location)return!1;var e,i=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{e=location.href}catch(n){e=document.createElement("a"),e.href="",e=e.href}var o=i.exec(e.toLowerCase())||[],r=i.exec(t.toLowerCase()),a=!(!r||r[1]==o[1]&&r[2]==o[2]&&(r[3]||("http:"===r[1]?80:443))==(o[3]||("http:"===o[1]?80:443)));return a}function l(t){var e,i,n,o,r,a,s,l,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,d=0,h="",p=[];if(!t)return t;do e=t.charCodeAt(u++),i=t.charCodeAt(u++),n=t.charCodeAt(u++),l=e<<16|i<<8|n,o=l>>18&63,r=l>>12&63,a=l>>6&63,s=63&l,p[d++]=c.charAt(o)+c.charAt(r)+c.charAt(a)+c.charAt(s);while(u<t.length);switch(h=p.join(""),t.length%3){case 1:h=h.slice(0,-2)+"==";break;case 2:h=h.slice(0,-1)+"="}return h}var c=XMLHttpRequest;if(!c)throw new Error("missing XMLHttpRequest");i.log={trace:o,debug:o,info:o,warn:o,error:o};var u=18e4,d=0;i.withCredentials=!1,i.DEFAULT_TIMEOUT=u,i.defaults=function(t,e){var n=function(e){var i=function(i,n){i="string"==typeof i?{uri:i}:JSON.parse(JSON.stringify(i));for(var o in t)void 0===i[o]&&(i[o]=t[o]);return e(i,n)};return i},o=n(i);return o.get=n(i.get),o.post=n(i.post),o.put=n(i.put),o.head=n(i.head),o};var h=["get","put","post","head"];h.forEach(function(t){var e=t.toUpperCase(),n=t.toLowerCase();i[n]=function(t){"string"==typeof t?t={method:e,uri:t}:(t=JSON.parse(JSON.stringify(t)),t.method=e);var n=[t].concat(Array.prototype.slice.apply(arguments,[1]));return i.apply(this,n)}}),i.couch=function(t,e){function n(t,i,n){if(t)return e(t,i,n);if((i.statusCode<200||i.statusCode>299)&&n.error){t=new Error("CouchDB error: "+(n.error.reason||n.error.error));for(var o in n)t[o]=n[o];return e(t,i,n)}return e(t,i,n)}"string"==typeof t&&(t={uri:t}),t.json=!0,t.body&&(t.json=t.body),delete t.body,e=e||o;var r=i(t,n);return r},t.exports=i},function(t,e,i){"use strict";var n=i(5),o=i(6),r=i(7),a=function(){this.initialize.apply(this,arguments)};a.prototype={initialize:function(t,e,i,n){this.client=t,this.slug=e,this.userId=i,this.id=this.slug+":"+this.userId,this.token=n,this.feedUrl=this.id.replace(":","/"),this.feedTogether=this.id.replace(":",""),this.signature=this.feedTogether+" "+this.token,this.notificationChannel="site-"+this.client.appId+"-feed-"+this.feedTogether},addActivity:function(t,e){return t=this.client.signActivity(t),this.client.post({url:"feed/"+this.feedUrl+"/",body:t,signature:this.signature},e)},removeActivity:function(t,e){var i=t.foreignId?t.foreignId:t,n={};return t.foreignId&&(n.foreign_id="1"),this.client["delete"]({url:"feed/"+this.feedUrl+"/"+i+"/",qs:n,signature:this.signature},e)},addActivities:function(t,e){t=this.client.signActivities(t);var i={activities:t},n=this.client.post({url:"feed/"+this.feedUrl+"/",body:i,signature:this.signature},e);return n},follow:function(t,e,i,n){o.validateFeedSlug(t),o.validateUserId(e);var r,a=arguments[arguments.length-1];n=a.call?a:void 0;var s=t+":"+e;i&&!i.call&&"undefined"!=typeof i.limit&&null!==i.limit&&(r=i.limit);var l={target:s};return"undefined"!=typeof r&&null!==r&&(l.activity_copy_limit=r),this.client.post({url:"feed/"+this.feedUrl+"/following/",body:l,signature:this.signature},n)},unfollow:function(t,e,i,n){var r={},a={};"function"==typeof i&&(n=i),"object"==typeof i&&(r=i),"boolean"==typeof r.keepHistory&&r.keepHistory&&(a.keep_history="1"),o.validateFeedSlug(t),o.validateUserId(e);var s=t+":"+e,l=this.client["delete"]({url:"feed/"+this.feedUrl+"/following/"+s+"/",qs:a,signature:this.signature},n);return l},following:function(t,e){return void 0!==t&&t.filter&&(t.filter=t.filter.join(",")),this.client.get({url:"feed/"+this.feedUrl+"/following/",qs:t,signature:this.signature},e)},followers:function(t,e){return void 0!==t&&t.filter&&(t.filter=t.filter.join(",")),this.client.get({url:"feed/"+this.feedUrl+"/followers/",qs:t,signature:this.signature},e)},get:function(t,e){return t&&t.mark_read&&t.mark_read.join&&(t.mark_read=t.mark_read.join(",")),t&&t.mark_seen&&t.mark_seen.join&&(t.mark_seen=t.mark_seen.join(",")),this.client.get({url:"feed/"+this.feedUrl+"/",qs:t,signature:this.signature},e)},getFayeClient:function(){return this.client.getFayeClient()},subscribe:function(t){if(!this.client.appId)throw new n.SiteError("Missing app id, which is needed to subscribe, use var client = stream.connect(key, secret, appId);");return this.client.subscriptions["/"+this.notificationChannel]={token:this.token,userId:this.notificationChannel},this.getFayeClient().subscribe("/"+this.notificationChannel,t)},getReadOnlyToken:function(){var t=""+this.slug+this.userId;return r.JWTScopeToken(this.client.apiSecret,"*","read",{feedId:t,expireTokens:this.client.expireTokens})},getReadWriteToken:function(){var t=""+this.slug+this.userId;return r.JWTScopeToken(this.client.apiSecret,"*","*",{feedId:t,expireTokens:this.client.expireTokens})}},t.exports=a},function(t,e){"use strict";function i(t,e){this.message=t,Error.call(this,this.message),o?Error.captureStackTrace(this,e):this.stack=r?(new Error).stack:""}var n=t.exports,o="function"==typeof Error.captureStackTrace,r=!!(new Error).stack;n._Abstract=i,i.prototype=new Error,n.FeedError=function(t){i.call(this,t)},n.FeedError.prototype=new i,n.SiteError=function(t){i.call(this,t)},n.SiteError.prototype=new i,n.MissingSchemaError=function(t){i.call(this,t)},n.MissingSchemaError.prototype=new i},function(t,e,i){"use strict";function n(t){var e=t.split(":");if(2!==e.length)throw new s.FeedError("Invalid feedId, expected something like user:1 got "+t);var i=e[0],n=e[1];return o(i),r(n),t}function o(t){var e=l.test(t);if(!e)throw new s.FeedError("Invalid feedSlug, please use letters, numbers or _ got: "+t);return t}function r(t){var e=l.test(t);if(!e)throw new s.FeedError("Invalid feedSlug, please use letters, numbers or _ got: "+t);return t}function a(t){return t.replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}var s=i(5),l=/^[\w-]+$/;e.validateFeedId=n,e.validateFeedSlug=o,e.validateUserId=r,e.rfc3986=a},function(t,e,i){"use strict";function n(t){var e=t.replace(/\+/g,"-").replace(/\//g,"_");return e.replace(/^=+/,"").replace(/=+$/,"")}function o(t){try{return h.atob(s(t))}catch(e){if("InvalidCharacterError"===e.name)return void 0;throw e}}function r(t){if("object"==typeof t)return t;try{return JSON.parse(t)}catch(e){return void 0}}function a(t){var e=4,i=t.length%e;if(!i)return t;for(var n=e-i;n--;)t+="=";return t}function s(t){var e=a(t).replace(/\-/g,"+").replace(/_/g,"/");return e}function l(t){var e=t.split(".",1)[0];return r(o(e))}var c=i(8),u=i(9),d=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/,h=i(10);e.headerFromJWS=l,e.sign=function(t,e){var i=new c.createHash("sha1").update(t).digest(),o=c.createHmac("sha1",i),r=o.update(e).digest("base64"),a=n(r);return a},e.JWTScopeToken=function(t,e,i,n){var o=n||{},r=o.expireTokens?!o.expireTokens:!0,a={resource:e,action:i};o.feedId&&(a.feed_id=o.feedId),o.userId&&(a.user_id=o.userId);var s=u.sign(a,t,{algorithm:"HS256",noTimestamp:r});return s},e.isJWTSignature=function(t){var e=t.split(" ")[1]||t;return d.test(e)&&!!l(e)}},function(t,e){},function(t,e){"use strict"},function(t,e,i){!function(){function t(t){this.message=t}var i=e,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.prototype=new Error,t.prototype.name="InvalidCharacterError",i.btoa||(i.btoa=function(e){for(var i,o,r=String(e),a=0,s=n,l="";r.charAt(0|a)||(s="=",a%1);l+=s.charAt(63&i>>8-a%1*8)){if(o=r.charCodeAt(a+=.75),o>255)throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");i=i<<8|o}return l}),i.atob||(i.atob=function(e){var i=String(e).replace(/=+$/,"");if(i.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,r,a=0,s=0,l="";r=i.charAt(s++);~r&&(o=a%4?64*o+r:r,a++%4)?l+=String.fromCharCode(255&o>>(-2*a&6)):0)r=n.indexOf(r);return l})}()},function(t,e,i){"use strict";

var n=i(12);t.exports=n},function(t,e,i){"use strict";var n=i(13),o=0,r=1,a=2,s=function(t){return t},l=function(t){throw t},c=function(t){if(this._state=o,this._onFulfilled=[],this._onRejected=[],"function"==typeof t){var e=this;t(function(t){f(e,t)},function(t){g(e,t)})}};c.prototype.then=function(t,e){var i=new c;return u(this,t,i),d(this,e,i),i},c.prototype["catch"]=function(t){return this.then(null,t)};var u=function(t,e,i){"function"!=typeof e&&(e=s);var n=function(t){h(e,t,i)};t._state===o?t._onFulfilled.push(n):t._state===r&&n(t._value)},d=function(t,e,i){"function"!=typeof e&&(e=l);var n=function(t){h(e,t,i)};t._state===o?t._onRejected.push(n):t._state===a&&n(t._reason)},h=function(t,e,i){n(function(){p(t,e,i)})},p=function(t,e,i){var n;try{n=t(e)}catch(o){return g(i,o)}n===i?g(i,new TypeError("Recursive promise chain detected")):f(i,n)},f=function(t,e){var i,n,o=!1;try{if(i=typeof e,n=null!==e&&("function"===i||"object"===i)&&e.then,"function"!=typeof n)return m(t,e);n.call(e,function(e){o^(o=!0)&&f(t,e)},function(e){o^(o=!0)&&g(t,e)})}catch(r){if(!(o^(o=!0)))return;g(t,r)}},m=function(t,e){if(t._state===o){t._state=r,t._value=e,t._onRejected=[];for(var i,n=t._onFulfilled;i=n.shift();)i(e)}},g=function(t,e){if(t._state===o){t._state=a,t._reason=e,t._onFulfilled=[];for(var i,n=t._onRejected;i=n.shift();)i(e)}};c.resolve=c.accept=c.fulfill=function(t){return new c(function(e,i){e(t)})},c.reject=function(t){return new c(function(e,i){i(t)})},c.all=function(t){return new c(function(e,i){var n,o=[],r=t.length;if(0===r)return e(o);for(n=0;r>n;n++)(function(t,n){c.resolve(t).then(function(t){o[n]=t,0===--r&&e(o)},i)})(t[n],n)})},c.race=function(t){return new c(function(e,i){for(var n=0,o=t.length;o>n;n++)c.resolve(t[n]).then(e,i)})},c.deferred=c.pending=function(){var t={};return t.promise=new c(function(e,i){t.fulfill=t.resolve=e,t.reject=i}),t},t.exports=c},function(t,e,i){"use strict";function n(){if(l.length)throw l.shift()}function o(t){var e;e=s.length?s.pop():new r,e.task=t,a(e)}function r(){this.task=null}var a=i(14),s=[],l=[],c=a.makeRequestCallFromTimer(n);t.exports=o,r.prototype.call=function(){try{this.task.call()}catch(t){o.onerror?o.onerror(t):(l.push(t),c())}finally{this.task=null,s[s.length]=this}}},function(t,e){(function(e){"use strict";function i(t){s.length||(a(),l=!0),s[s.length]=t}function n(){for(;c<s.length;){var t=c;if(c+=1,s[t].call(),c>u){for(var e=0,i=s.length-c;i>e;e++)s[e]=s[e+c];s.length-=c,c=0}}s.length=0,c=0,l=!1}function o(t){var e=1,i=new d(t),n=document.createTextNode("");return i.observe(n,{characterData:!0}),function(){e=-e,n.data=e}}function r(t){return function(){function e(){clearTimeout(i),clearInterval(n),t()}var i=setTimeout(e,0),n=setInterval(e,50)}}t.exports=i;var a,s=[],l=!1,c=0,u=1024,d=e.MutationObserver||e.WebKitMutationObserver;a="function"==typeof d?o(n):r(n),i.requestFlush=a,i.makeRequestCallFromTimer=r}).call(e,function(){return this}())},function(t,e){},function(t,e,i){"use strict";var n=i(17),o=i(18),r={VERSION:n.VERSION,Client:i(20),Scheduler:i(45)};o.wrapper=r,t.exports=r},function(t,e){t.exports={VERSION:"1.2.0",BAYEUX_VERSION:"1.0",ID_LENGTH:160,JSONP_CALLBACK:"jsonpcallback",CONNECTION_TYPES:["long-polling","cross-origin-long-polling","callback-polling","websocket","eventsource","in-process"],MANDATORY_CONNECTION_TYPES:["long-polling","callback-polling","in-process"]}},function(t,e,i){"use strict";var n=i(19),o={LOG_LEVELS:{fatal:4,error:3,warn:2,info:1,debug:0},writeLog:function(t,e){var i=o.logger||(o.wrapper||o).logger;if(i){var r=Array.prototype.slice.apply(t),a="[Faye",s=this.className,l=r.shift().replace(/\?/g,function(){try{return n(r.shift())}catch(t){return"[Object]"}});s&&(a+="."+s),a+="] ","function"==typeof i[e]?i[e](a+l):"function"==typeof i&&i(a+l)}}};for(var r in o.LOG_LEVELS)(function(t){o[t]=function(){this.writeLog(arguments,t)}})(r);t.exports=o},function(t,e){"use strict";t.exports=function(t){return JSON.stringify(t,function(t,e){return this[t]instanceof Array?this[t]:e})}},function(t,e,i){(function(e){"use strict";var n=i(13),o=i(21),r=(i(12),i(23)),a=i(24),s=i(25),l=i(17),c=i(22),u=i(26),d=i(27),h=i(18),p=i(28),f=i(30),m=i(32),g=i(46),v=i(47),y=i(48),w=i(49),b=o({className:"Client",UNCONNECTED:1,CONNECTING:2,CONNECTED:3,DISCONNECTED:4,HANDSHAKE:"handshake",RETRY:"retry",NONE:"none",CONNECTION_TIMEOUT:60,DEFAULT_ENDPOINT:"/bayeux",INTERVAL:0,initialize:function(t,i){this.info("New client created for ?",t),i=i||{},u(i,["interval","timeout","endpoints","proxy","retry","scheduler","websocketExtensions","tls","ca"]),this._channels=new f.Set,this._dispatcher=m.create(this,t||this.DEFAULT_ENDPOINT,i),this._messageId=0,this._state=this.UNCONNECTED,this._responseCallbacks={},this._advice={reconnect:this.RETRY,interval:1e3*(i.interval||this.INTERVAL),timeout:1e3*(i.timeout||this.CONNECTION_TIMEOUT)},this._dispatcher.timeout=this._advice.timeout/1e3,this._dispatcher.bind("message",this._receiveMessage,this),s.Event&&void 0!==e.onbeforeunload&&s.Event.on(e,"beforeunload",function(){a.indexOf(this._dispatcher._disabled,"autodisconnect")<0&&this.disconnect()},this)},addWebsocketExtension:function(t){return this._dispatcher.addWebsocketExtension(t)},disable:function(t){return this._dispatcher.disable(t)},setHeader:function(t,e){return this._dispatcher.setHeader(t,e)},handshake:function(t,i){if(this._advice.reconnect!==this.NONE&&this._state===this.UNCONNECTED){this._state=this.CONNECTING;var o=this;this.info("Initiating handshake with ?",r.stringify(this._dispatcher.endpoint)),this._dispatcher.selectTransport(l.MANDATORY_CONNECTION_TYPES),this._sendMessage({channel:f.HANDSHAKE,version:l.BAYEUX_VERSION,supportedConnectionTypes:this._dispatcher.getConnectionTypes()},{},function(r){r.successful?(this._state=this.CONNECTED,this._dispatcher.clientId=r.clientId,this._dispatcher.selectTransport(r.supportedConnectionTypes),this.info("Handshake successful: ?",this._dispatcher.clientId),this.subscribe(this._channels.getKeys(),!0),t&&n(function(){t.call(i)})):(this.info("Handshake unsuccessful"),e.setTimeout(function(){o.handshake(t,i)},1e3*this._dispatcher.retry),this._state=this.UNCONNECTED)},this)}},connect:function(t,e){if(this._advice.reconnect!==this.NONE&&this._state!==this.DISCONNECTED){if(this._state===this.UNCONNECTED)return this.handshake(function(){this.connect(t,e)},this);this.callback(t,e),this._state===this.CONNECTED&&(this.info("Calling deferred actions for ?",this._dispatcher.clientId),this.setDeferredStatus("succeeded"),this.setDeferredStatus("unknown"),this._connectRequest||(this._connectRequest=!0,this.info("Initiating connection for ?",this._dispatcher.clientId),this._sendMessage({channel:f.CONNECT,clientId:this._dispatcher.clientId,connectionType:this._dispatcher.connectionType},{},this._cycleConnection,this)))}},disconnect:function(){if(this._state===this.CONNECTED){this._state=this.DISCONNECTED,this.info("Disconnecting ?",this._dispatcher.clientId);var t=new y;return this._sendMessage({channel:f.DISCONNECT,clientId:this._dispatcher.clientId},{},function(e){e.successful?(this._dispatcher.close(),t.setDeferredStatus("succeeded")):t.setDeferredStatus("failed",g.parse(e.error))},this),this.info("Clearing channel listeners for ?",this._dispatcher.clientId),this._channels=new f.Set,t}},subscribe:function(t,e,i){if(t instanceof Array)return a.map(t,function(t){return this.subscribe(t,e,i)},this);var n=new w(this,t,e,i),o=e===!0,r=this._channels.hasSubscription(t);return r&&!o?(this._channels.subscribe([t],n),n.setDeferredStatus("succeeded"),n):(this.connect(function(){this.info("Client ? attempting to subscribe to ?",this._dispatcher.clientId,t),o||this._channels.subscribe([t],n),this._sendMessage({channel:f.SUBSCRIBE,clientId:this._dispatcher.clientId,subscription:t},{},function(e){if(!e.successful)return n.setDeferredStatus("failed",g.parse(e.error)),this._channels.unsubscribe(t,n);var i=[].concat(e.subscription);this.info("Subscription acknowledged for ? to ?",this._dispatcher.clientId,i),n.setDeferredStatus("succeeded")},this)},this),n)},unsubscribe:function(t,e){if(t instanceof Array)return a.map(t,function(t){return this.unsubscribe(t,e)},this);var i=this._channels.unsubscribe(t,e);i&&this.connect(function(){this.info("Client ? attempting to unsubscribe from ?",this._dispatcher.clientId,t),this._sendMessage({channel:f.UNSUBSCRIBE,clientId:this._dispatcher.clientId,subscription:t},{},function(t){if(t.successful){var e=[].concat(t.subscription);this.info("Unsubscription acknowledged for ? from ?",this._dispatcher.clientId,e)}},this)},this)},publish:function(t,e,i){u(i||{},["attempts","deadline"]);var n=new y;return this.connect(function(){this.info("Client ? queueing published message to ?: ?",this._dispatcher.clientId,t,e),this._sendMessage({channel:t,data:e,clientId:this._dispatcher.clientId},i,function(t){t.successful?n.setDeferredStatus("succeeded"):n.setDeferredStatus("failed",g.parse(t.error))},this)},this),n},_sendMessage:function(t,e,i,n){t.id=this._generateMessageId();var o=this._advice.timeout?1.2*this._advice.timeout/1e3:1.2*this._dispatcher.retry;this.pipeThroughExtensions("outgoing",t,null,function(t){t&&(i&&(this._responseCallbacks[t.id]=[i,n]),this._dispatcher.sendMessage(t,o,e||{}))},this)},_generateMessageId:function(){return this._messageId+=1,this._messageId>=Math.pow(2,32)&&(this._messageId=0),this._messageId.toString(36)},_receiveMessage:function(t){var e,i=t.id;void 0!==t.successful&&(e=this._responseCallbacks[i],delete this._responseCallbacks[i]),this.pipeThroughExtensions("incoming",t,null,function(t){t&&(t.advice&&this._handleAdvice(t.advice),this._deliverMessage(t),e&&e[0].call(e[1],t))},this)},_handleAdvice:function(t){c(this._advice,t),this._dispatcher.timeout=this._advice.timeout/1e3,this._advice.reconnect===this.HANDSHAKE&&this._state!==this.DISCONNECTED&&(this._state=this.UNCONNECTED,this._dispatcher.clientId=null,this._cycleConnection())},_deliverMessage:function(t){t.channel&&void 0!==t.data&&(this.info("Client ? calling listeners for ? with ?",this._dispatcher.clientId,t.channel,t.data),this._channels.distributeMessage(t))},_cycleConnection:function(){this._connectRequest&&(this._connectRequest=null,this.info("Closed connection for ?",this._dispatcher.clientId));var t=this;e.setTimeout(function(){t.connect()},this._advice.interval)}});c(b.prototype,d),c(b.prototype,p),c(b.prototype,h),c(b.prototype,v),t.exports=b}).call(e,function(){return this}())},function(t,e,i){"use strict";var n=i(22);t.exports=function(t,e){"function"!=typeof t&&(e=t,t=Object);var i=function(){return this.initialize?this.initialize.apply(this,arguments)||this:this},o=function(){};return o.prototype=t.prototype,i.prototype=new o,n(i.prototype,e),i}},function(t,e){"use strict";t.exports=function(t,e,i){if(!e)return t;for(var n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)&&i===!1||t[n]!==e[n]&&(t[n]=e[n]));return t}},function(t,e){"use strict";t.exports={isURI:function(t){return t&&t.protocol&&t.host&&t.path},isSameOrigin:function(t){return t.protocol===location.protocol&&t.hostname===location.hostname&&t.port===location.port},parse:function(t){if("string"!=typeof t)return t;var e,i,n,o,r,a,s={},l=function(e,i){t=t.replace(i,function(t){return s[e]=t,""}),s[e]=s[e]||""};for(l("protocol",/^[a-z]+\:/i),l("host",/^\/\/[^\/\?#]+/),/^\//.test(t)||s.host||(t=location.pathname.replace(/[^\/]*$/,"")+t),l("pathname",/^[^\?#]*/),l("search",/^\?[^#]*/),l("hash",/^#.*/),s.protocol=s.protocol||location.protocol,s.host?(s.host=s.host.substr(2),e=s.host.split(":"),s.hostname=e[0],s.port=e[1]||""):(s.host=location.host,s.hostname=location.hostname,s.port=location.port),s.pathname=s.pathname||"/",s.path=s.pathname+s.search,i=s.search.replace(/^\?/,""),n=i?i.split("&"):[],a={},o=0,r=n.length;r>o;o++)e=n[o].split("="),a[decodeURIComponent(e[0]||"")]=decodeURIComponent(e[1]||"");return s.query=a,s.href=this.stringify(s),s},stringify:function(t){var e=t.protocol+"//"+t.hostname;return t.port&&(e+=":"+t.port),e+=t.pathname+this.queryString(t.query)+(t.hash||"")},queryString:function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return 0===e.length?"":"?"+e.join("&")}}},function(t,e){"use strict";t.exports={commonElement:function(t,e){for(var i=0,n=t.length;n>i;i++)if(-1!==this.indexOf(e,t[i]))return t[i];return null},indexOf:function(t,e){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1},map:function(t,e,i){if(t.map)return t.map(e,i);var n=[];if(t instanceof Array)for(var o=0,r=t.length;r>o;o++)n.push(e.call(i||null,t[o],o));else for(var a in t)t.hasOwnProperty(a)&&n.push(e.call(i||null,a,t[a]));return n},filter:function(t,e,i){if(t.filter)return t.filter(e,i);for(var n=[],o=0,r=t.length;r>o;o++)e.call(i||null,t[o],o)&&n.push(t[o]);return n},asyncEach:function(t,e,i,n){var o=t.length,r=-1,a=0,s=!1,l=function(){return a-=1,r+=1,r===o?i&&i.call(n):void e(t[r],u)},c=function(){if(!s){for(s=!0;a>0;)l();s=!1}},u=function(){a+=1,c()};u()}}},function(t,e){(function(e){"use strict";var i={_registry:[],on:function(t,e,i,n){var o=function(){i.call(n)};t.addEventListener?t.addEventListener(e,o,!1):t.attachEvent("on"+e,o),this._registry.push({_element:t,_type:e,_callback:i,_context:n,_handler:o})},detach:function(t,e,i,n){for(var o,r=this._registry.length;r--;)o=this._registry[r],t&&t!==o._element||e&&e!==o._type||i&&i!==o._callback||n&&n!==o._context||(o._element.removeEventListener?o._element.removeEventListener(o._type,o._handler,!1):o._element.detachEvent("on"+o._type,o._handler),this._registry.splice(r,1),o=null)}};void 0!==e.onunload&&i.on(e,"unload",i.detach,i),t.exports={Event:i}}).call(e,function(){return this}())},function(t,e,i){"use strict";var n=i(24);t.exports=function(t,e){for(var i in t)if(n.indexOf(e,i)<0)throw new Error("Unrecognized option: "+i)}},function(t,e,i){(function(e){"use strict";var n=i(12);t.exports={then:function(t,e){var i=this;return this._promise||(this._promise=new n(function(t,e){i._resolve=t,i._reject=e})),0===arguments.length?this._promise:this._promise.then(t,e)},callback:function(t,e){return this.then(function(i){t.call(e,i)})},errback:function(t,e){return this.then(null,function(i){t.call(e,i)})},timeout:function(t,i){this.then();var n=this;this._timer=e.setTimeout(function(){n._reject(i)},1e3*t)},setDeferredStatus:function(t,i){this._timer&&e.clearTimeout(this._timer),this.then(),"succeeded"===t?this._resolve(i):"failed"===t?this._reject(i):delete this._promise}}}).call(e,function(){return this}())},function(t,e,i){"use strict";var n=i(22),o=i(29),r={countListeners:function(t){return this.listeners(t).length},bind:function(t,e,i){var n=Array.prototype.slice,o=function(){e.apply(i,n.call(arguments))};return this._listeners=this._listeners||[],this._listeners.push([t,e,i,o]),this.on(t,o)},unbind:function(t,e,i){this._listeners=this._listeners||[];for(var n,o=this._listeners.length;o--;)n=this._listeners[o],n[0]===t&&(!e||n[1]===e&&n[2]===i)&&(this._listeners.splice(o,1),this.removeListener(t,n[3]))}};n(r,o.prototype),r.trigger=r.emit,t.exports=r},function(t,e){function i(t,e){if(t.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(e===t[i])return i;return-1}function n(){}var o="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};t.exports=n,n.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||o(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:var i=Array.prototype.slice.call(arguments,1);e.apply(this,i)}return!0}if(o(e)){for(var i=Array.prototype.slice.call(arguments,1),n=e.slice(),r=0,a=n.length;a>r;r++)n[r].apply(this,i);return!0}return!1},n.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");return this._events||(this._events={}),this.emit("newListener",t,e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){var i=this;return i.on(t,function n(){i.removeListener(t,n),e.apply(this,arguments)}),this},n.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var n=this._events[t];if(o(n)){var r=i(n,e);if(0>r)return this;n.splice(r,1),0==n.length&&delete this._events[t]}else this._events[t]===e&&delete this._events[t];return this},n.prototype.removeAllListeners=function(t){return 0===arguments.length?(this._events={},this):(t&&this._events&&this._events[t]&&(this._events[t]=null),this)},n.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),o(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]}},function(t,e,i){"use strict";var n=i(21),o=i(22),r=i(28),a=i(31),s=n({initialize:function(t){this.id=this.name=t},push:function(t){this.trigger("message",t)},isUnused:function(){return 0===this.countListeners("message")}});o(s.prototype,r),o(s,{HANDSHAKE:"/meta/handshake",CONNECT:"/meta/connect",SUBSCRIBE:"/meta/subscribe",UNSUBSCRIBE:"/meta/unsubscribe",DISCONNECT:"/meta/disconnect",META:"meta",SERVICE:"service",expand:function(t){var e=this.parse(t),i=["/**",t],n=e.slice();n[n.length-1]="*",i.push(this.unparse(n));for(var o=1,r=e.length;r>o;o++)n=e.slice(0,o),n.push("**"),i.push(this.unparse(n));return i},isValid:function(t){return a.CHANNEL_NAME.test(t)||a.CHANNEL_PATTERN.test(t)},parse:function(t){return this.isValid(t)?t.split("/").slice(1):null},unparse:function(t){return"/"+t.join("/")},isMeta:function(t){var e=this.parse(t);return e?e[0]===this.META:null},isService:function(t){var e=this.parse(t);return e?e[0]===this.SERVICE:null},isSubscribable:function(t){return this.isValid(t)?!this.isMeta(t)&&!this.isService(t):null},Set:n({initialize:function(){this._channels={}},getKeys:function(){var t=[];for(var e in this._channels)t.push(e);return t},remove:function(t){delete this._channels[t]},hasSubscription:function(t){return this._channels.hasOwnProperty(t)},subscribe:function(t,e){for(var i,n=0,o=t.length;o>n;n++){i=t[n];var r=this._channels[i]=this._channels[i]||new s(i);r.bind("message",e)}},unsubscribe:function(t,e){var i=this._channels[t];return i?(i.unbind("message",e),i.isUnused()?(this.remove(t),!0):!1):!1},distributeMessage:function(t){for(var e=s.expand(t.channel),i=0,n=e.length;n>i;i++){var o=this._channels[e[i]];o&&o.trigger("message",t)}}})}),t.exports=s},function(t,e){"use strict";t.exports={CHANNEL_NAME:/^\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*$/,CHANNEL_PATTERN:/^(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*\/\*{1,2}$/,ERROR:/^([0-9][0-9][0-9]:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*(,(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)*:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*|[0-9][0-9][0-9]::(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)$/,VERSION:/^([0-9])+(\.(([a-z]|[A-Z])|[0-9])(((([a-z]|[A-Z])|[0-9])|\-|\_))*)*$/}},function(t,e,i){(function(e){"use strict";var n=i(21),o=i(23),r=i(33),a=i(22),s=i(18),l=i(28),c=i(34),u=i(45),d=n({className:"Dispatcher",MAX_REQUEST_SIZE:2048,DEFAULT_RETRY:5,UP:1,DOWN:2,initialize:function(t,e,i){this._client=t,this.endpoint=o.parse(e),this._alternates=i.endpoints||{},this.cookies=r.CookieJar&&new r.CookieJar,this._disabled=[],this._envelopes={},this.headers={},this.retry=i.retry||this.DEFAULT_RETRY,this._scheduler=i.scheduler||u,this._state=0,this.transports={},this.wsExtensions=[],this.proxy=i.proxy||{},"string"==typeof this._proxy&&(this._proxy={origin:this._proxy});var n=i.websocketExtensions;if(n){n=[].concat(n);for(var a=0,s=n.length;s>a;a++)this.addWebsocketExtension(n[a])}this.tls=i.tls||{},this.tls.ca=this.tls.ca||i.ca;for(var l in this._alternates)this._alternates[l]=o.parse(this._alternates[l]);this.maxRequestSize=this.MAX_REQUEST_SIZE},endpointFor:function(t){return this._alternates[t]||this.endpoint},addWebsocketExtension:function(t){this.wsExtensions.push(t)},disable:function(t){this._disabled.push(t)},setHeader:function(t,e){this.headers[t]=e},close:function(){var t=this._transport;delete this._transport,t&&t.close()},getConnectionTypes:function(){return c.getConnectionTypes()},selectTransport:function(t){c.get(this,t,this._disabled,function(t){this.debug("Selected ? transport for ?",t.connectionType,o.stringify(t.endpoint)),t!==this._transport&&(this._transport&&this._transport.close(),this._transport=t,this.connectionType=t.connectionType)},this)},sendMessage:function(t,e,i){i=i||{};var n,o=t.id,r=i.attempts,a=i.deadline&&(new Date).getTime()+1e3*i.deadline,s=this._envelopes[o];s||(n=new this._scheduler(t,{timeout:e,interval:this.retry,attempts:r,deadline:a}),s=this._envelopes[o]={message:t,scheduler:n}),this._sendEnvelope(s)},_sendEnvelope:function(t){if(this._transport&&!t.request&&!t.timer){var i=t.message,n=t.scheduler,o=this;if(!n.isDeliverable())return n.abort(),void delete this._envelopes[i.id];t.timer=e.setTimeout(function(){o.handleError(i)},1e3*n.getTimeout()),n.send(),t.request=this._transport.sendMessage(i)}},handleResponse:function(t){var i=this._envelopes[t.id];void 0!==t.successful&&i&&(i.scheduler.succeed(),delete this._envelopes[t.id],e.clearTimeout(i.timer)),this.trigger("message",t),this._state!==this.UP&&(this._state=this.UP,this._client.trigger("transport:up"))},handleError:function(t,i){var n=this._envelopes[t.id],o=n&&n.request,r=this;if(o){o.then(function(t){t&&t.abort&&t.abort()});var a=n.scheduler;a.fail(),e.clearTimeout(n.timer),n.request=n.timer=null,i?this._sendEnvelope(n):n.timer=e.setTimeout(function(){n.timer=null,r._sendEnvelope(n)},1e3*a.getInterval()),this._state!==this.DOWN&&(this._state=this.DOWN,this._client.trigger("transport:down"))}}});d.create=function(t,e,i){return new d(t,e,i)},a(d.prototype,l),a(d.prototype,s),t.exports=d}).call(e,function(){return this}())},function(t,e){"use strict";t.exports={}},function(t,e,i){"use strict";var n=i(35);n.register("websocket",i(37)),n.register("eventsource",i(41)),n.register("long-polling",i(42)),n.register("cross-origin-long-polling",i(43)),n.register("callback-polling",i(44)),t.exports=n},function(t,e,i){(function(e){"use strict";var n=i(21),o=i(33).Cookie,r=i(12),a=i(23),s=i(24),l=i(22),c=i(18),u=i(36),d=i(30),h=l(n({className:"Transport",DEFAULT_PORTS:{"http:":80,"https:":443,"ws:":80,"wss:":443},SECURE_PROTOCOLS:["https:","wss:"],MAX_DELAY:0,batching:!0,initialize:function(t,i){this._dispatcher=t,this.endpoint=i,this._outbox=[],this._proxy=l({},this._dispatcher.proxy),this._proxy.origin||"undefined"==typeof e||(this._proxy.origin=s.indexOf(this.SECURE_PROTOCOLS,this.endpoint.protocol)>=0?e.env.HTTPS_PROXY||e.env.https_proxy:e.env.HTTP_PROXY||e.env.http_proxy)},close:function(){},encode:function(t){return""},sendMessage:function(t){return this.debug("Client ? sending message to ?: ?",this._dispatcher.clientId,a.stringify(this.endpoint),t),this.batching?(this._outbox.push(t),this._flushLargeBatch(),t.channel===d.HANDSHAKE?this._publish(.01):(t.channel===d.CONNECT&&(this._connectMessage=t),this._publish(this.MAX_DELAY))):r.resolve(this.request([t]))},_makePromise:function(){var t=this;this._requestPromise=this._requestPromise||new r(function(e){t._resolvePromise=e})},_publish:function(t){return this._makePromise(),this.addTimeout("publish",t,function(){this._flush(),delete this._requestPromise},this),this._requestPromise},_flush:function(){this.removeTimeout("publish"),this._outbox.length>1&&this._connectMessage&&(this._connectMessage.advice={timeout:0}),this._resolvePromise(this.request(this._outbox)),this._connectMessage=null,this._outbox=[]},_flushLargeBatch:function(){var t=this.encode(this._outbox);if(!(t.length<this._dispatcher.maxRequestSize)){var e=this._outbox.pop();this._makePromise(),this._flush(),e&&this._outbox.push(e)}},_receive:function(t){if(t){t=[].concat(t),this.debug("Client ? received from ? via ?: ?",this._dispatcher.clientId,a.stringify(this.endpoint),this.connectionType,t);for(var e=0,i=t.length;i>e;e++)this._dispatcher.handleResponse(t[e])}},_handleError:function(t,e){t=[].concat(t),this.debug("Client ? failed to send to ? via ?: ?",this._dispatcher.clientId,a.stringify(this.endpoint),this.connectionType,t);for(var i=0,n=t.length;n>i;i++)this._dispatcher.handleError(t[i])},_getCookies:function(){var t=this._dispatcher.cookies,e=a.stringify(this.endpoint);return t?s.map(t.getCookiesSync(e),function(t){return t.cookieString()}).join("; "):""},_storeCookies:function(t){var e,i=this._dispatcher.cookies,n=a.stringify(this.endpoint);if(t&&i){t=[].concat(t);for(var r=0,s=t.length;s>r;r++)e=o.parse(t[r]),i.setCookieSync(e,n)}}}),{get:function(t,e,i,n,o){var r=t.endpoint;s.asyncEach(this._transports,function(r,a){var l=r[0],c=r[1],u=t.endpointFor(l);return s.indexOf(i,l)>=0?a():s.indexOf(e,l)<0?(c.isUsable(t,u,function(){}),a()):void c.isUsable(t,u,function(e){if(!e)return a();var i=c.hasOwnProperty("create")?c.create(t,u):new c(t,u);n.call(o,i)})},function(){throw new Error("Could not find a usable connection type for "+a.stringify(r))})},register:function(t,e){this._transports.push([t,e]),e.prototype.connectionType=t},getConnectionTypes:function(){return s.map(this._transports,function(t){return t[0]})},_transports:[]});l(h.prototype,c),l(h.prototype,u),t.exports=h}).call(e,i(1))},function(t,e){(function(e){"use strict";t.exports={addTimeout:function(t,i,n,o){if(this._timeouts=this._timeouts||{},!this._timeouts.hasOwnProperty(t)){var r=this;this._timeouts[t]=e.setTimeout(function(){delete r._timeouts[t],n.call(o)},1e3*i)}},removeTimeout:function(t){this._timeouts=this._timeouts||{};var i=this._timeouts[t];i&&(e.clearTimeout(i),delete this._timeouts[t])},removeAllTimeouts:function(){this._timeouts=this._timeouts||{};for(var t in this._timeouts)this.removeTimeout(t)}}}).call(e,function(){return this}())},function(t,e,i){(function(e){"use strict";var n=i(21),o=i(12),r=i(38),a=i(23),s=i(25),l=i(39),c=i(22),u=i(19),d=i(40),h=i(27),p=i(35),f=c(n(p,{UNCONNECTED:1,CONNECTING:2,CONNECTED:3,batching:!1,isUsable:function(t,e){this.callback(function(){t.call(e,!0)}),this.errback(function(){t.call(e,!1)}),this.connect()},request:function(t){this._pending=this._pending||new r;for(var e=0,i=t.length;i>e;e++)this._pending.add(t[e]);var n=this,a=new o(function(e,i){n.callback(function(i){i&&1===i.readyState&&(i.send(u(t)),e(i))}),n.connect()});return{abort:function(){a.then(function(t){t.close()})}}},connect:function(){if(!f._unloaded&&(this._state=this._state||this.UNCONNECTED,this._state===this.UNCONNECTED)){this._state=this.CONNECTING;var t=this._createSocket();if(!t)return this.setDeferredStatus("failed");var e=this;t.onopen=function(){t.headers&&e._storeCookies(t.headers["set-cookie"]),e._socket=t,e._state=e.CONNECTED,e._everConnected=!0,e._ping(),e.setDeferredStatus("succeeded",t)};var i=!1;t.onclose=t.onerror=function(){if(!i){i=!0;var n=e._state===e.CONNECTED;t.onopen=t.onclose=t.onerror=t.onmessage=null,delete e._socket,e._state=e.UNCONNECTED,e.removeTimeout("ping");var o=e._pending?e._pending.toArray():[];delete e._pending,n||e._everConnected?(e.setDeferredStatus("unknown"),e._handleError(o,n)):e.setDeferredStatus("failed")}},t.onmessage=function(t){var i;try{i=JSON.parse(t.data)}catch(n){}if(i){i=[].concat(i);for(var o=0,r=i.length;r>o;o++)void 0!==i[o].successful&&e._pending.remove(i[o]);e._receive(i)}}}},close:function(){this._socket&&this._socket.close()},_createSocket:function(){var t=f.getSocketUrl(this.endpoint),e=this._dispatcher.headers,i=this._dispatcher.wsExtensions,n=this._getCookies(),o=this._dispatcher.tls,r={extensions:i,headers:e,proxy:this._proxy,tls:o};return""!==n&&(r.headers.Cookie=n),d.create(t,[],r)},_ping:function(){this._socket&&1===this._socket.readyState&&(this._socket.send("[]"),this.addTimeout("ping",this._dispatcher.timeout/2,this._ping,this))}}),{PROTOCOLS:{"http:":"ws:","https:":"wss:"},create:function(t,e){var i=t.transports.websocket=t.transports.websocket||{};return i[e.href]=i[e.href]||new this(t,e),i[e.href]},getSocketUrl:function(t){return t=l(t),t.protocol=this.PROTOCOLS[t.protocol],a.stringify(t)},isUsable:function(t,e,i,n){this.create(t,e).isUsable(i,n)}});c(f.prototype,h),s.Event&&void 0!==e.onbeforeunload&&s.Event.on(e,"beforeunload",function(){f._unloaded=!0}),t.exports=f}).call(e,function(){return this}())},function(t,e,i){"use strict";var n=i(21);t.exports=n({initialize:function(){this._index={}},add:function(t){var e=void 0!==t.id?t.id:t;return this._index.hasOwnProperty(e)?!1:(this._index[e]=t,!0)},forEach:function(t,e){for(var i in this._index)this._index.hasOwnProperty(i)&&t.call(e,this._index[i])},isEmpty:function(){for(var t in this._index)if(this._index.hasOwnProperty(t))return!1;return!0},member:function(t){for(var e in this._index)if(this._index[e]===t)return!0;return!1},remove:function(t){var e=void 0!==t.id?t.id:t,i=this._index[e];return delete this._index[e],i},toArray:function(){var t=[];return this.forEach(function(e){t.push(e)}),t}})},function(t,e){"use strict";var i=function(t){var e,n,o;if(t instanceof Array){for(e=[],n=t.length;n--;)e[n]=i(t[n]);return e}if("object"==typeof t){e=null===t?null:{};for(o in t)e[o]=i(t[o]);return e}return t};t.exports=i},function(t,e){(function(e){"use strict";var i=e.MozWebSocket||e.WebSocket;t.exports={create:function(t,e,n){return new i(t)}}}).call(e,function(){return this}())},function(t,e,i){(function(e){"use strict";var n=i(21),o=i(23),r=i(39),a=i(22),s=i(27),l=i(35),c=i(42),u=a(n(l,{initialize:function(t,i){if(l.prototype.initialize.call(this,t,i),!e.EventSource)return this.setDeferredStatus("failed");this._xhr=new c(t,i),i=r(i),i.pathname+="/"+t.clientId;var n=new e.EventSource(o.stringify(i)),a=this;n.onopen=function(){a._everConnected=!0,a.setDeferredStatus("succeeded")},n.onerror=function(){a._everConnected?a._handleError([]):(a.setDeferredStatus("failed"),n.close())},n.onmessage=function(t){var e;try{e=JSON.parse(t.data)}catch(i){}e?a._receive(e):a._handleError([])},this._socket=n},close:function(){this._socket&&(this._socket.onopen=this._socket.onerror=this._socket.onmessage=null,this._socket.close(),delete this._socket)},isUsable:function(t,e){this.callback(function(){t.call(e,!0)}),this.errback(function(){t.call(e,!1)})},encode:function(t){return this._xhr.encode(t)},request:function(t){return this._xhr.request(t)}}),{isUsable:function(t,e,i,n){var o=t.clientId;return o?void c.isUsable(t,e,function(o){return o?void this.create(t,e).isUsable(i,n):i.call(n,!1)},this):i.call(n,!1)},create:function(t,e){var i=t.transports.eventsource=t.transports.eventsource||{},n=t.clientId,a=r(e);return a.pathname+="/"+(n||""),a=o.stringify(a),i[a]=i[a]||new this(t,e),i[a]}});a(u.prototype,s),t.exports=u}).call(e,function(){return this}())},function(t,e,i){(function(e){"use strict";var n=i(21),o=i(23),r=i(25),a=i(22),s=i(19),l=i(35),c=a(n(l,{encode:function(t){return s(t)},request:function(t){var i,n=this.endpoint.href,o=this;if(e.XMLHttpRequest)i=new XMLHttpRequest;else{if(!e.ActiveXObject)return this._handleError(t);i=new ActiveXObject("Microsoft.XMLHTTP")}i.open("POST",n,!0),i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Pragma","no-cache"),i.setRequestHeader("X-Requested-With","XMLHttpRequest");var a=this._dispatcher.headers;for(var s in a)a.hasOwnProperty(s)&&i.setRequestHeader(s,a[s]);var l=function(){i.abort()};return void 0!==e.onbeforeunload&&r.Event.on(e,"beforeunload",l),
i.onreadystatechange=function(){if(i&&4===i.readyState){var n=null,a=i.status,s=i.responseText,c=a>=200&&300>a||304===a||1223===a;if(void 0!==e.onbeforeunload&&r.Event.detach(e,"beforeunload",l),i.onreadystatechange=function(){},i=null,!c)return o._handleError(t);try{n=JSON.parse(s)}catch(u){}n?o._receive(n):o._handleError(t)}},i.send(this.encode(t)),i}}),{isUsable:function(t,e,i,n){var r="ReactNative"===navigator.product||o.isSameOrigin(e);i.call(n,r)}});t.exports=c}).call(e,function(){return this}())},function(t,e,i){(function(e){"use strict";var n=i(21),o=i(38),r=i(23),a=i(22),s=i(19),l=i(35),c=a(n(l,{encode:function(t){return"message="+encodeURIComponent(s(t))},request:function(t){var i,n=e.XDomainRequest?XDomainRequest:XMLHttpRequest,o=new n,a=++c._id,s=this._dispatcher.headers,l=this;if(o.open("POST",r.stringify(this.endpoint),!0),o.setRequestHeader){o.setRequestHeader("Pragma","no-cache");for(i in s)s.hasOwnProperty(i)&&o.setRequestHeader(i,s[i])}var u=function(){return o?(c._pending.remove(a),o.onload=o.onerror=o.ontimeout=o.onprogress=null,void(o=null)):!1};return o.onload=function(){var e;try{e=JSON.parse(o.responseText)}catch(i){}u(),e?l._receive(e):l._handleError(t)},o.onerror=o.ontimeout=function(){u(),l._handleError(t)},o.onprogress=function(){},n===e.XDomainRequest&&c._pending.add({id:a,xhr:o}),o.send(this.encode(t)),o}}),{_id:0,_pending:new o,isUsable:function(t,i,n,o){if(r.isSameOrigin(i))return n.call(o,!1);if(e.XDomainRequest)return n.call(o,i.protocol===location.protocol);if(e.XMLHttpRequest){var a=new XMLHttpRequest;return n.call(o,void 0!==a.withCredentials)}return n.call(o,!1)}});t.exports=c}).call(e,function(){return this}())},function(t,e,i){(function(e){"use strict";var n=i(21),o=i(23),r=i(39),a=i(22),s=i(19),l=i(35),c=a(n(l,{encode:function(t){var e=r(this.endpoint);return e.query.message=s(t),e.query.jsonp="__jsonp"+c._cbCount+"__",o.stringify(e)},request:function(t){var i=document.getElementsByTagName("head")[0],n=document.createElement("script"),a=c.getCallbackName(),l=r(this.endpoint),u=this;l.query.message=s(t),l.query.jsonp=a;var d=function(){if(!e[a])return!1;e[a]=void 0;try{delete e[a]}catch(t){}n.parentNode.removeChild(n)};return e[a]=function(t){d(),u._receive(t)},n.type="text/javascript",n.src=o.stringify(l),i.appendChild(n),n.onerror=function(){d(),u._handleError(t)},{abort:d}}}),{_cbCount:0,getCallbackName:function(){return this._cbCount+=1,"__jsonp"+this._cbCount+"__"},isUsable:function(t,e,i,n){i.call(n,!0)}});t.exports=c}).call(e,function(){return this}())},function(t,e,i){"use strict";var n=i(22),o=function(t,e){this.message=t,this.options=e,this.attempts=0};n(o.prototype,{getTimeout:function(){return this.options.timeout},getInterval:function(){return this.options.interval},isDeliverable:function(){var t=this.options.attempts,e=this.attempts,i=this.options.deadline,n=(new Date).getTime();return void 0!==t&&e>=t?!1:void 0!==i&&n>i?!1:!0},send:function(){this.attempts+=1},succeed:function(){},fail:function(){},abort:function(){}}),t.exports=o},function(t,e,i){"use strict";var n=i(21),o=i(31),r=n({initialize:function(t,e,i){this.code=t,this.params=Array.prototype.slice.call(e),this.message=i},toString:function(){return this.code+":"+this.params.join(",")+":"+this.message}});r.parse=function(t){if(t=t||"",!o.ERROR.test(t))return new r(null,[],t);var e=t.split(":"),i=parseInt(e[0]),n=e[1].split(","),t=e[2];return new r(i,n,t)};var a={versionMismatch:[300,"Version mismatch"],conntypeMismatch:[301,"Connection types not supported"],extMismatch:[302,"Extension mismatch"],badRequest:[400,"Bad request"],clientUnknown:[401,"Unknown client"],parameterMissing:[402,"Missing required parameter"],channelForbidden:[403,"Forbidden channel"],channelUnknown:[404,"Unknown channel"],channelInvalid:[405,"Invalid channel"],extUnknown:[406,"Unknown extension"],publishFailed:[407,"Failed to publish"],serverError:[500,"Internal server error"]};for(var s in a)(function(t){r[t]=function(){return new r(a[t][0],arguments,a[t][1]).toString()}})(s);t.exports=r},function(t,e,i){"use strict";var n=i(22),o=i(18),r={addExtension:function(t){this._extensions=this._extensions||[],this._extensions.push(t),t.added&&t.added(this)},removeExtension:function(t){if(this._extensions)for(var e=this._extensions.length;e--;)this._extensions[e]===t&&(this._extensions.splice(e,1),t.removed&&t.removed(this))},pipeThroughExtensions:function(t,e,i,n,o){if(this.debug("Passing through ? extensions: ?",t,e),!this._extensions)return n.call(o,e);var r=this._extensions.slice(),a=function(e){if(!e)return n.call(o,e);var s=r.shift();if(!s)return n.call(o,e);var l=s[t];return l?void(l.length>=3?s[t](e,i,a):s[t](e,a)):a(e)};a(e)}};n(r,o),t.exports=r},function(t,e,i){"use strict";var n=i(21),o=i(27);t.exports=n(o)},function(t,e,i){"use strict";var n=i(21),o=i(22),r=i(27),a=n({initialize:function(t,e,i,n){this._client=t,this._channels=e,this._callback=i,this._context=n,this._cancelled=!1},withChannel:function(t,e){return this._withChannel=[t,e],this},apply:function(t,e){var i=e[0];this._callback&&this._callback.call(this._context,i.data),this._withChannel&&this._withChannel[0].call(this._withChannel[1],i.channel,i.data)},cancel:function(){this._cancelled||(this._client.unsubscribe(this._channels,this),this._cancelled=!0)},unsubscribe:function(){this.cancel()}});o(a.prototype,r),t.exports=a}])}),function(t){var e=window.Chicago||{utils:{now:Date.now||function(){return(new Date).getTime()},uid:function(t){return(t||"id")+e.utils.now()+"RAND"+Math.ceil(1e5*Math.random())},is:{number:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},fn:function(t){return"function"==typeof t},object:function(t){return"[object Object]"===Object.prototype.toString.call(t)}},debounce:function(t,e,i){var n;return function(){var o=this,r=arguments,a=function(){n=null,i||t.apply(o,r)},s=i&&!n;n&&clearTimeout(n),n=setTimeout(a,e),s&&t.apply(o,r)}}},$:window.jQuery||null};if("function"==typeof define&&define.amd&&define("chicago",function(){return e.load=function(t,i,n,o){var r=t.split(","),a=[],s=(o.config&&o.config.chicago&&o.config.chicago.base?o.config.chicago.base:"").replace(/\/+$/g,"");if(!s)throw new Error("Please define base path to jQuery resizestart in the requirejs config.");for(var l=0;l<r.length;){var c=r[l].replace(/\./g,"/");a.push(s+"/"+c),l+=1}i(a,function(){n(e)})},e}),window&&window.jQuery)return t(e,window,window.document);if(!window.jQuery)throw new Error("jQuery resizestart requires jQuery")}(function(t,e,i){t.$win=t.$(e),t.$doc=t.$(i),t.events||(t.events={}),t.events.resizeend||(t.events.resizeend={defaults:{delay:250},setup:function(){var e,i=arguments,n={delay:t.$.event.special.resizeend.defaults.delay};t.utils.is.fn(i[0])?e=i[0]:t.utils.is.number(i[0])?n.delay=i[0]:t.utils.is.object(i[0])&&(n=t.$.extend({},n,i[0]));var o=t.utils.uid("resizeend"),r=t.$.extend({delay:t.$.event.special.resizeend.defaults.delay},n),a=r,s=function(e){a&&clearTimeout(a),a=setTimeout(function(){return a=null,e.type="resizeend.chicago.dom",t.$(e.target).trigger("resizeend",e)},r.delay)};return t.$(this).data("chicago.event.resizeend.uid",o),t.$(this).on("resize",t.utils.debounce(s,100)).data(o,s)},teardown:function(){var e=t.$(this).data("chicago.event.resizeend.uid");return t.$(this).off("resize",t.$(this).data(e)),t.$(this).removeData(e),t.$(this).removeData("chicago.event.resizeend.uid")}}),t.events.resizestart={defaults:{delay:0},setup:function(){var e,i=arguments,n={delay:t.$.event.special.resizestart.defaults.delay};t.utils.is.fn(i[0])?e=i[0]:t.utils.is.number(i[0])?n.delay=i[0]:t.utils.is.object(i[0])&&(n=t.$.extend({},n,i[0]));var o=t.utils.uid("resizestart"),r=t.$.extend({delay:t.$.event.special.resizestart.defaults.delay},n),a=r,s=function(e){a&&clearTimeout(a),a=setTimeout(function(){return a=null,e.type="resizestart.chicago.dom",t.$(e.target).trigger("resizestart",e)},r.delay)};return t.$(this).data("chicago.event.resizestart.uid",o),t.$(this).on("resizestart.chicago.dom",function(){return t.$(this).off("resize",s)}),t.$(this).on("resizeend.chicago.dom",function(){return t.$(this).on("resize",s).data(o,s)}),t.$(this).on("resize",s).data(o,s)},teardown:function(){var e=t.$(this).data("chicago.event.resizestart.uid");return t.$(this).off("resize",t.$(this).data(e)),t.$(this).removeData(e),t.$(this).removeData("chicago.event.resizestart.uid")}},function(){t.$.event.special.resizeend=t.events.resizeend,t.$.event.special.resizestart=t.events.resizestart,t.$.fn.resizestart=function(e,i){return this.each(function(){t.$(this).on("resizestart",e,i)})}}()}),function(t){var e=window.Chicago||{utils:{now:Date.now||function(){return(new Date).getTime()},uid:function(t){return(t||"id")+e.utils.now()+"RAND"+Math.ceil(1e5*Math.random())},is:{number:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},fn:function(t){return"function"==typeof t},object:function(t){return"[object Object]"===Object.prototype.toString.call(t)}},debounce:function(t,e,i){var n;return function(){var o=this,r=arguments,a=function(){n=null,i||t.apply(o,r)},s=i&&!n;n&&clearTimeout(n),n=setTimeout(a,e),s&&t.apply(o,r)}}},$:window.jQuery||null};if("function"==typeof define&&define.amd&&define("chicago",function(){return e.load=function(t,i,n,o){var r=t.split(","),a=[],s=(o.config&&o.config.chicago&&o.config.chicago.base?o.config.chicago.base:"").replace(/\/+$/g,"");if(!s)throw new Error("Please define base path to jQuery resizeend in the requirejs config.");for(var l=0;l<r.length;){var c=r[l].replace(/\./g,"/");a.push(s+"/"+c),l+=1}i(a,function(){n(e)})},e}),window&&window.jQuery)return t(e,window,window.document);if(!window.jQuery)throw new Error("jQuery resizeend requires jQuery")}(function(t,e,i){t.$win=t.$(e),t.$doc=t.$(i),t.events||(t.events={}),t.events.resizeend={defaults:{delay:250},setup:function(){var e,i=arguments,n={delay:t.$.event.special.resizeend.defaults.delay};t.utils.is.fn(i[0])?e=i[0]:t.utils.is.number(i[0])?n.delay=i[0]:t.utils.is.object(i[0])&&(n=t.$.extend({},n,i[0]));var o=t.utils.uid("resizeend"),r=t.$.extend({delay:t.$.event.special.resizeend.defaults.delay},n),a=r,s=function(e){a&&clearTimeout(a),a=setTimeout(function(){return a=null,e.type="resizeend.chicago.dom",t.$(e.target).trigger("resizeend",e)},r.delay)};return t.$(this).data("chicago.event.resizeend.uid",o),t.$(this).on("resize",t.utils.debounce(s,100)).data(o,s)},teardown:function(){var e=t.$(this).data("chicago.event.resizeend.uid");return t.$(this).off("resize",t.$(this).data(e)),t.$(this).removeData(e),t.$(this).removeData("chicago.event.resizeend.uid")}},function(){t.$.event.special.resizeend=t.events.resizeend,t.$.fn.resizeend=function(e,i){return this.each(function(){t.$(this).on("resizeend",e,i)})}}()}),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";function e(t){for(var e,i=t.split(/\s+/),n=[],o=0;e=i[o];o++)e=e.charAt(0).toUpperCase(),n.push(e);return n}function i(e){return e.id&&t('label[for="'+e.id+'"]').val()||e.name}function n(e,o,r){return r||(r=0),o.each(function(){var o,a,s=t(this),l=this,c=this.nodeName.toLowerCase();switch("label"===c&&s.find("input, textarea, select").length&&(o=s.text(),s=s.children().first(),l=s.get(0),c=l.nodeName.toLowerCase()),c){case"menu":a={name:s.attr("label"),items:{}},r=n(a.items,s.children(),r);break;case"a":case"button":a={name:s.text(),disabled:!!s.attr("disabled"),callback:function(){return function(){s.click()}}()};break;case"menuitem":case"command":switch(s.attr("type")){case void 0:case"command":case"menuitem":a={name:s.attr("label"),disabled:!!s.attr("disabled"),icon:s.attr("icon"),callback:function(){return function(){s.click()}}()};break;case"checkbox":a={type:"checkbox",disabled:!!s.attr("disabled"),name:s.attr("label"),selected:!!s.attr("checked")};break;case"radio":a={type:"radio",disabled:!!s.attr("disabled"),name:s.attr("label"),radio:s.attr("radiogroup"),value:s.attr("id"),selected:!!s.attr("checked")};break;default:a=void 0}break;case"hr":a="-------";break;case"input":switch(s.attr("type")){case"text":a={type:"text",name:o||i(l),disabled:!!s.attr("disabled"),value:s.val()};break;case"checkbox":a={type:"checkbox",name:o||i(l),disabled:!!s.attr("disabled"),selected:!!s.attr("checked")};break;case"radio":a={type:"radio",name:o||i(l),disabled:!!s.attr("disabled"),radio:!!s.attr("name"),value:s.val(),selected:!!s.attr("checked")};break;default:a=void 0}break;case"select":a={type:"select",name:o||i(l),disabled:!!s.attr("disabled"),selected:s.val(),options:{}},s.children().each(function(){a.options[this.value]=t(this).text()});break;case"textarea":a={type:"textarea",name:o||i(l),disabled:!!s.attr("disabled"),value:s.val()};break;case"label":break;default:a={type:"html",html:s.clone(!0)}}a&&(r++,e["key"+r]=a)}),r}t.support.htmlMenuitem="HTMLMenuItemElement"in window,t.support.htmlCommand="HTMLCommandElement"in window,t.support.eventSelectstart="onselectstart"in document.documentElement,t.ui&&t.widget||(t.cleanData=function(e){return function(i){var n,o,r;for(r=0;null!=i[r];r++){o=i[r];try{n=t._data(o,"events"),n&&n.remove&&t(o).triggerHandler("remove")}catch(a){}}e(i)}}(t.cleanData));var o=null,r=!1,a=t(window),s=0,l={},c={},u={},d={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",iconQuit:"context-menu-icon-quit"},determinePosition:function(e){if(t.ui&&t.ui.position)e.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var i=this.offset();i.top+=this.outerHeight(),i.left+=this.outerWidth()/2-e.outerWidth()/2,e.css(i)}},position:function(t,e,i){var n;if(!e&&!i)return void t.determinePosition.call(this,t.$menu);n="maintain"===e&&"maintain"===i?t.$menu.position():{top:i,left:e};var o=a.scrollTop()+a.height(),r=a.scrollLeft()+a.width(),s=t.$menu.outerHeight(),l=t.$menu.outerWidth();n.top+s>o&&(n.top-=s),n.top<0&&(n.top=0),n.left+l>r&&(n.left-=l),n.left<0&&(n.left=0),t.$menu.css(n)},positionSubmenu:function(e){if(t.ui&&t.ui.position)e.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var i={top:0,left:this.outerWidth()};e.css(i)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:t.noop,hide:t.noop},callback:null,items:{}},h={timer:null,pageX:null,pageY:null},p=function(t){for(var e=0,i=t;;)if(e=Math.max(e,parseInt(i.css("z-index"),10)||0),i=i.parent(),!i||!i.length||"html body".indexOf(i.prop("nodeName").toLowerCase())>-1)break;return e},f={abortevent:function(t){t.preventDefault(),t.stopImmediatePropagation()},contextmenu:function(e){var i=t(this);if("right"===e.data.trigger&&(e.preventDefault(),e.stopImmediatePropagation()),!("right"!==e.data.trigger&&"demand"!==e.data.trigger&&e.originalEvent||!(void 0===e.mouseButton||!e.data||"left"===e.data.trigger&&0===e.mouseButton||"right"===e.data.trigger&&2===e.mouseButton)||i.hasClass("context-menu-active")||i.hasClass("context-menu-disabled"))){if(o=i,e.data.build){var n=e.data.build(o,e);if(n===!1)return;if(e.data=t.extend(!0,{},d,e.data,n||{}),!e.data.items||t.isEmptyObject(e.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");e.data.$trigger=o,m.create(e.data)}var r=!1;for(var a in e.data.items)if(e.data.items.hasOwnProperty(a)){var s;s=t.isFunction(e.data.items[a].visible)?e.data.items[a].visible.call(t(e.currentTarget),a,e.data):"undefined"!=typeof a.visible?e.data.items[a].visible===!0:!0,s&&(r=!0)}if(r){var l=t(null===e.data.appendTo?"body":e.data.appendTo),c=e.target||e.srcElement||e.originalTarget;void 0!==e.offsetX&&void 0!==e.offsetY?m.show.call(i,e.data,t(c).offset().left-l.offset().left+e.offsetX,t(c).offset().top-l.offset().top+e.offsetY):m.show.call(i,e.data,e.pageX,e.pageY)}}},click:function(e){e.preventDefault(),e.stopImmediatePropagation(),t(this).trigger(t.Event("contextmenu",{data:e.data,pageX:e.pageX,pageY:e.pageY}))},mousedown:function(e){var i=t(this);o&&o.length&&!o.is(i)&&o.data("contextMenu").$menu.trigger("contextmenu:hide"),2===e.button&&(o=i.data("contextMenuActive",!0))},mouseup:function(e){var i=t(this);i.data("contextMenuActive")&&o&&o.length&&o.is(i)&&!i.hasClass("context-menu-disabled")&&(e.preventDefault(),e.stopImmediatePropagation(),o=i,i.trigger(t.Event("contextmenu",{data:e.data,pageX:e.pageX,pageY:e.pageY}))),i.removeData("contextMenuActive")},mouseenter:function(e){var i=t(this),n=t(e.relatedTarget),r=t(document);n.is(".context-menu-list")||n.closest(".context-menu-list").length||o&&o.length||(h.pageX=e.pageX,h.pageY=e.pageY,h.data=e.data,r.on("mousemove.contextMenuShow",f.mousemove),h.timer=setTimeout(function(){h.timer=null,r.off("mousemove.contextMenuShow"),o=i,i.trigger(t.Event("contextmenu",{data:h.data,pageX:h.pageX,pageY:h.pageY}))},e.data.delay))},mousemove:function(t){h.pageX=t.pageX,h.pageY=t.pageY},mouseleave:function(e){var i=t(e.relatedTarget);if(!i.is(".context-menu-list")&&!i.closest(".context-menu-list").length){try{clearTimeout(h.timer)}catch(e){}h.timer=null}},layerClick:function(e){var i,n,o=t(this),r=o.data("contextMenuRoot"),s=e.button,l=e.pageX,c=e.pageY;e.preventDefault(),e.stopImmediatePropagation(),setTimeout(function(){var o,u="left"===r.trigger&&0===s||"right"===r.trigger&&2===s;if(document.elementFromPoint&&r.$layer&&(r.$layer.hide(),i=document.elementFromPoint(l-a.scrollLeft(),c-a.scrollTop()),r.$layer.show()),r.reposition&&u)if(document.elementFromPoint){if(r.$trigger.is(i)||r.$trigger.has(i).length)return void r.position.call(r.$trigger,r,l,c)}else if(n=r.$trigger.offset(),o=t(window),n.top+=o.scrollTop(),n.top<=e.pageY&&(n.left+=o.scrollLeft(),n.left<=e.pageX&&(n.bottom=n.top+r.$trigger.outerHeight(),n.bottom>=e.pageY&&(n.right=n.left+r.$trigger.outerWidth(),n.right>=e.pageX))))return void r.position.call(r.$trigger,r,l,c);i&&u&&r.$trigger.one("contextmenu:hidden",function(){t(i).contextMenu({x:l,y:c,button:s})}),r.$menu.trigger("contextmenu:hide")},50)},keyStop:function(t,e){e.isInput||t.preventDefault(),t.stopPropagation()},key:function(t){var e={};o&&(e=o.data("contextMenu")||{}),void 0===e.zIndex&&(e.zIndex=0);var i=0,n=function(t){""!==t.style.zIndex?i=t.style.zIndex:null!==t.offsetParent&&void 0!==t.offsetParent?n(t.offsetParent):null!==t.parentElement&&void 0!==t.parentElement&&n(t.parentElement)};if(n(t.target),!(i>e.zIndex)){switch(t.keyCode){case 9:case 38:if(f.keyStop(t,e),e.isInput){if(9===t.keyCode&&t.shiftKey)return t.preventDefault(),e.$selected&&e.$selected.find("input, textarea, select").blur(),void e.$menu.trigger("prevcommand");if(38===t.keyCode&&"checkbox"===e.$selected.find("input, textarea, select").prop("type"))return void t.preventDefault()}else if(9!==t.keyCode||t.shiftKey)return void e.$menu.trigger("prevcommand");break;case 40:if(f.keyStop(t,e),!e.isInput)return void e.$menu.trigger("nextcommand");if(9===t.keyCode)return t.preventDefault(),e.$selected&&e.$selected.find("input, textarea, select").blur(),void e.$menu.trigger("nextcommand");if(40===t.keyCode&&"checkbox"===e.$selected.find("input, textarea, select").prop("type"))return void t.preventDefault();break;case 37:if(f.keyStop(t,e),e.isInput||!e.$selected||!e.$selected.length)break;if(!e.$selected.parent().hasClass("context-menu-root")){var r=e.$selected.parent().parent();return e.$selected.trigger("contextmenu:blur"),void(e.$selected=r)}break;case 39:if(f.keyStop(t,e),e.isInput||!e.$selected||!e.$selected.length)break;var a=e.$selected.data("contextMenu")||{};if(a.$menu&&e.$selected.hasClass("context-menu-submenu"))return e.$selected=null,a.$selected=null,void a.$menu.trigger("nextcommand");break;case 35:case 36:return e.$selected&&e.$selected.find("input, textarea, select").length?void 0:((e.$selected&&e.$selected.parent()||e.$menu).children(":not(."+e.classNames.disabled+", ."+e.classNames.notSelectable+")")[36===t.keyCode?"first":"last"]().trigger("contextmenu:focus"),void t.preventDefault());case 13:if(f.keyStop(t,e),e.isInput){if(e.$selected&&!e.$selected.is("textarea, select"))return void t.preventDefault();break}return void("undefined"!=typeof e.$selected&&null!==e.$selected&&e.$selected.trigger("mouseup"));case 32:case 33:case 34:return void f.keyStop(t,e);case 27:return f.keyStop(t,e),void e.$menu.trigger("contextmenu:hide");default:var s=String.fromCharCode(t.keyCode).toUpperCase();if(e.accesskeys&&e.accesskeys[s])return void e.accesskeys[s].$node.trigger(e.accesskeys[s].$menu?"contextmenu:focus":"mouseup")}t.stopPropagation(),"undefined"!=typeof e.$selected&&null!==e.$selected&&e.$selected.trigger(t)}},prevItem:function(e){e.stopPropagation();var i=t(this).data("contextMenu")||{},n=t(this).data("contextMenuRoot")||{};if(i.$selected){var o=i.$selected;i=i.$selected.parent().data("contextMenu")||{},i.$selected=o}for(var r=i.$menu.children(),a=i.$selected&&i.$selected.prev().length?i.$selected.prev():r.last(),s=a;a.hasClass(n.classNames.disabled)||a.hasClass(n.classNames.notSelectable)||a.is(":hidden");)if(a=a.prev().length?a.prev():r.last(),a.is(s))return;i.$selected&&f.itemMouseleave.call(i.$selected.get(0),e),f.itemMouseenter.call(a.get(0),e);var l=a.find("input, textarea, select");l.length&&l.focus()},nextItem:function(e){e.stopPropagation();var i=t(this).data("contextMenu")||{},n=t(this).data("contextMenuRoot")||{};if(i.$selected){var o=i.$selected;i=i.$selected.parent().data("contextMenu")||{},i.$selected=o}for(var r=i.$menu.children(),a=i.$selected&&i.$selected.next().length?i.$selected.next():r.first(),s=a;a.hasClass(n.classNames.disabled)||a.hasClass(n.classNames.notSelectable)||a.is(":hidden");)if(a=a.next().length?a.next():r.first(),a.is(s))return;i.$selected&&f.itemMouseleave.call(i.$selected.get(0),e),f.itemMouseenter.call(a.get(0),e);var l=a.find("input, textarea, select");l.length&&l.focus()},focusInput:function(){var e=t(this).closest(".context-menu-item"),i=e.data(),n=i.contextMenu,o=i.contextMenuRoot;o.$selected=n.$selected=e,o.isInput=n.isInput=!0},blurInput:function(){var e=t(this).closest(".context-menu-item"),i=e.data(),n=i.contextMenu,o=i.contextMenuRoot;o.isInput=n.isInput=!1},menuMouseenter:function(){var e=t(this).data().contextMenuRoot;e.hovering=!0},menuMouseleave:function(e){var i=t(this).data().contextMenuRoot;i.$layer&&i.$layer.is(e.relatedTarget)&&(i.hovering=!1)},itemMouseenter:function(e){var i=t(this),n=i.data(),o=n.contextMenu,r=n.contextMenuRoot;return r.hovering=!0,e&&r.$layer&&r.$layer.is(e.relatedTarget)&&(e.preventDefault(),e.stopImmediatePropagation()),(o.$menu?o:r).$menu.children("."+r.classNames.hover).trigger("contextmenu:blur").children(".hover").trigger("contextmenu:blur"),i.hasClass(r.classNames.disabled)||i.hasClass(r.classNames.notSelectable)?void(o.$selected=null):void i.trigger("contextmenu:focus")},itemMouseleave:function(e){var i=t(this),n=i.data(),o=n.contextMenu,r=n.contextMenuRoot;return r!==o&&r.$layer&&r.$layer.is(e.relatedTarget)?("undefined"!=typeof r.$selected&&null!==r.$selected&&r.$selected.trigger("contextmenu:blur"),e.preventDefault(),e.stopImmediatePropagation(),void(r.$selected=o.$selected=o.$node)):void i.trigger("contextmenu:blur")},itemClick:function(e){var i,n=t(this),o=n.data(),r=o.contextMenu,a=o.contextMenuRoot,s=o.contextMenuKey;if(r.items[s]&&!n.is("."+a.classNames.disabled+", .context-menu-submenu, .context-menu-separator, ."+a.classNames.notSelectable)){if(e.preventDefault(),e.stopImmediatePropagation(),t.isFunction(a.callbacks[s])&&Object.prototype.hasOwnProperty.call(a.callbacks,s))i=a.callbacks[s];else{if(!t.isFunction(a.callback))return;i=a.callback}i.call(a.$trigger,s,a)!==!1?a.$menu.trigger("contextmenu:hide"):a.$menu.parent().length&&m.update.call(a.$trigger,a)}},inputClick:function(t){t.stopImmediatePropagation()},hideMenu:function(e,i){var n=t(this).data("contextMenuRoot");m.hide.call(n.$trigger,n,i&&i.force)},focusItem:function(e){e.stopPropagation();var i=t(this),n=i.data(),o=n.contextMenu,r=n.contextMenuRoot;i.hasClass(r.classNames.disabled)||i.hasClass(r.classNames.notSelectable)||(i.addClass([r.classNames.hover,r.classNames.visible].join(" ")).parent().find(".context-menu-item").not(i).removeClass(r.classNames.visible).filter("."+r.classNames.hover).trigger("contextmenu:blur"),o.$selected=r.$selected=i,o.$node&&r.positionSubmenu.call(o.$node,o.$menu))},blurItem:function(e){e.stopPropagation();var i=t(this),n=i.data(),o=n.contextMenu,r=n.contextMenuRoot;o.autoHide&&i.removeClass(r.classNames.visible),i.removeClass(r.classNames.hover),o.$selected=null}},m={show:function(e,i,n){var r=t(this),a={};if(t("#context-menu-layer").trigger("mousedown"),e.$trigger=r,e.events.show.call(r,e)===!1)return void(o=null);if(m.update.call(r,e),e.position.call(r,e,i,n),e.zIndex){var s=e.zIndex;"function"==typeof e.zIndex&&(s=e.zIndex.call(r,e)),a.zIndex=p(r)+s}m.layer.call(e.$menu,e,a.zIndex),e.$menu.find("ul").css("zIndex",a.zIndex+1),e.$menu.css(a)[e.animation.show](e.animation.duration,function(){r.trigger("contextmenu:visible")}),r.data("contextMenu",e).addClass("context-menu-active"),t(document).off("keydown.contextMenu").on("keydown.contextMenu",f.key),e.autoHide&&t(document).on("mousemove.contextMenuAutoHide",function(t){var i=r.offset();i.right=i.left+r.outerWidth(),i.bottom=i.top+r.outerHeight(),!e.$layer||e.hovering||t.pageX>=i.left&&t.pageX<=i.right&&t.pageY>=i.top&&t.pageY<=i.bottom||setTimeout(function(){e.hovering||e.$menu.trigger("contextmenu:hide")},50)})},hide:function(e,i){var n=t(this);if(e||(e=n.data("contextMenu")||{}),i||!e.events||e.events.hide.call(n,e)!==!1){if(n.removeData("contextMenu").removeClass("context-menu-active"),e.$layer){setTimeout(function(t){return function(){t.remove()}}(e.$layer),10);try{delete e.$layer}catch(r){e.$layer=null}}o=null,e.$menu.find("."+e.classNames.hover).trigger("contextmenu:blur"),e.$selected=null,e.$menu.find("."+e.classNames.visible).removeClass(e.classNames.visible),t(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),e.$menu&&e.$menu[e.animation.hide](e.animation.duration,function(){e.build&&(e.$menu.remove(),t.each(e,function(t){switch(t){case"ns":case"selector":case"build":case"trigger":return!0;default:e[t]=void 0;try{delete e[t]}catch(i){}return!0}})),setTimeout(function(){n.trigger("contextmenu:hidden")},10)})}},create:function(i,n){function o(e){var i=t("<span></span>");return e._accesskey?(e._beforeAccesskey&&i.append(document.createTextNode(e._beforeAccesskey)),t("<span></span>").addClass("context-menu-accesskey").text(e._accesskey).appendTo(i),e._afterAccesskey&&i.append(document.createTextNode(e._afterAccesskey))):i.text(e.name),i}void 0===n&&(n=i),i.$menu=t('<ul class="context-menu-list"></ul>').addClass(i.className||"").data({contextMenu:i,contextMenuRoot:n}),t.each(["callbacks","commands","inputs"],function(t,e){i[e]={},n[e]||(n[e]={})}),n.accesskeys||(n.accesskeys={}),t.each(i.items,function(r,a){var s=t('<li class="context-menu-item"></li>').addClass(a.className||""),l=null,c=null;if(s.on("click",t.noop),"string"==typeof a&&(a={type:"cm_seperator"}),a.$node=s.data({contextMenu:i,contextMenuRoot:n,contextMenuKey:r}),"undefined"!=typeof a.accesskey)for(var d,h=e(a.accesskey),p=0;d=h[p];p++)if(!n.accesskeys[d]){n.accesskeys[d]=a;var g=a.name.match(new RegExp("^(.*?)("+d+")(.*)$","i"));g&&(a._beforeAccesskey=g[1],a._accesskey=g[2],a._afterAccesskey=g[3]);break}if(a.type&&u[a.type])u[a.type].call(s,a,i,n),t.each([i,n],function(e,i){i.commands[r]=a,t.isFunction(a.callback)&&(i.callbacks[r]=a.callback)});else{switch("cm_seperator"===a.type?s.addClass("context-menu-separator "+n.classNames.notSelectable):"html"===a.type?s.addClass("context-menu-html "+n.classNames.notSelectable):a.type?(l=t("<label></label>").appendTo(s),o(a).appendTo(l),s.addClass("context-menu-input"),i.hasTypes=!0,t.each([i,n],function(t,e){e.commands[r]=a,e.inputs[r]=a})):a.items&&(a.type="sub"),a.type){case"cm_seperator":break;case"text":c=t('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+r).val(a.value||"").appendTo(l);break;case"textarea":c=t('<textarea name=""></textarea>').attr("name","context-menu-input-"+r).val(a.value||"").appendTo(l),a.height&&c.height(a.height);break;case"checkbox":c=t('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+r).val(a.value||"").prop("checked",!!a.selected).prependTo(l);break;case"radio":c=t('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+a.radio).val(a.value||"").prop("checked",!!a.selected).prependTo(l);break;case"select":c=t('<select name="">').attr("name","context-menu-input-"+r).appendTo(l),a.options&&(t.each(a.options,function(e,i){t("<option></option>").val(e).text(i).appendTo(c)}),c.val(a.selected));break;case"sub":o(a).appendTo(s),a.appendTo=a.$node,m.create(a,n),s.data("contextMenu",a).addClass("context-menu-submenu"),a.callback=null;break;case"html":t(a.html).appendTo(s);break;default:t.each([i,n],function(e,i){i.commands[r]=a,t.isFunction(a.callback)&&(i.callbacks[r]=a.callback)}),o(a).appendTo(s)}a.type&&"sub"!==a.type&&"html"!==a.type&&"cm_seperator"!==a.type&&(c.on("focus",f.focusInput).on("blur",f.blurInput),a.events&&c.on(a.events,i)),a.icon&&(a._icon=t.isFunction(a.icon)?a.icon.call(this,this,s,r,a):n.classNames.icon+" "+n.classNames.icon+"-"+a.icon,s.addClass(a._icon))}a.$input=c,a.$label=l,s.appendTo(i.$menu),!i.hasTypes&&t.support.eventSelectstart&&s.on("selectstart.disableTextSelect",f.abortevent)}),i.$node||i.$menu.css("display","none").addClass("context-menu-root"),i.$menu.appendTo(i.appendTo||document.body)},resize:function(e,i){var n;e.css({position:"absolute",display:"block"}),e.data("width",(n=e.get(0)).getBoundingClientRect?Math.ceil(n.getBoundingClientRect().width):e.outerWidth()+1),e.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),e.find("> li > ul").each(function(){m.resize(t(this),!0)}),i||e.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).outerWidth(function(){return t(this).data("width")})},update:function(e,i){var n=this;void 0===i&&(i=e,m.resize(e.$menu)),e.$menu.children().each(function(){var o,r=t(this),a=r.data("contextMenuKey"),s=e.items[a],l=t.isFunction(s.disabled)&&s.disabled.call(n,a,i)||s.disabled===!0;if(o=t.isFunction(s.visible)?s.visible.call(n,a,i):"undefined"!=typeof s.visible?s.visible===!0:!0,r[o?"show":"hide"](),r[l?"addClass":"removeClass"](i.classNames.disabled),t.isFunction(s.icon)&&(r.removeClass(s._icon),s._icon=s.icon.call(this,n,r,a,s),r.addClass(s._icon)),s.type)switch(r.find("input, select, textarea").prop("disabled",l),s.type){case"text":case"textarea":s.$input.val(s.value||"");break;case"checkbox":case"radio":s.$input.val(s.value||"").prop("checked",!!s.selected);break;case"select":s.$input.val(s.selected||"")}s.$menu&&m.update.call(n,s,i)})},layer:function(e,i){var n=e.$layer=t('<div id="context-menu-layer" style="position:fixed; z-index:'+i+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:a.height(),width:a.width(),display:"block"}).data("contextMenuRoot",e).insertBefore(this).on("contextmenu",f.abortevent).on("mousedown",f.layerClick);return void 0===document.body.style.maxWidth&&n.css({position:"absolute",height:t(document).height()}),n}};t.fn.contextMenu=function(e){var i=this,n=e;if(this.length>0)if(void 0===e)this.first().trigger("contextmenu");else if(void 0!==e.x&&void 0!==e.y)this.first().trigger(t.Event("contextmenu",{pageX:e.x,pageY:e.y,mouseButton:e.button}));else if("hide"===e){var o=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;

o&&o.trigger("contextmenu:hide")}else"destroy"===e?t.contextMenu("destroy",{context:this}):t.isPlainObject(e)?(e.context=this,t.contextMenu("create",e)):e?this.removeClass("context-menu-disabled"):e||this.addClass("context-menu-disabled");else t.each(c,function(){this.selector===i.selector&&(n.data=this,t.extend(n.data,{trigger:"demand"}))}),f.contextmenu.call(n.target,n);return this},t.contextMenu=function(e,i){"string"!=typeof e&&(i=e,e="create"),"string"==typeof i?i={selector:i}:void 0===i&&(i={});var n=t.extend(!0,{},d,i||{}),o=t(document),a=o,u=!1;switch(n.context&&n.context.length?(a=t(n.context).first(),n.context=a.get(0),u=n.context!==document):n.context=document,e){case"create":if(!n.selector)throw new Error("No selector specified");if(n.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+n.selector+'" as it contains a reserved className');if(!n.build&&(!n.items||t.isEmptyObject(n.items)))throw new Error("No Items specified");switch(s++,n.ns=".contextMenu"+s,u||(l[n.selector]=n.ns),c[n.ns]=n,n.trigger||(n.trigger="right"),r||(o.on({"contextmenu:hide.contextMenu":f.hideMenu,"prevcommand.contextMenu":f.prevItem,"nextcommand.contextMenu":f.nextItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.menuMouseenter,"mouseleave.contextMenu":f.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",f.inputClick).on({"mouseup.contextMenu":f.itemClick,"contextmenu:focus.contextMenu":f.focusItem,"contextmenu:blur.contextMenu":f.blurItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.itemMouseenter,"mouseleave.contextMenu":f.itemMouseleave},".context-menu-item"),r=!0),a.on("contextmenu"+n.ns,n.selector,n,f.contextmenu),u&&a.on("remove"+n.ns,function(){t(this).contextMenu("destroy")}),n.trigger){case"hover":a.on("mouseenter"+n.ns,n.selector,n,f.mouseenter).on("mouseleave"+n.ns,n.selector,n,f.mouseleave);break;case"left":a.on("click"+n.ns,n.selector,n,f.click)}n.build||m.create(n);break;case"destroy":var h;if(u){var p=n.context;t.each(c,function(e,i){if(i.context!==p)return!0;h=t(".context-menu-list").filter(":visible"),h.length&&h.data().contextMenuRoot.$trigger.is(t(i.context).find(i.selector))&&h.trigger("contextmenu:hide",{force:!0});try{c[i.ns].$menu&&c[i.ns].$menu.remove(),delete c[i.ns]}catch(n){c[i.ns]=null}return t(i.context).off(i.ns),!0})}else if(n.selector){if(l[n.selector]){h=t(".context-menu-list").filter(":visible"),h.length&&h.data().contextMenuRoot.$trigger.is(n.selector)&&h.trigger("contextmenu:hide",{force:!0});try{c[l[n.selector]].$menu&&c[l[n.selector]].$menu.remove(),delete c[l[n.selector]]}catch(g){c[l[n.selector]]=null}o.off(l[n.selector])}}else o.off(".contextMenu .contextMenuAutoHide"),t.each(c,function(e,i){t(i.context).off(i.ns)}),l={},c={},s=0,r=!1,t("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!t.support.htmlCommand&&!t.support.htmlMenuitem||"boolean"==typeof i&&i)&&t('menu[type="context"]').each(function(){this.id&&t.contextMenu({selector:"[contextmenu="+this.id+"]",items:t.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+e+'"')}return this},t.contextMenu.setInputValues=function(e,i){void 0===i&&(i={}),t.each(e.inputs,function(t,e){switch(e.type){case"text":case"textarea":e.value=i[t]||"";break;case"checkbox":e.selected=i[t]?!0:!1;break;case"radio":e.selected=(i[e.radio]||"")===e.value;break;case"select":e.selected=i[t]||""}})},t.contextMenu.getInputValues=function(e,i){return void 0===i&&(i={}),t.each(e.inputs,function(t,e){switch(e.type){case"text":case"textarea":case"select":i[t]=e.$input.val();break;case"checkbox":i[t]=e.$input.prop("checked");break;case"radio":e.$input.prop("checked")&&(i[e.radio]=e.value)}}),i},t.contextMenu.fromMenu=function(e){var i=t(e),o={};return n(o,i.children()),o},t.contextMenu.defaults=d,t.contextMenu.types=u,t.contextMenu.handle=f,t.contextMenu.op=m,t.contextMenu.menus=c}),function(t,e){"use strict";function i(i,n){this.options=t.extend({},s,n),this.$element=t(i),this.$win=t(e),this.$loadingClassTarget=this._getLoadingClassTarget(),this.$scrollContainer=this._getScrollContainer(),this.loading=!1,this.doneLoadingInt=null,this.pageCount=this.options.triggerInitialLoad?this.options.startingPageCount-1:this.options.startingPageCount,this.destroyed=!1,this._init()}function n(e,i,n){e&&t.isFunction(e[i])&&e[i].apply(e,n)}function o(t,e,i){var n;return function(){var o=this,r=arguments,a=function(){n=null,i||t.apply(o,r)},s=i&&!n;clearTimeout(n),n=setTimeout(a,e),s&&t.apply(o,r)}}var r="infiniteScrollHelper",a="plugin_"+r,s={bottomBuffer:0,debounceInt:100,doneLoading:null,interval:300,loadingClass:"loading",loadingClassTarget:null,loadMoreDelay:0,loadMore:t.noop,startingPageCount:1,triggerInitialLoad:!1};i.prototype._init=function(){this._addListeners(),this.options.triggerInitialLoad?this._beginLoadMore(this.options.loadMoreDelay):this._handleScroll()},i.prototype._getLoadingClassTarget=function(){return this.options.loadingClassTarget?t(this.options.loadingClassTarget):this.$element},i.prototype._getScrollContainer=function(){var e=null;return"scroll"==this.$element.css("overflow-y")&&(e=this.$element),e||(e=this.$element.parents().filter(function(){return"scroll"==t(this).css("overflow-y")})),e=e.length>0?e:this.$win},i.prototype._addListeners=function(){var t=this;this.$scrollContainer.on("scroll."+r,o(function(){t._handleScroll()},this.options.debounceInt))},i.prototype._removeListeners=function(){this.$scrollContainer.off("scroll."+r)},i.prototype._handleScroll=function(t){var e=this;this._shouldTriggerLoad()&&(this._beginLoadMore(this.options.loadMoreDelay),this.options.doneLoading&&(this.doneLoadingInt=setInterval(function(){e.options.doneLoading(e.pageCount)&&e._endLoadMore()},this.options.interval)))},i.prototype._shouldTriggerLoad=function(){var t=this._getElementHeight(),e=this.$scrollContainer.scrollTop()+this.$scrollContainer.height()+this.options.bottomBuffer;return!this.loading&&e>=t&&this.$element.is(":visible")},i.prototype._getElementHeight=function(){return this.$element==this.$scrollContainer?this.$element[0].scrollHeight:this.$element.height()},i.prototype._beginLoadMore=function(e){e=e||0,setTimeout(t.proxy(function(){this.pageCount++,this.options.loadMore(this.pageCount,t.proxy(this._endLoadMore,this)),this.$loadingClassTarget.addClass(this.options.loadingClass)},this),e),this.loading=!0,this._removeListeners()},i.prototype._endLoadMore=function(){clearInterval(this.doneLoadingInt),this.loading=!1,this.$loadingClassTarget.removeClass(this.options.loadingClass),!this.destroyed&&this._addListeners()},i.prototype.destroy=function(){this._removeListeners(),this.options.loadMore=null,this.options.doneLoading=null,t.data(this.$element[0],a,null),clearInterval(this.doneLoadingInt),this.destroyed=!0},t.fn[r]=function(e){var o=!1,r=arguments;return"string"==typeof e&&(o=e),this.each(function(){var s=t.data(this,a);s||o?o&&n(s,o,Array.prototype.slice.call(r,1)):t.data(this,a,new i(this,e))})},e.InfiniteScrollHelper=e.InfiniteScrollHelper||i}(jQuery,window),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){return function(){function e(t,e,i){return[parseFloat(t[0])*(p.test(t[0])?e/100:1),parseFloat(t[1])*(p.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}function n(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var o,r,a=Math.max,s=Math.abs,l=Math.round,c=/left|center|right/,u=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,h=/^\w+/,p=/%$/,f=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==o)return o;var e,i,n=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),r=n.children()[0];return t("body").append(n),e=r.offsetWidth,n.css("overflow","scroll"),i=r.offsetWidth,e===i&&(i=n[0].clientWidth),n.remove(),o=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),n=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),o="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,r="scroll"===n||"auto"===n&&e.height<e.element[0].scrollHeight;return{width:r?t.position.scrollbarWidth():0,height:o?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),n=t.isWindow(i[0]),o=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:n,isDocument:o,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n||o?i.width():i.outerWidth(),height:n||o?i.height():i.outerHeight()}}},t.fn.position=function(o){if(!o||!o.of)return f.apply(this,arguments);o=t.extend({},o);var p,m,g,v,y,w,b=t(o.of),_=t.position.getWithinInfo(o.within),x=t.position.getScrollInfo(_),$=(o.collision||"flip").split(" "),k={};return w=n(b),b[0].preventDefault&&(o.at="left top"),m=w.width,g=w.height,v=w.offset,y=t.extend({},v),t.each(["my","at"],function(){var t,e,i=(o[this]||"").split(" ");1===i.length&&(i=c.test(i[0])?i.concat(["center"]):u.test(i[0])?["center"].concat(i):["center","center"]),i[0]=c.test(i[0])?i[0]:"center",i[1]=u.test(i[1])?i[1]:"center",t=d.exec(i[0]),e=d.exec(i[1]),k[this]=[t?t[0]:0,e?e[0]:0],o[this]=[h.exec(i[0])[0],h.exec(i[1])[0]]}),1===$.length&&($[1]=$[0]),"right"===o.at[0]?y.left+=m:"center"===o.at[0]&&(y.left+=m/2),"bottom"===o.at[1]?y.top+=g:"center"===o.at[1]&&(y.top+=g/2),p=e(k.at,m,g),y.left+=p[0],y.top+=p[1],this.each(function(){var n,c,u=t(this),d=u.outerWidth(),h=u.outerHeight(),f=i(this,"marginLeft"),w=i(this,"marginTop"),C=d+f+i(this,"marginRight")+x.width,T=h+w+i(this,"marginBottom")+x.height,I=t.extend({},y),S=e(k.my,u.outerWidth(),u.outerHeight());"right"===o.my[0]?I.left-=d:"center"===o.my[0]&&(I.left-=d/2),"bottom"===o.my[1]?I.top-=h:"center"===o.my[1]&&(I.top-=h/2),I.left+=S[0],I.top+=S[1],r||(I.left=l(I.left),I.top=l(I.top)),n={marginLeft:f,marginTop:w},t.each(["left","top"],function(e,i){t.ui.position[$[e]]&&t.ui.position[$[e]][i](I,{targetWidth:m,targetHeight:g,elemWidth:d,elemHeight:h,collisionPosition:n,collisionWidth:C,collisionHeight:T,offset:[p[0]+S[0],p[1]+S[1]],my:o.my,at:o.at,within:_,elem:u})}),o.using&&(c=function(t){var e=v.left-I.left,i=e+m-d,n=v.top-I.top,r=n+g-h,l={target:{element:b,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:I.left,top:I.top,width:d,height:h},horizontal:0>i?"left":e>0?"right":"center",vertical:0>r?"top":n>0?"bottom":"middle"};d>m&&s(e+i)<m&&(l.horizontal="center"),h>g&&s(n+r)<g&&(l.vertical="middle"),l.important=a(s(e),s(i))>a(s(n),s(r))?"horizontal":"vertical",o.using.call(this,t,l)}),u.offset(t.extend(I,{using:c}))})},t.ui.position={fit:{left:function(t,e){var i,n=e.within,o=n.isWindow?n.scrollLeft:n.offset.left,r=n.width,s=t.left-e.collisionPosition.marginLeft,l=o-s,c=s+e.collisionWidth-r-o;e.collisionWidth>r?l>0&&0>=c?(i=t.left+l+e.collisionWidth-r-o,t.left+=l-i):t.left=c>0&&0>=l?o:l>c?o+r-e.collisionWidth:o:l>0?t.left+=l:c>0?t.left-=c:t.left=a(t.left-s,t.left)},top:function(t,e){var i,n=e.within,o=n.isWindow?n.scrollTop:n.offset.top,r=e.within.height,s=t.top-e.collisionPosition.marginTop,l=o-s,c=s+e.collisionHeight-r-o;e.collisionHeight>r?l>0&&0>=c?(i=t.top+l+e.collisionHeight-r-o,t.top+=l-i):t.top=c>0&&0>=l?o:l>c?o+r-e.collisionHeight:o:l>0?t.top+=l:c>0?t.top-=c:t.top=a(t.top-s,t.top)}},flip:{left:function(t,e){var i,n,o=e.within,r=o.offset.left+o.scrollLeft,a=o.width,l=o.isWindow?o.scrollLeft:o.offset.left,c=t.left-e.collisionPosition.marginLeft,u=c-l,d=c+e.collisionWidth-a-l,h="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>u?(i=t.left+h+p+f+e.collisionWidth-a-r,(0>i||i<s(u))&&(t.left+=h+p+f)):d>0&&(n=t.left-e.collisionPosition.marginLeft+h+p+f-l,(n>0||s(n)<d)&&(t.left+=h+p+f))},top:function(t,e){var i,n,o=e.within,r=o.offset.top+o.scrollTop,a=o.height,l=o.isWindow?o.scrollTop:o.offset.top,c=t.top-e.collisionPosition.marginTop,u=c-l,d=c+e.collisionHeight-a-l,h="top"===e.my[1],p=h?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,m=-2*e.offset[1];0>u?(n=t.top+p+f+m+e.collisionHeight-a-r,(0>n||n<s(u))&&(t.top+=p+f+m)):d>0&&(i=t.top-e.collisionPosition.marginTop+p+f+m-l,(i>0||s(i)<d)&&(t.top+=p+f+m))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,n,o,a,s=document.getElementsByTagName("body")[0],l=document.createElement("div");e=document.createElement(s?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},s&&t.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(a in n)e.style[a]=n[a];e.appendChild(l),i=s||document.documentElement,i.insertBefore(e,i.firstChild),l.style.cssText="position: absolute; left: 10.7432222px;",o=t(l).offset().left,r=o>10&&11>o,e.innerHTML="",i.removeChild(e)}()}(),t.ui.position}),function(t,e){"object"==typeof exports&&exports?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):(Mustache={},e(Mustache))}(this,function(t){function e(t){return"function"==typeof t}function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function n(t,e){return f.call(t,e)}function o(t){return!n(m,t)}function r(t){return String(t).replace(/[&<>"'\/]/g,function(t){return g[t]})}function a(e,n){function r(){if(x&&!$)for(;g.length;)delete m[g.pop()];else g=[];x=!1,$=!1}function a(t){if("string"==typeof t&&(t=t.split(y,2)),!p(t)||2!==t.length)throw new Error("Invalid tags: "+t);u=new RegExp(i(t[0])+"\\s*"),d=new RegExp("\\s*"+i(t[1])),h=new RegExp("\\s*"+i("}"+t[1]))}if(!e)return[];var u,d,h,f=[],m=[],g=[],x=!1,$=!1;a(n||t.tags);for(var k,C,T,I,S,E,A=new c(e);!A.eos();){if(k=A.pos,T=A.scanUntil(u))for(var D=0,O=T.length;O>D;++D)I=T.charAt(D),o(I)?g.push(m.length):$=!0,m.push(["text",I,k,k+1]),k+=1,"\n"===I&&r();if(!A.scan(u))break;if(x=!0,C=A.scan(_)||"name",A.scan(v),"="===C?(T=A.scanUntil(w),A.scan(w),A.scanUntil(d)):"{"===C?(T=A.scanUntil(h),A.scan(b),A.scanUntil(d),C="&"):T=A.scanUntil(d),!A.scan(d))throw new Error("Unclosed tag at "+A.pos);if(S=[C,T,k,A.pos],m.push(S),"#"===C||"^"===C)f.push(S);else if("/"===C){if(E=f.pop(),!E)throw new Error('Unopened section "'+T+'" at '+k);if(E[1]!==T)throw new Error('Unclosed section "'+E[1]+'" at '+k)}else"name"===C||"{"===C||"&"===C?$=!0:"="===C&&a(T)}if(E=f.pop())throw new Error('Unclosed section "'+E[1]+'" at '+A.pos);return l(s(m))}function s(t){for(var e,i,n=[],o=0,r=t.length;r>o;++o)e=t[o],e&&("text"===e[0]&&i&&"text"===i[0]?(i[1]+=e[1],i[3]=e[3]):(n.push(e),i=e));return n}function l(t){for(var e,i,n=[],o=n,r=[],a=0,s=t.length;s>a;++a)switch(e=t[a],e[0]){case"#":case"^":o.push(e),r.push(e),o=e[4]=[];break;case"/":i=r.pop(),i[5]=e[2],o=r.length>0?r[r.length-1][4]:n;break;default:o.push(e)}return n}function c(t){this.string=t,this.tail=t,this.pos=0}function u(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function d(){this.cache={}}var h=Object.prototype.toString,p=Array.isArray||function(t){return"[object Array]"===h.call(t)},f=RegExp.prototype.test,m=/\S/,g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},v=/\s*/,y=/\s+/,w=/\s*=/,b=/\s*\}/,_=/#|\^|\/|>|\{|&|=|!/;c.prototype.eos=function(){return""===this.tail},c.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var i=e[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},c.prototype.scanUntil=function(t){var e,i=this.tail.search(t);switch(i){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=e.length,e},u.prototype.push=function(t){return new u(t,this)},u.prototype.lookup=function(t){var i,n=this.cache;if(n.hasOwnProperty(t))i=n[t];else{for(var o,r,a=this,s=!1;a;){if(t.indexOf(".")>0)for(i=a.view,o=t.split("."),r=0;null!=i&&r<o.length;)r===o.length-1&&null!=i&&(s="object"==typeof i&&i.hasOwnProperty(o[r])),i=i[o[r++]];else null!=a.view&&"object"==typeof a.view&&(i=a.view[t],s=a.view.hasOwnProperty(t));if(s)break;a=a.parent}n[t]=i}return e(i)&&(i=i.call(this.view)),i},d.prototype.clearCache=function(){this.cache={}},d.prototype.parse=function(t,e){var i=this.cache,n=i[t];return null==n&&(n=i[t]=a(t,e)),n},d.prototype.render=function(t,e,i){var n=this.parse(t),o=e instanceof u?e:new u(e);return this.renderTokens(n,o,i,t)},d.prototype.renderTokens=function(t,e,i,n){for(var o,r,a,s="",l=0,c=t.length;c>l;++l)a=void 0,o=t[l],r=o[0],"#"===r?a=this.renderSection(o,e,i,n):"^"===r?a=this.renderInverted(o,e,i,n):">"===r?a=this.renderPartial(o,e,i,n):"&"===r?a=this.unescapedValue(o,e):"name"===r?a=this.escapedValue(o,e):"text"===r&&(a=this.rawValue(o)),void 0!==a&&(s+=a);return s},d.prototype.renderSection=function(t,i,n,o){function r(t){return a.render(t,i,n)}var a=this,s="",l=i.lookup(t[1]);if(l){if(p(l))for(var c=0,u=l.length;u>c;++c)s+=this.renderTokens(t[4],i.push(l[c]),n,o);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)s+=this.renderTokens(t[4],i.push(l),n,o);else if(e(l)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");l=l.call(i.view,o.slice(t[3],t[5]),r),null!=l&&(s+=l)}else s+=this.renderTokens(t[4],i,n,o);return s}},d.prototype.renderInverted=function(t,e,i,n){var o=e.lookup(t[1]);return!o||p(o)&&0===o.length?this.renderTokens(t[4],e,i,n):void 0},d.prototype.renderPartial=function(t,i,n){if(n){var o=e(n)?n(t[1]):n[t[1]];return null!=o?this.renderTokens(this.parse(o),i,n,o):void 0}},d.prototype.unescapedValue=function(t,e){var i=e.lookup(t[1]);return null!=i?i:void 0},d.prototype.escapedValue=function(e,i){var n=i.lookup(e[1]);return null!=n?t.escape(n):void 0},d.prototype.rawValue=function(t){return t[1]},t.name="mustache.js",t.version="2.1.0",t.tags=["{{","}}"];var x=new d;t.clearCache=function(){return x.clearCache()},t.parse=function(t,e){return x.parse(t,e)},t.render=function(t,e,i){return x.render(t,e,i)},t.to_html=function(i,n,o,r){var a=t.render(i,n,o);return e(r)?void r(a):a},t.escape=r,t.Scanner=c,t.Context=u,t.Writer=d}),"function"!=typeof Object.create&&(Object.create=function(t){function e(){}return e.prototype=t,new e}),function(t,e,i){var n={init:function(e,i){var n=this;n.$elem=t(i),n.options=t.extend({},t.fn.owlCarousel.options,n.$elem.data(),e),n.userOptions=e,n.loadContent()},loadContent:function(){function e(t){var e,i="";if("function"==typeof n.options.jsonSuccess)n.options.jsonSuccess.apply(this,[t]);else{for(e in t.owl)t.owl.hasOwnProperty(e)&&(i+=t.owl[e].item);n.$elem.html(i)}n.logIn()}var i,n=this;"function"==typeof n.options.beforeInit&&n.options.beforeInit.apply(this,[n.$elem]),"string"==typeof n.options.jsonPath?(i=n.options.jsonPath,t.getJSON(i,e)):n.logIn()},logIn:function(){var t=this;t.$elem.data("owl-originalStyles",t.$elem.attr("style")),t.$elem.data("owl-originalClasses",t.$elem.attr("class")),t.$elem.css({opacity:0}),t.orignalItems=t.options.items,t.checkBrowser(),t.wrapperWidth=0,t.checkVisible=null,t.setVars()},setVars:function(){var t=this;return 0===t.$elem.children().length?!1:(t.baseClass(),t.eventTypes(),t.$userItems=t.$elem.children(),t.itemsAmount=t.$userItems.length,t.wrapItems(),t.$owlItems=t.$elem.find(".owl-item"),t.$owlWrapper=t.$elem.find(".owl-wrapper"),t.playDirection="next",t.prevItem=0,t.prevArr=[0],t.currentItem=0,t.customEvents(),void t.onStartup())},onStartup:function(){var t=this;t.updateItems(),t.calculateAll(),t.buildControls(),t.updateControls(),t.response(),t.moveEvents(),t.stopOnHover(),t.owlStatus(),t.options.transitionStyle!==!1&&t.transitionTypes(t.options.transitionStyle),t.options.autoPlay===!0&&(t.options.autoPlay=5e3),t.play(),t.$elem.find(".owl-wrapper").css("display","block"),t.$elem.is(":visible")?t.$elem.css("opacity",1):t.watchVisibility(),t.onstartup=!1,t.eachMoveUpdate(),"function"==typeof t.options.afterInit&&t.options.afterInit.apply(this,[t.$elem])},eachMoveUpdate:function(){var t=this;t.options.lazyLoad===!0&&t.lazyLoad(),t.options.autoHeight===!0&&t.autoHeight(),t.onVisibleItems(),"function"==typeof t.options.afterAction&&t.options.afterAction.apply(this,[t.$elem])},updateVars:function(){var t=this;"function"==typeof t.options.beforeUpdate&&t.options.beforeUpdate.apply(this,[t.$elem]),t.watchVisibility(),t.updateItems(),t.calculateAll(),t.updatePosition(),t.updateControls(),t.eachMoveUpdate(),"function"==typeof t.options.afterUpdate&&t.options.afterUpdate.apply(this,[t.$elem])},reload:function(){var t=this;e.setTimeout(function(){t.updateVars()},0)},watchVisibility:function(){var t=this;return t.$elem.is(":visible")!==!1?!1:(t.$elem.css({opacity:0}),e.clearInterval(t.autoPlayInterval),e.clearInterval(t.checkVisible),void(t.checkVisible=e.setInterval(function(){t.$elem.is(":visible")&&(t.reload(),t.$elem.animate({opacity:1},200),e.clearInterval(t.checkVisible))},500)))},wrapItems:function(){var t=this;t.$userItems.wrapAll('<div class="owl-wrapper">').wrap('<div class="owl-item"></div>'),t.$elem.find(".owl-wrapper").wrap('<div class="owl-wrapper-outer">'),t.wrapperOuter=t.$elem.find(".owl-wrapper-outer"),t.$elem.css("display","block")},baseClass:function(){var t=this,e=t.$elem.hasClass(t.options.baseClass),i=t.$elem.hasClass(t.options.theme);e||t.$elem.addClass(t.options.baseClass),i||t.$elem.addClass(t.options.theme)},updateItems:function(){var e,i,n=this;if(n.options.responsive===!1)return!1;if(n.options.singleItem===!0)return n.options.items=n.orignalItems=1,n.options.itemsCustom=!1,n.options.itemsDesktop=!1,n.options.itemsDesktopSmall=!1,n.options.itemsTablet=!1,n.options.itemsTabletSmall=!1,n.options.itemsMobile=!1,!1;if(e=t(n.options.responsiveBaseWidth).width(),e>(n.options.itemsDesktop[0]||n.orignalItems)&&(n.options.items=n.orignalItems),n.options.itemsCustom!==!1)for(n.options.itemsCustom.sort(function(t,e){return t[0]-e[0]}),i=0;i<n.options.itemsCustom.length;i+=1)n.options.itemsCustom[i][0]<=e&&(n.options.items=n.options.itemsCustom[i][1]);else e<=n.options.itemsDesktop[0]&&n.options.itemsDesktop!==!1&&(n.options.items=n.options.itemsDesktop[1]),e<=n.options.itemsDesktopSmall[0]&&n.options.itemsDesktopSmall!==!1&&(n.options.items=n.options.itemsDesktopSmall[1]),e<=n.options.itemsTablet[0]&&n.options.itemsTablet!==!1&&(n.options.items=n.options.itemsTablet[1]),e<=n.options.itemsTabletSmall[0]&&n.options.itemsTabletSmall!==!1&&(n.options.items=n.options.itemsTabletSmall[1]),e<=n.options.itemsMobile[0]&&n.options.itemsMobile!==!1&&(n.options.items=n.options.itemsMobile[1]);n.options.items>n.itemsAmount&&n.options.itemsScaleUp===!0&&(n.options.items=n.itemsAmount)},response:function(){var i,n,o=this;return o.options.responsive!==!0?!1:(n=t(e).width(),o.resizer=function(){t(e).width()!==n&&(o.options.autoPlay!==!1&&e.clearInterval(o.autoPlayInterval),e.clearTimeout(i),i=e.setTimeout(function(){n=t(e).width(),o.updateVars()},o.options.responsiveRefreshRate))},void t(e).resize(o.resizer))},updatePosition:function(){var t=this;t.jumpTo(t.currentItem),t.options.autoPlay!==!1&&t.checkAp()},appendItemsSizes:function(){var e=this,i=0,n=e.itemsAmount-e.options.items;e.$owlItems.each(function(o){var r=t(this);r.css({width:e.itemWidth}).data("owl-item",Number(o)),(o%e.options.items===0||o===n)&&(o>n||(i+=1)),r.data("owl-roundPages",i)})},appendWrapperSizes:function(){var t=this,e=t.$owlItems.length*t.itemWidth;t.$owlWrapper.css({width:2*e,left:0}),t.appendItemsSizes()},calculateAll:function(){var t=this;t.calculateWidth(),t.appendWrapperSizes(),t.loops(),t.max()},calculateWidth:function(){var t=this;t.itemWidth=Math.round(t.$elem.width()/t.options.items)},max:function(){var t=this,e=-1*(t.itemsAmount*t.itemWidth-t.options.items*t.itemWidth);return t.options.items>t.itemsAmount?(t.maximumItem=0,e=0,t.maximumPixels=0):(t.maximumItem=t.itemsAmount-t.options.items,t.maximumPixels=e),e},min:function(){return 0},loops:function(){var e,i,n,o=this,r=0,a=0;for(o.positionsInArray=[0],o.pagesInArray=[],e=0;e<o.itemsAmount;e+=1)a+=o.itemWidth,o.positionsInArray.push(-a),o.options.scrollPerPage===!0&&(i=t(o.$owlItems[e]),n=i.data("owl-roundPages"),n!==r&&(o.pagesInArray[r]=o.positionsInArray[e],r=n))},buildControls:function(){var e=this;(e.options.navigation===!0||e.options.pagination===!0)&&(e.owlControls=t('<div class="owl-controls"/>').toggleClass("clickable",!e.browser.isTouch).appendTo(e.$elem)),e.options.pagination===!0&&e.buildPagination(),e.options.navigation===!0&&e.buildButtons()},buildButtons:function(){var e=this,i=t('<div class="owl-buttons"/>');e.owlControls.append(i),e.buttonPrev=t("<div/>",{"class":"owl-prev",html:e.options.navigationText[0]||""}),e.buttonNext=t("<div/>",{"class":"owl-next",html:e.options.navigationText[1]||""}),i.append(e.buttonPrev).append(e.buttonNext),i.on("touchstart.owlControls mousedown.owlControls",'div[class^="owl"]',function(t){t.preventDefault()}),i.on("touchend.owlControls mouseup.owlControls",'div[class^="owl"]',function(i){i.preventDefault(),t(this).hasClass("owl-next")?e.next():e.prev()})},buildPagination:function(){var e=this;e.paginationWrapper=t('<div class="owl-pagination"/>'),e.owlControls.append(e.paginationWrapper),e.paginationWrapper.on("touchend.owlControls mouseup.owlControls",".owl-page",function(i){i.preventDefault(),Number(t(this).data("owl-page"))!==e.currentItem&&e.goTo(Number(t(this).data("owl-page")),!0)})},updatePagination:function(){var e,i,n,o,r,a,s=this;if(s.options.pagination===!1)return!1;for(s.paginationWrapper.html(""),e=0,i=s.itemsAmount-s.itemsAmount%s.options.items,o=0;o<s.itemsAmount;o+=1)o%s.options.items===0&&(e+=1,i===o&&(n=s.itemsAmount-s.options.items),r=t("<div/>",{"class":"owl-page"}),a=t("<span></span>",{text:s.options.paginationNumbers===!0?e:"","class":s.options.paginationNumbers===!0?"owl-numbers":""}),r.append(a),r.data("owl-page",i===o?n:o),r.data("owl-roundPages",e),s.paginationWrapper.append(r));s.checkPagination()},checkPagination:function(){var e=this;return e.options.pagination===!1?!1:void e.paginationWrapper.find(".owl-page").each(function(){t(this).data("owl-roundPages")===t(e.$owlItems[e.currentItem]).data("owl-roundPages")&&(e.paginationWrapper.find(".owl-page").removeClass("active"),t(this).addClass("active"))})},checkNavigation:function(){var t=this;return t.options.navigation===!1?!1:void(t.options.rewindNav===!1&&(0===t.currentItem&&0===t.maximumItem?(t.buttonPrev.addClass("disabled"),t.buttonNext.addClass("disabled")):0===t.currentItem&&0!==t.maximumItem?(t.buttonPrev.addClass("disabled"),t.buttonNext.removeClass("disabled")):t.currentItem===t.maximumItem?(t.buttonPrev.removeClass("disabled"),t.buttonNext.addClass("disabled")):0!==t.currentItem&&t.currentItem!==t.maximumItem&&(t.buttonPrev.removeClass("disabled"),t.buttonNext.removeClass("disabled"))))},updateControls:function(){var t=this;t.updatePagination(),t.checkNavigation(),t.owlControls&&(t.options.items>=t.itemsAmount?t.owlControls.hide():t.owlControls.show())},destroyControls:function(){var t=this;t.owlControls&&t.owlControls.remove()},next:function(t){var e=this;if(e.isTransition)return!1;if(e.currentItem+=e.options.scrollPerPage===!0?e.options.items:1,e.currentItem>e.maximumItem+(e.options.scrollPerPage===!0?e.options.items-1:0)){if(e.options.rewindNav!==!0)return e.currentItem=e.maximumItem,!1;e.currentItem=0,t="rewind"}e.goTo(e.currentItem,t)},prev:function(t){var e=this;if(e.isTransition)return!1;if(e.options.scrollPerPage===!0&&e.currentItem>0&&e.currentItem<e.options.items?e.currentItem=0:e.currentItem-=e.options.scrollPerPage===!0?e.options.items:1,e.currentItem<0){if(e.options.rewindNav!==!0)return e.currentItem=0,!1;e.currentItem=e.maximumItem,t="rewind"}e.goTo(e.currentItem,t)},goTo:function(t,i,n){var o,r=this;return r.isTransition?!1:("function"==typeof r.options.beforeMove&&r.options.beforeMove.apply(this,[r.$elem]),t>=r.maximumItem?t=r.maximumItem:0>=t&&(t=0),r.currentItem=r.owl.currentItem=t,r.options.transitionStyle!==!1&&"drag"!==n&&1===r.options.items&&r.browser.support3d===!0?(r.swapSpeed(0),r.browser.support3d===!0?r.transition3d(r.positionsInArray[t]):r.css2slide(r.positionsInArray[t],1),r.afterGo(),r.singleItemTransition(),!1):(o=r.positionsInArray[t],r.browser.support3d===!0?(r.isCss3Finish=!1,i===!0?(r.swapSpeed("paginationSpeed"),e.setTimeout(function(){r.isCss3Finish=!0},r.options.paginationSpeed)):"rewind"===i?(r.swapSpeed(r.options.rewindSpeed),e.setTimeout(function(){r.isCss3Finish=!0},r.options.rewindSpeed)):(r.swapSpeed("slideSpeed"),e.setTimeout(function(){r.isCss3Finish=!0},r.options.slideSpeed)),r.transition3d(o)):i===!0?r.css2slide(o,r.options.paginationSpeed):"rewind"===i?r.css2slide(o,r.options.rewindSpeed):r.css2slide(o,r.options.slideSpeed),void r.afterGo()))},jumpTo:function(t){var e=this;"function"==typeof e.options.beforeMove&&e.options.beforeMove.apply(this,[e.$elem]),t>=e.maximumItem||-1===t?t=e.maximumItem:0>=t&&(t=0),e.swapSpeed(0),e.browser.support3d===!0?e.transition3d(e.positionsInArray[t]):e.css2slide(e.positionsInArray[t],1),e.currentItem=e.owl.currentItem=t,e.afterGo()},afterGo:function(){var t=this;t.prevArr.push(t.currentItem),t.prevItem=t.owl.prevItem=t.prevArr[t.prevArr.length-2],t.prevArr.shift(0),t.prevItem!==t.currentItem&&(t.checkPagination(),t.checkNavigation(),t.eachMoveUpdate(),t.options.autoPlay!==!1&&t.checkAp()),"function"==typeof t.options.afterMove&&t.prevItem!==t.currentItem&&t.options.afterMove.apply(this,[t.$elem])},stop:function(){var t=this;t.apStatus="stop",e.clearInterval(t.autoPlayInterval)},checkAp:function(){var t=this;"stop"!==t.apStatus&&t.play()},play:function(){var t=this;return t.apStatus="play",t.options.autoPlay===!1?!1:(e.clearInterval(t.autoPlayInterval),void(t.autoPlayInterval=e.setInterval(function(){t.next(!0)},t.options.autoPlay)))},swapSpeed:function(t){var e=this;"slideSpeed"===t?e.$owlWrapper.css(e.addCssSpeed(e.options.slideSpeed)):"paginationSpeed"===t?e.$owlWrapper.css(e.addCssSpeed(e.options.paginationSpeed)):"string"!=typeof t&&e.$owlWrapper.css(e.addCssSpeed(t))},addCssSpeed:function(t){return{"-webkit-transition":"all "+t+"ms ease","-moz-transition":"all "+t+"ms ease","-o-transition":"all "+t+"ms ease",transition:"all "+t+"ms ease"}},removeTransition:function(){return{"-webkit-transition":"","-moz-transition":"","-o-transition":"",transition:""}},doTranslate:function(t){return{"-webkit-transform":"translate3d("+t+"px, 0px, 0px)","-moz-transform":"translate3d("+t+"px, 0px, 0px)","-o-transform":"translate3d("+t+"px, 0px, 0px)","-ms-transform":"translate3d("+t+"px, 0px, 0px)",transform:"translate3d("+t+"px, 0px,0px)"}},transition3d:function(t){var e=this;e.$owlWrapper.css(e.doTranslate(t))},css2move:function(t){var e=this;e.$owlWrapper.css({left:t})},css2slide:function(t,e){var i=this;i.isCssFinish=!1,i.$owlWrapper.stop(!0,!0).animate({left:t},{duration:e||i.options.slideSpeed,complete:function(){i.isCssFinish=!0}})},checkBrowser:function(){var t,n,o,r,a=this,s="translate3d(0px, 0px, 0px)",l=i.createElement("div");l.style.cssText="  -moz-transform:"+s+"; -ms-transform:"+s+"; -o-transform:"+s+"; -webkit-transform:"+s+"; transform:"+s,t=/translate3d\(0px, 0px, 0px\)/g,n=l.style.cssText.match(t),o=null!==n&&1===n.length,r="ontouchstart"in e||e.navigator.msMaxTouchPoints,a.browser={support3d:o,isTouch:r}},moveEvents:function(){var t=this;(t.options.mouseDrag!==!1||t.options.touchDrag!==!1)&&(t.gestures(),t.disabledEvents())},eventTypes:function(){var t=this,e=["s","e","x"];t.ev_types={},t.options.mouseDrag===!0&&t.options.touchDrag===!0?e=["touchstart.owl mousedown.owl","touchmove.owl mousemove.owl","touchend.owl touchcancel.owl mouseup.owl"]:t.options.mouseDrag===!1&&t.options.touchDrag===!0?e=["touchstart.owl","touchmove.owl","touchend.owl touchcancel.owl"]:t.options.mouseDrag===!0&&t.options.touchDrag===!1&&(e=["mousedown.owl","mousemove.owl","mouseup.owl"]),
t.ev_types.start=e[0],t.ev_types.move=e[1],t.ev_types.end=e[2]},disabledEvents:function(){var e=this;e.$elem.on("dragstart.owl",function(t){t.preventDefault()}),e.$elem.on("mousedown.disableTextSelect",function(e){return t(e.target).is("input, textarea, select, option")})},gestures:function(){function n(t){if(void 0!==t.touches)return{x:t.touches[0].pageX,y:t.touches[0].pageY};if(void 0===t.touches){if(void 0!==t.pageX)return{x:t.pageX,y:t.pageY};if(void 0===t.pageX)return{x:t.clientX,y:t.clientY}}}function o(e){"on"===e?(t(i).on(l.ev_types.move,a),t(i).on(l.ev_types.end,s)):"off"===e&&(t(i).off(l.ev_types.move),t(i).off(l.ev_types.end))}function r(i){var r,a=i.originalEvent||i||e.event;if(3===a.which)return!1;if(!(l.itemsAmount<=l.options.items)){if(l.isCssFinish===!1&&!l.options.dragBeforeAnimFinish)return!1;if(l.isCss3Finish===!1&&!l.options.dragBeforeAnimFinish)return!1;l.options.autoPlay!==!1&&e.clearInterval(l.autoPlayInterval),l.browser.isTouch===!0||l.$owlWrapper.hasClass("grabbing")||l.$owlWrapper.addClass("grabbing"),l.newPosX=0,l.newRelativeX=0,t(this).css(l.removeTransition()),r=t(this).position(),c.relativePos=r.left,c.offsetX=n(a).x-r.left,c.offsetY=n(a).y-r.top,o("on"),c.sliding=!1,c.targetElement=a.target||a.srcElement}}function a(o){var r,a,s=o.originalEvent||o||e.event;l.newPosX=n(s).x-c.offsetX,l.newPosY=n(s).y-c.offsetY,l.newRelativeX=l.newPosX-c.relativePos,"function"==typeof l.options.startDragging&&c.dragging!==!0&&0!==l.newRelativeX&&(c.dragging=!0,l.options.startDragging.apply(l,[l.$elem])),(l.newRelativeX>8||l.newRelativeX<-8)&&l.browser.isTouch===!0&&(void 0!==s.preventDefault?s.preventDefault():s.returnValue=!1,c.sliding=!0),(l.newPosY>10||l.newPosY<-10)&&c.sliding===!1&&t(i).off("touchmove.owl"),r=function(){return l.newRelativeX/5},a=function(){return l.maximumPixels+l.newRelativeX/5},l.newPosX=Math.max(Math.min(l.newPosX,r()),a()),l.browser.support3d===!0?l.transition3d(l.newPosX):l.css2move(l.newPosX)}function s(i){var n,r,a,s=i.originalEvent||i||e.event;s.target=s.target||s.srcElement,c.dragging=!1,l.browser.isTouch!==!0&&l.$owlWrapper.removeClass("grabbing"),l.dragDirection=l.owl.dragDirection=l.newRelativeX<0?"left":"right",0!==l.newRelativeX&&(n=l.getNewPosition(),l.goTo(n,!1,"drag"),c.targetElement===s.target&&l.browser.isTouch!==!0&&(t(s.target).on("click.disable",function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t(e.target).off("click.disable")}),r=t._data(s.target,"events").click,a=r.pop(),r.splice(0,0,a))),o("off")}var l=this,c={offsetX:0,offsetY:0,baseElWidth:0,relativePos:0,position:null,minSwipe:null,maxSwipe:null,sliding:null,dargging:null,targetElement:null};l.isCssFinish=!0,l.$elem.on(l.ev_types.start,".owl-wrapper",r)},getNewPosition:function(){var t=this,e=t.closestItem();return e>t.maximumItem?(t.currentItem=t.maximumItem,e=t.maximumItem):t.newPosX>=0&&(e=0,t.currentItem=0),e},closestItem:function(){var e=this,i=e.options.scrollPerPage===!0?e.pagesInArray:e.positionsInArray,n=e.newPosX,o=null;return t.each(i,function(r,a){n-e.itemWidth/20>i[r+1]&&n-e.itemWidth/20<a&&"left"===e.moveDirection()?(o=a,e.currentItem=e.options.scrollPerPage===!0?t.inArray(o,e.positionsInArray):r):n+e.itemWidth/20<a&&n+e.itemWidth/20>(i[r+1]||i[r]-e.itemWidth)&&"right"===e.moveDirection()&&(e.options.scrollPerPage===!0?(o=i[r+1]||i[i.length-1],e.currentItem=t.inArray(o,e.positionsInArray)):(o=i[r+1],e.currentItem=r+1))}),e.currentItem},moveDirection:function(){var t,e=this;return e.newRelativeX<0?(t="right",e.playDirection="next"):(t="left",e.playDirection="prev"),t},customEvents:function(){var t=this;t.$elem.on("owl.next",function(){t.next()}),t.$elem.on("owl.prev",function(){t.prev()}),t.$elem.on("owl.play",function(e,i){t.options.autoPlay=i,t.play(),t.hoverStatus="play"}),t.$elem.on("owl.stop",function(){t.stop(),t.hoverStatus="stop"}),t.$elem.on("owl.goTo",function(e,i){t.goTo(i)}),t.$elem.on("owl.jumpTo",function(e,i){t.jumpTo(i)})},stopOnHover:function(){var t=this;t.options.stopOnHover===!0&&t.browser.isTouch!==!0&&t.options.autoPlay!==!1&&(t.$elem.on("mouseover",function(){t.stop()}),t.$elem.on("mouseout",function(){"stop"!==t.hoverStatus&&t.play()}))},lazyLoad:function(){var e,i,n,o,r,a=this;if(a.options.lazyLoad===!1)return!1;for(e=0;e<a.itemsAmount;e+=1)i=t(a.$owlItems[e]),"loaded"!==i.data("owl-loaded")&&(n=i.data("owl-item"),o=i.find(".lazyOwl"),"string"==typeof o.data("src")?(void 0===i.data("owl-loaded")&&(o.hide(),i.addClass("loading").data("owl-loaded","checked")),r=a.options.lazyFollow===!0?n>=a.currentItem:!0,r&&n<a.currentItem+a.options.items&&o.length&&a.lazyPreload(i,o)):i.data("owl-loaded","loaded"))},lazyPreload:function(t,i){function n(){t.data("owl-loaded","loaded").removeClass("loading"),i.removeAttr("data-src"),"fade"===a.options.lazyEffect?i.fadeIn(400):i.show(),"function"==typeof a.options.afterLazyLoad&&a.options.afterLazyLoad.apply(this,[a.$elem])}function o(){s+=1,a.completeImg(i.get(0))||r===!0?n():100>=s?e.setTimeout(o,100):n()}var r,a=this,s=0;"DIV"===i.prop("tagName")?(i.css("background-image","url("+i.data("src")+")"),r=!0):i[0].src=i.data("src"),o()},autoHeight:function(){function i(){var i=t(r.$owlItems[r.currentItem]).height();r.wrapperOuter.css("height",i+"px"),r.wrapperOuter.hasClass("autoHeight")||e.setTimeout(function(){r.wrapperOuter.addClass("autoHeight")},0)}function n(){o+=1,r.completeImg(a.get(0))?i():100>=o?e.setTimeout(n,100):r.wrapperOuter.css("height","")}var o,r=this,a=t(r.$owlItems[r.currentItem]).find("img");void 0!==a.get(0)?(o=0,n()):i()},completeImg:function(t){var e;return t.complete?(e=typeof t.naturalWidth,"undefined"!==e&&0===t.naturalWidth?!1:!0):!1},onVisibleItems:function(){var e,i=this;for(i.options.addClassActive===!0&&i.$owlItems.removeClass("active"),i.visibleItems=[],e=i.currentItem;e<i.currentItem+i.options.items;e+=1)i.visibleItems.push(e),i.options.addClassActive===!0&&t(i.$owlItems[e]).addClass("active");i.owl.visibleItems=i.visibleItems},transitionTypes:function(t){var e=this;e.outClass="owl-"+t+"-out",e.inClass="owl-"+t+"-in"},singleItemTransition:function(){function t(t){return{position:"relative",left:t+"px"}}var e=this,i=e.outClass,n=e.inClass,o=e.$owlItems.eq(e.currentItem),r=e.$owlItems.eq(e.prevItem),a=Math.abs(e.positionsInArray[e.currentItem])+e.positionsInArray[e.prevItem],s=Math.abs(e.positionsInArray[e.currentItem])+e.itemWidth/2,l="webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend";e.isTransition=!0,e.$owlWrapper.addClass("owl-origin").css({"-webkit-transform-origin":s+"px","-moz-perspective-origin":s+"px","perspective-origin":s+"px"}),r.css(t(a,10)).addClass(i).on(l,function(){e.endPrev=!0,r.off(l),e.clearTransStyle(r,i)}),o.addClass(n).on(l,function(){e.endCurrent=!0,o.off(l),e.clearTransStyle(o,n)})},clearTransStyle:function(t,e){var i=this;t.css({position:"",left:""}).removeClass(e),i.endPrev&&i.endCurrent&&(i.$owlWrapper.removeClass("owl-origin"),i.endPrev=!1,i.endCurrent=!1,i.isTransition=!1)},owlStatus:function(){var t=this;t.owl={userOptions:t.userOptions,baseElement:t.$elem,userItems:t.$userItems,owlItems:t.$owlItems,currentItem:t.currentItem,prevItem:t.prevItem,visibleItems:t.visibleItems,isTouch:t.browser.isTouch,browser:t.browser,dragDirection:t.dragDirection}},clearEvents:function(){var n=this;n.$elem.off(".owl owl mousedown.disableTextSelect"),t(i).off(".owl owl"),t(e).off("resize",n.resizer)},unWrap:function(){var t=this;0!==t.$elem.children().length&&(t.$owlWrapper.unwrap(),t.$userItems.unwrap().unwrap(),t.owlControls&&t.owlControls.remove()),t.clearEvents(),t.$elem.attr("style",t.$elem.data("owl-originalStyles")||"").attr("class",t.$elem.data("owl-originalClasses"))},destroy:function(){var t=this;t.stop(),e.clearInterval(t.checkVisible),t.unWrap(),t.$elem.removeData()},reinit:function(e){var i=this,n=t.extend({},i.userOptions,e);i.unWrap(),i.init(n,i.$elem)},addItem:function(t,e){var i,n=this;return t?0===n.$elem.children().length?(n.$elem.append(t),n.setVars(),!1):(n.unWrap(),i=void 0===e||-1===e?-1:e,i>=n.$userItems.length||-1===i?n.$userItems.eq(-1).after(t):n.$userItems.eq(i).before(t),void n.setVars()):!1},removeItem:function(t){var e,i=this;return 0===i.$elem.children().length?!1:(e=void 0===t||-1===t?-1:t,i.unWrap(),i.$userItems.eq(e).remove(),void i.setVars())}};t.fn.owlCarousel=function(e){return this.each(function(){if(t(this).data("owl-init")===!0)return!1;t(this).data("owl-init",!0);var i=Object.create(n);i.init(e,this),t.data(this,"owlCarousel",i)})},t.fn.owlCarousel.options={items:5,itemsCustom:!1,itemsDesktop:[1199,4],itemsDesktopSmall:[979,3],itemsTablet:[768,2],itemsTabletSmall:!1,itemsMobile:[479,1],singleItem:!1,itemsScaleUp:!1,slideSpeed:200,paginationSpeed:800,rewindSpeed:1e3,autoPlay:!1,stopOnHover:!1,navigation:!1,navigationText:["prev","next"],rewindNav:!0,scrollPerPage:!1,pagination:!0,paginationNumbers:!1,responsive:!0,responsiveRefreshRate:200,responsiveBaseWidth:e,baseClass:"owl-carousel",theme:"owl-theme",lazyLoad:!1,lazyFollow:!0,lazyEffect:"fade",autoHeight:!1,jsonPath:!1,jsonSuccess:!1,dragBeforeAnimFinish:!0,mouseDrag:!0,touchDrag:!0,addClassActive:!1,transitionStyle:!1,beforeUpdate:!1,afterUpdate:!1,beforeInit:!1,afterInit:!1,beforeMove:!1,afterMove:!1,afterAction:!1,startDragging:!1,afterLazyLoad:!1}}(jQuery,window,document),function(t){function e(t,e,i,n,o){this._listener=e,this._isOnce=i,this.context=n,this._signal=t,this._priority=o||0}function i(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))}function n(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){n.prototype.dispatch.apply(t,arguments)}}e.prototype={active:!0,params:null,execute:function(t){var e,i;return this.active&&this._listener&&(i=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,i),this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},n.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(t,i,n,o){var r,a=this._indexOfListener(t,n);if(-1!==a){if(r=this._bindings[a],r.isOnce()!==i)throw new Error("You cannot add"+(i?"":"Once")+"() then add"+(i?"Once":"")+"() the same listener without removing the relationship first.")}else r=new e(this,t,i,n,o),this._addBinding(r);return this.memorize&&this._prevParams&&r.execute(this._prevParams),r},_addBinding:function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t._priority<=this._bindings[e]._priority);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){for(var i,n=this._bindings.length;n--;)if(i=this._bindings[n],i._listener===t&&i.context===e)return n;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,n){return i(t,"add"),this._registerListener(t,!1,e,n)},addOnce:function(t,e,n){return i(t,"addOnce"),this._registerListener(t,!0,e,n)},remove:function(t,e){i(t,"remove");var n=this._indexOfListener(t,e);return-1!==n&&(this._bindings[n]._destroy(),this._bindings.splice(n,1)),t},removeAll:function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(t){if(this.active){var e,i=Array.prototype.slice.call(arguments),n=this._bindings.length;if(this.memorize&&(this._prevParams=i),n){e=this._bindings.slice(),this._shouldPropagate=!0;do n--;while(e[n]&&this._shouldPropagate&&e[n].execute(i)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var o=n;o.Signal=n,"function"==typeof define&&define.amd?define(function(){return o}):"undefined"!=typeof module&&module.exports?module.exports=o:t.signals=o}(this),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e),r=n.data("bs.validator");(r||"destroy"!=e)&&(r||n.data("bs.validator",r=new i(this,o)),"string"==typeof e&&r[e]())})}var i=function(e,n){this.$element=t(e),this.options=n,n.errors=t.extend({},i.DEFAULTS.errors,n.errors);for(var o in n.custom)if(!n.errors[o])throw new Error("Missing default error message for custom validator: "+o);t.extend(i.VALIDATORS,n.custom),this.$element.attr("novalidate",!0),this.toggleSubmit(),this.$element.on("input.bs.validator change.bs.validator focusout.bs.validator",t.proxy(this.validateInput,this)),this.$element.on("submit.bs.validator",t.proxy(this.onSubmit,this)),this.$element.find("[data-match]").each(function(){var e=t(this),i=e.data("match");t(i).on("input.bs.validator",function(t){e.val()&&e.trigger("input.bs.validator")})})};i.INPUT_SELECTOR=':input:not([type="submit"], button):enabled:visible',i.DEFAULTS={delay:500,html:!1,disable:!0,custom:{},errors:{match:"Does not match",minlength:"Not long enough"},feedback:{success:"glyphicon-ok",error:"glyphicon-remove"}},i.VALIDATORS={"native":function(t){var e=t[0];return e.checkValidity?e.checkValidity():!0},match:function(e){var i=e.data("match");return!e.val()||e.val()===t(i).val()},minlength:function(t){var e=t.data("minlength");return!t.val()||t.val().length>=e}},i.prototype.validateInput=function(e){var i=t(e.target),n=i.data("bs.validator.errors");if(i.is('[type="radio"]')&&(i=this.$element.find('input[name="'+i.attr("name")+'"]')),this.$element.trigger(e=t.Event("validate.bs.validator",{relatedTarget:i[0]})),!e.isDefaultPrevented()){var o=this;this.runValidators(i).done(function(r){i.data("bs.validator.errors",r),r.length?o.showErrors(i):o.clearErrors(i),n&&r.toString()===n.toString()||(e=r.length?t.Event("invalid.bs.validator",{relatedTarget:i[0],detail:r}):t.Event("valid.bs.validator",{relatedTarget:i[0],detail:n}),o.$element.trigger(e)),o.toggleSubmit(),o.$element.trigger(t.Event("validated.bs.validator",{relatedTarget:i[0]}))})}},i.prototype.runValidators=function(e){function n(t){return e.data(t+"-error")||e.data("error")||"native"==t&&e[0].validationMessage||a.errors[t]}var o=[],r=t.Deferred(),a=this.options;return e.data("bs.validator.deferred")&&e.data("bs.validator.deferred").reject(),e.data("bs.validator.deferred",r),t.each(i.VALIDATORS,t.proxy(function(t,i){if((e.data(t)||"native"==t)&&!i.call(this,e)){var r=n(t);!~o.indexOf(r)&&o.push(r)}},this)),!o.length&&e.val()&&e.data("remote")?this.defer(e,function(){var i={};i[e.attr("name")]=e.val(),t.get(e.data("remote"),i).fail(function(t,e,i){o.push(n("remote")||i)}).always(function(){r.resolve(o)})}):r.resolve(o),r.promise()},i.prototype.validate=function(){var t=this.options.delay;return this.options.delay=0,this.$element.find(i.INPUT_SELECTOR).trigger("input.bs.validator"),this.options.delay=t,this},i.prototype.showErrors=function(e){var i=this.options.html?"html":"text";this.defer(e,function(){var n=e.closest(".form-group"),o=n.find(".help-block.with-errors"),r=n.find(".form-control-feedback"),a=e.data("bs.validator.errors");a.length&&(a=t("<ul/>").addClass("list-unstyled").append(t.map(a,function(e){return t("<li/>")[i](e)})),void 0===o.data("bs.validator.originalContent")&&o.data("bs.validator.originalContent",o.html()),o.empty().append(a),n.addClass("has-error"),r.length&&r.removeClass(this.options.feedback.success)&&r.addClass(this.options.feedback.error)&&n.removeClass("has-success"))})},i.prototype.clearErrors=function(t){var e=t.closest(".form-group"),i=e.find(".help-block.with-errors"),n=e.find(".form-control-feedback");i.html(i.data("bs.validator.originalContent")),e.removeClass("has-error"),n.length&&n.removeClass(this.options.feedback.error)&&n.addClass(this.options.feedback.success)&&e.addClass("has-success")},i.prototype.hasErrors=function(){function e(){return!!(t(this).data("bs.validator.errors")||[]).length}return!!this.$element.find(i.INPUT_SELECTOR).filter(e).length},i.prototype.isIncomplete=function(){function e(){return"checkbox"===this.type?!this.checked:"radio"===this.type?!t('[name="'+this.name+'"]:checked').length:""===t.trim(this.value)}return!!this.$element.find(i.INPUT_SELECTOR).filter("[required]").filter(e).length},i.prototype.onSubmit=function(t){this.validate(),(this.isIncomplete()||this.hasErrors())&&t.preventDefault()},i.prototype.toggleSubmit=function(){if(this.options.disable){var e=t('button[type="submit"], input[type="submit"]').filter('[form="'+this.$element.attr("id")+'"]').add(this.$element.find('input[type="submit"], button[type="submit"]'));e.toggleClass("disabled",this.isIncomplete()||this.hasErrors())}},i.prototype.defer=function(e,i){return i=t.proxy(i,this),this.options.delay?(window.clearTimeout(e.data("bs.validator.timeout")),void e.data("bs.validator.timeout",window.setTimeout(i,this.options.delay))):i()},i.prototype.destroy=function(){return this.$element.removeAttr("novalidate").removeData("bs.validator").off(".bs.validator"),this.$element.find(i.INPUT_SELECTOR).off(".bs.validator").removeData(["bs.validator.errors","bs.validator.deferred"]).each(function(){var e=t(this),i=e.data("bs.validator.timeout");window.clearTimeout(i)&&e.removeData("bs.validator.timeout")}),this.$element.find(".help-block.with-errors").each(function(){var e=t(this),i=e.data("bs.validator.originalContent");e.removeData("bs.validator.originalContent").html(i)}),this.$element.find('input[type="submit"], button[type="submit"]').removeClass("disabled"),this.$element.find(".has-error").removeClass("has-error"),this};var n=t.fn.validator;t.fn.validator=e,t.fn.validator.Constructor=i,t.fn.validator.noConflict=function(){return t.fn.validator=n,this},t(window).on("load",function(){t('form[data-toggle="validator"]').each(function(){var i=t(this);e.call(i,i.data())})})}(jQuery),function(t,e){"use strict";function i(i){if("undefined"==typeof i)throw new Error('Pathformer [constructor]: "element" parameter is required');if(i.constructor===String&&(i=e.getElementById(i),!i))throw new Error('Pathformer [constructor]: "element" parameter is not related to an existing ID');if(!(i.constructor instanceof t.SVGElement||/^svg$/i.test(i.nodeName)))throw new Error('Pathformer [constructor]: "element" parameter must be a string or a SVGelement');this.el=i,this.scan(i)}function n(t,e,i){this.isReady=!1,this.setElement(t,e),this.setOptions(e),this.setCallback(i),this.isReady&&this.init()}i.prototype.TYPES=["line","ellipse","circle","polygon","polyline","rect"],i.prototype.ATTR_WATCH=["cx","cy","points","r","rx","ry","x","x1","x2","y","y1","y2"],i.prototype.scan=function(t){for(var e,i,n,o,r=t.querySelectorAll(this.TYPES.join(",")),a=0;a<r.length;a++)i=r[a],e=this[i.tagName.toLowerCase()+"ToPath"],n=e(this.parseAttr(i.attributes)),o=this.pathMaker(i,n),i.parentNode.replaceChild(o,i)},i.prototype.lineToPath=function(t){var e={};return e.d="M"+t.x1+","+t.y1+"L"+t.x2+","+t.y2,e},i.prototype.rectToPath=function(t){var e={},i=parseFloat(t.x)||0,n=parseFloat(t.y)||0,o=parseFloat(t.width)||0,r=parseFloat(t.height)||0;return e.d="M"+i+" "+n+" ",e.d+="L"+(i+o)+" "+n+" ",e.d+="L"+(i+o)+" "+(n+r)+" ",e.d+="L"+i+" "+(n+r)+" Z",e},i.prototype.polylineToPath=function(t){var e,i,n={},o=t.points.trim().split(" ");if(-1===t.points.indexOf(",")){var r=[];for(e=0;e<o.length;e+=2)r.push(o[e]+","+o[e+1]);o=r}for(i="M"+o[0],e=1;e<o.length;e++)-1!==o[e].indexOf(",")&&(i+="L"+o[e]);return n.d=i,n},i.prototype.polygonToPath=function(t){var e=i.prototype.polylineToPath(t);return e.d+="Z",e},i.prototype.ellipseToPath=function(t){var e=t.cx-t.rx,i=t.cy,n=parseFloat(t.cx)+parseFloat(t.rx),o=t.cy,r={};return r.d="M"+e+","+i+"A"+t.rx+","+t.ry+" 0,1,1 "+n+","+o+"A"+t.rx+","+t.ry+" 0,1,1 "+e+","+o,r},i.prototype.circleToPath=function(t){var e={},i=t.cx-t.r,n=t.cy,o=parseFloat(t.cx)+parseFloat(t.r),r=t.cy;return e.d="M"+i+","+n+"A"+t.r+","+t.r+" 0,1,1 "+o+","+r+"A"+t.r+","+t.r+" 0,1,1 "+i+","+r,e},i.prototype.pathMaker=function(t,i){var n,o,r=e.createElementNS("http://www.w3.org/2000/svg","path");for(n=0;n<t.attributes.length;n++)o=t.attributes[n],-1===this.ATTR_WATCH.indexOf(o.name)&&r.setAttribute(o.name,o.value);for(n in i)r.setAttribute(n,i[n]);return r},i.prototype.parseAttr=function(t){for(var e,i={},n=0;n<t.length;n++){if(e=t[n],-1!==this.ATTR_WATCH.indexOf(e.name)&&-1!==e.value.indexOf("%"))throw new Error("Pathformer [parseAttr]: a SVG shape got values in percentage. This cannot be transformed into 'path' tags. Please use 'viewBox'.");i[e.name]=e.value}return i};var o,r,a;n.LINEAR=function(t){return t},n.EASE=function(t){return-Math.cos(t*Math.PI)/2+.5},n.EASE_OUT=function(t){return 1-Math.pow(1-t,3)},n.EASE_IN=function(t){return Math.pow(t,3)},n.EASE_OUT_BOUNCE=function(t){var e=-Math.cos(.5*t*Math.PI)+1,i=Math.pow(e,1.5),n=Math.pow(1-t,2),o=-Math.abs(Math.cos(2.5*i*Math.PI))+1;return 1-n+o*n},n.prototype.setElement=function(i,n){if("undefined"==typeof i)throw new Error('Vivus [constructor]: "element" parameter is required');if(i.constructor===String&&(i=e.getElementById(i),!i))throw new Error('Vivus [constructor]: "element" parameter is not related to an existing ID');if(this.parentEl=i,n&&n.file){var o=e.createElement("object");o.setAttribute("type","image/svg+xml"),o.setAttribute("data",n.file),o.setAttribute("built-by-vivus","true"),i.appendChild(o),i=o}switch(i.constructor){case t.SVGSVGElement:case t.SVGElement:this.el=i,this.isReady=!0;break;case t.HTMLObjectElement:var r,a;a=this,r=function(t){if(!a.isReady){if(a.el=i.contentDocument&&i.contentDocument.querySelector("svg"),!a.el&&t)throw new Error("Vivus [constructor]: object loaded does not contain any SVG");return a.el?(i.getAttribute("built-by-vivus")&&(a.parentEl.insertBefore(a.el,i),a.parentEl.removeChild(i),a.el.setAttribute("width","100%"),a.el.setAttribute("height","100%")),a.isReady=!0,a.init(),!0):void 0}},r()||i.addEventListener("load",r);break;default:throw new Error('Vivus [constructor]: "element" parameter is not valid (or miss the "file" attribute)')}},n.prototype.setOptions=function(e){var i=["delayed","async","oneByOne","scenario","scenario-sync"],o=["inViewport","manual","autostart"];if(void 0!==e&&e.constructor!==Object)throw new Error('Vivus [constructor]: "options" parameter must be an object');if(e=e||{},e.type&&-1===i.indexOf(e.type))throw new Error("Vivus [constructor]: "+e.type+" is not an existing animation `type`");if(this.type=e.type||i[0],e.start&&-1===o.indexOf(e.start))throw new Error("Vivus [constructor]: "+e.start+" is not an existing `start` option");if(this.start=e.start||o[0],this.isIE=-1!==t.navigator.userAgent.indexOf("MSIE")||-1!==t.navigator.userAgent.indexOf("Trident/")||-1!==t.navigator.userAgent.indexOf("Edge/"),this.duration=a(e.duration,120),this.delay=a(e.delay,null),this.dashGap=a(e.dashGap,1),this.forceRender=e.hasOwnProperty("forceRender")?!!e.forceRender:this.isIE,this.selfDestroy=!!e.selfDestroy,this.onReady=e.onReady,this.frameLength=this.currentFrame=this.map=this.delayUnit=this.speed=this.handle=null,this.ignoreInvisible=e.hasOwnProperty("ignoreInvisible")?!!e.ignoreInvisible:!1,this.animTimingFunction=e.animTimingFunction||n.LINEAR,this.pathTimingFunction=e.pathTimingFunction||n.LINEAR,this.delay>=this.duration)throw new Error("Vivus [constructor]: delay must be shorter than duration")},n.prototype.setCallback=function(t){if(t&&t.constructor!==Function)throw new Error('Vivus [constructor]: "callback" parameter must be a function');this.callback=t||function(){}},n.prototype.mapping=function(){var e,i,n,o,r,s,l,c;for(c=s=l=0,i=this.el.querySelectorAll("path"),e=0;e<i.length;e++)n=i[e],this.isInvisible(n)||(r={el:n,length:Math.ceil(n.getTotalLength())},isNaN(r.length)?t.console&&console.warn&&console.warn("Vivus [mapping]: cannot retrieve a path element length",n):(this.map.push(r),n.style.strokeDasharray=r.length+" "+(r.length+2*this.dashGap),n.style.strokeDashoffset=r.length+this.dashGap,r.length+=this.dashGap,s+=r.length,this.renderPath(e)));for(s=0===s?1:s,this.delay=null===this.delay?this.duration/3:this.delay,this.delayUnit=this.delay/(i.length>1?i.length-1:1),e=0;e<this.map.length;e++){switch(r=this.map[e],this.type){case"delayed":r.startAt=this.delayUnit*e,r.duration=this.duration-this.delay;break;case"oneByOne":r.startAt=l/s*this.duration,r.duration=r.length/s*this.duration;break;case"async":r.startAt=0,r.duration=this.duration;break;case"scenario-sync":n=i[e],o=this.parseAttr(n),r.startAt=c+(a(o["data-delay"],this.delayUnit)||0),r.duration=a(o["data-duration"],this.duration),c=void 0!==o["data-async"]?r.startAt:r.startAt+r.duration,this.frameLength=Math.max(this.frameLength,r.startAt+r.duration);break;case"scenario":n=i[e],o=this.parseAttr(n),r.startAt=a(o["data-start"],this.delayUnit)||0,r.duration=a(o["data-duration"],this.duration),this.frameLength=Math.max(this.frameLength,r.startAt+r.duration)}l+=r.length,this.frameLength=this.frameLength||this.duration}},n.prototype.drawer=function(){var t=this;this.currentFrame+=this.speed,this.currentFrame<=0?(this.stop(),this.reset(),this.callback(this)):this.currentFrame>=this.frameLength?(this.stop(),this.currentFrame=this.frameLength,this.trace(),this.selfDestroy&&this.destroy(),this.callback(this)):(this.trace(),this.handle=o(function(){t.drawer()}))},n.prototype.trace=function(){var t,e,i,n;for(n=this.animTimingFunction(this.currentFrame/this.frameLength)*this.frameLength,t=0;t<this.map.length;t++)i=this.map[t],e=(n-i.startAt)/i.duration,e=this.pathTimingFunction(Math.max(0,Math.min(1,e))),i.progress!==e&&(i.progress=e,i.el.style.strokeDashoffset=Math.floor(i.length*(1-e)),this.renderPath(t))},n.prototype.renderPath=function(t){if(this.forceRender&&this.map&&this.map[t]){var e=this.map[t],i=e.el.cloneNode(!0);e.el.parentNode.replaceChild(i,e.el),e.el=i}},n.prototype.init=function(){this.frameLength=0,this.currentFrame=0,this.map=[],new i(this.el),this.mapping(),this.starter(),this.onReady&&this.onReady(this)},n.prototype.starter=function(){switch(this.start){case"manual":return;case"autostart":this.play();break;case"inViewport":var e=this,i=function(){e.isInViewport(e.parentEl,1)&&(e.play(),t.removeEventListener("scroll",i))};t.addEventListener("scroll",i),i()}},n.prototype.getStatus=function(){return 0===this.currentFrame?"start":this.currentFrame===this.frameLength?"end":"progress"},n.prototype.reset=function(){return this.setFrameProgress(0)},n.prototype.finish=function(){return this.setFrameProgress(1)},n.prototype.setFrameProgress=function(t){return t=Math.min(1,Math.max(0,t)),this.currentFrame=Math.round(this.frameLength*t),this.trace(),this},n.prototype.play=function(t){if(t&&"number"!=typeof t)throw new Error("Vivus [play]: invalid speed");return this.speed=t||1,this.handle||this.drawer(),this},n.prototype.stop=function(){return this.handle&&(r(this.handle),this.handle=null),this},n.prototype.destroy=function(){var t,e;for(t=0;t<this.map.length;t++)e=this.map[t],e.el.style.strokeDashoffset=null,e.el.style.strokeDasharray=null,this.renderPath(t)},n.prototype.isInvisible=function(t){var e,i=t.getAttribute("data-ignore");return null!==i?"false"!==i:this.ignoreInvisible?(e=t.getBoundingClientRect(),!e.width&&!e.height):!1},n.prototype.parseAttr=function(t){var e,i={};if(t&&t.attributes)for(var n=0;n<t.attributes.length;n++)e=t.attributes[n],i[e.name]=e.value;return i},n.prototype.isInViewport=function(t,e){var i=this.scrollY(),n=i+this.getViewportH(),o=t.getBoundingClientRect(),r=o.height,a=i+o.top,s=a+r;return e=e||0,n>=a+r*e&&s>=i},n.prototype.docElem=t.document.documentElement,n.prototype.getViewportH=function(){var e=this.docElem.clientHeight,i=t.innerHeight;return i>e?i:e},n.prototype.scrollY=function(){return t.pageYOffset||this.docElem.scrollTop},o=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){return t.setTimeout(e,1e3/60)}}(),r=function(){return t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.mozCancelAnimationFrame||t.oCancelAnimationFrame||t.msCancelAnimationFrame||function(e){return t.clearTimeout(e)}}(),a=function(t,e){var i=parseInt(t,10);return i>=0?i:e},"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof exports?module.exports=n:t.Vivus=n}(window,document),function(t){var e=function(e,i){function n(){setTimeout(function(){o(r)},100)}function o(e){if(e=t(e)[0],e.focus(),"undefined"!=typeof window.getSelection&&"undefined"!=typeof document.createRange){var i=document.createRange();i.selectNodeContents(e),i.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(i)}else if("undefined"!=typeof document.body.createTextRange){var o=document.body.createTextRange();o.moveToElementText(e),o.collapse(!1),o.select(1)}}var r,a,s,l,c,u=t(e),d=this,h=_mipKeys.keywrdr(),p={__id:0,_imgid:0},f=function(){l=!0;var e=t(r).clone(),i=[];t(e).find(".ky").each(function(){t(this).hasClass("ky")&&i.push(this.innerText)}),t(e).find(".ky").remove();var n=t(e).text();if(n)for(var o=n.split(","),a=0;a<o.length;++a)if(o[a].length>2){var s=t.trim(o[a].replace(/(\r\n|\n|\r)/gm,""));" "!=s&&s.length>0&&i.push(s)}t(r).html("");for(var c=0;c<i.length;++c){var u=_mip.chip.createChip(i[c],d.__id);u.on("update",function(e,i){if("delete"==i){{t(this).data("keyid")}t(this).remove()}}),u.appendTo(r)}t(r).html(t(r).html()+" &nbsp;"),l=!1};this.saveKeys=function(){if(!s){var e=[];"undefined"==typeof d._imgid&&(d._imgid=0),"undefined"==typeof d.__id&&(d.__id=0),t(r).find(".ky").each(function(){t(this).hasClass("ky")&&e.push(this.innerText)}),t.ajax({url:"/image/savekeys/"+d._imgid+"/"+d.__id,type:"POST",success:function(t){},error:function(t){},data:{keys:e.join(",")},cache:!1})}},this.hasChanged=function(){if(a&&!l){var e=t(r).find(".ky").length;e!=c&&d.saveKeys(),c=e}},this.activate=function(){a||(a=!0,t(r).off("keypress").on("keypress",function(t){var e=t.keyCode||t.which;13==e&&(t.preventDefault(),t.stopPropagation(),f(),n())}),t(r).off("focusout").focusout(function(){f()}),h.setActive(d),n())},this.deactivate=function(){a&&(a=!1,d.saveKeys(),t(r).off("keypress"))},this.destroy=function(){a&&(a=!1,d.saveKeys()),t(r).off("keypress")},this.deleted=function(){a=!1,s=!0,t(r).off("keypress")};var m=function(){d.settings=t.extend({},p,i),d._imgid=d.settings.imgid||t(u).attr("data-id"),d.__id=d.settings.id||_mutil.guid(),r=t(u).find(".inputWrpr"),f(),c=t(r).find(".ky").length};m()};t.fn.keywordinput=function(){return this.each(function(){var i=t(this);if(!i.data("keywordinput")){var n=new e(this);i.data("keywordinput",n)}})}}(jQuery);var _mipKeys=function(){function t(){window.requestInterval(function(){i&&"function"==typeof i.hasChanged&&i.hasChanged()},300);var t={};return t}var e,i;return{keywrdr:function(){return e||(e=t(),e.setActive=function(t){i=t}),e}}}(),$currentPopover=null,_scrolld,_hasQuest;$(function(){$(document).on("shown.bs.popover",function(t){var e=$(t.target);$currentPopover&&$currentPopover.get(0)!=e.get(0)&&$currentPopover.popover("toggle"),$currentPopover=e})}),$(function(){return $(document).on("hidden.bs.popover",function(t){var e=$(t.target);$currentPopover&&$currentPopover.get(0)==e.get(0)&&($currentPopover=null),e.removeClass("is-active")})}),$(function(){return $(".modal").on("show.bs.modal",function(){var t;t=this,$(".modal").each(function(){this!==t&&$(this).modal("hide")})})}),$(function(){return $(".modal").on("hide.bs.modal",function(){})}),$(document).ready(function(){function t(t){$("#notice_menu_li").addClass("active")}function e(){console.log("successCallback"),
o.get({limit:1}).then(function(t){"undefined"!==t.unseen&&parseFloat(t.unseen)>0&&$("#notice_menu_li").addClass("active")})}function i(t){}if(Modernizr.touch?$("html").addClass("has-touch"):($("html").addClass("no-touch"),$('[data-toggle="tooltip"], [rel="tooltip"]').tooltip()),"undefined"!=typeof __mipo.logged_in&&__mipo.logged_in){var n=stream.connect("42wee86ngdv2",null,"5292"),o=n.feed("notification",__mipo.user_id,__mipo.user_token);o.subscribe(t).then(e,i)}$("body").on("dragover",function(t){t.preventDefault(),t.stopPropagation(),$(this).addClass("dragging")}),$("body").on("dragenter",function(t){t.preventDefault(),t.stopPropagation(),$(this).addClass("dragging")}),$("body").on("drop",function(t){t.originalEvent.dataTransfer&&t.originalEvent.dataTransfer.files.length&&(t.preventDefault(),t.stopPropagation(),$(this).removeClass("dragging"),_mip.upload(t.originalEvent.dataTransfer.files))}),$("body").on("click",function(t){removeAllPopovers()}),$("#altSearch").keyup(function(t){13==t.keyCode&&altSearchClick()}),$("#noResponse").find(".icon-search, #altSearchCount").off("click").on("click",function(t){altSearchClick()}),new Clipboard(".btn-clipbrd"),$(".searchBlock").searchbar(),Placeholdem(document.querySelectorAll(".form-control.search")),$("#notice_menu").popover({trigger:"manual",html:!0,viewport:{selector:"body",padding:10},placement:"bottom",content:function(){var t=$("#activityLdr").html();return t}}).on("shown.bs.popover",function(){$("#notice_menu_li").removeClass("active")}),$("#notice_menu").click(function(t){t.stopPropagation(),$(this).siblings(".popover").length>0?$(this).popover("hide"):($(this).popover("show"),$.ajax({url:"/activity/digest",data:{},method:"get",dataType:"json"}).done(function(t){var e;if(t&&t.doc){var i=t.doc;if(e='<ul class="notification">',0!==i.length){for(var n in i){if("max"==n)break;e+="questcomment"==i[n].verb?'<li data-uri="/activity/act/'+i[n].id+'" data-type="'+i[n].verb+'">										<div class="avatar"><a href="/creative/'+i[n].user.username+'"><img src="'+i[n].user.avatar+'"></a></div>										<div class="data"><span class="text">'+i[n].text+'</span><span class="date">'+i[n].date+"</span></div>									</li>":'<li data-uri="/activity/act/'+i[n].id+'" data-type="'+i[n].verb+'">										<div class="avatar"><a href="/creative/'+i[n].user.username+'"><img src="'+i[n].user.avatar+'"></a></div>										<div class="thumb"><img src="'+i[n].thumb+'"></div>										<div class="data"><span class="text">'+i[n].text+'</span><span class="date">'+i[n].date+"</span></div>									</li>"}e+="</ul>",e+='<div class="btnSQ">Show all</div>'}else e+="<li>No activity</li>",e+="</ul>"}else e='<div class="empty">No activity data.</div>';{var o=$("#notice_menu").data("bs.popover").tip();$("#notice_menu").position()}$(o).addClass("notice_menu"),$(o).find(".popover-content").html(e),$(o).click(function(t){if($(t.target).hasClass("btnSQ"))_mip.track("Activity","Toolbar","Landing","","/activity");else{var e=$(t.target).closest("li");if($(e).length>0){var i=$(e).attr("data-uri");"undefined"==typeof i&&(i="/activity"),_mip.track("Activity","Toolbar",$(e).attr("data-type"),"",i)}}t.stopPropagation()})}))}),$(".sort").popover({html:!0,placement:function(t,e){return $(window).width()<550?"bottom":"left"},container:"body",viewport:{selector:"body",padding:10},content:function(){return $("#sort_content").html()}}).on("shown.bs.popover",function(t){var e=$(".sort").data("bs.popover").tip();if($(e).addClass("sort_popover"),$('[data-toggle="sortby"]').click(function(t){t.stopPropagation(),$('[data-toggle="sortby"].active').removeClass("active"),$(this).addClass("active"),$("#sortName").val($(this).attr("data-sort")),_scrolld?_scrolld.changeSort($(this).attr("data-sort")):scrollImage(),_mip.track("Search","Sort",$(this).attr("data-sort")),$(".sort").popover("hide")}),_scrolld){var i=_scrolld._vars();$("[data-sort='"+i.sort+"']").addClass("active")}$('[data-toggle="findby"]').click(function(t){$("#searchByCreative").modal("show"),$("#searchByCreative").on("shown.bs.modal",function(t){$(".search-by-creative").click(function(t){t.preventDefault();var e=$(".searchBlock").data("searchbar");e.changeCreative($(".search-creative").val()),_mip.track("Search","Creative",$(".search-creative").val()),$(".sort").popover("hide")})})})}),$("#morgue-modal-init").on("click",".btn",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).parent().attr("id"),i=$(this).parent(),n="create-likebox-form"==e?1:_mutil.getQueryParameterByName("page"),o=(i.find("input[name='id']"),$(".box.is-visible"),i.serializeArray());o.push({name:"page",value:n}),o.push({name:"formName",value:e}),$(".modal-body h2").find(".modal_error").remove(),$.ajax({method:"POST",data:o,url:""}).done(function(t){var e=JSON.parse(t);e.error?$(".modal-body h2").after("<span class='modal_error'> "+e.error+" </span>"):(e.show&&(_edit_TITLE.text(i.find("input[name='title']").val()),$(_edit_TITLE).closest(".lb").attr("data-likebox-uri",e.slug)),e.reload&&(location.href=_mutil.getPathFromUrl()+"?page="+e.reload),$(".modal").modal("hide"))})}).on("hidden.bs.modal",function(){$(document).find(".box.is-visible").removeClass("is-visible"),$(this).find(".modal-content").off("click"),$(this).find(".modal-body").html("")}),$('[data-toggle="popover-user"]').popover({html:!0,placement:"bottom",viewport:{selector:"body",padding:10},content:function(){return $("#popover-user_content").html()}}),$(".login-link").click(function(){_mip.showLogin()}),$("#fbbtn").click(function(){_mip.checkLoginState()}),$(".join-link").click(function(){_mip.joinclick()}),$(".forgot-password").off("click").click(function(){$(".modal").modal("hide"),$("#forgot-pwd").modal("show"),$("#forgot-pwd-form .message-box").addClass("hide"),$("#forgot-pwd").on("shown.bs.modal",function(t){$("#forgot-pwd-form").validator().on("submit",function(t){t.preventDefault(),$.ajax({method:"POST",url:"/password",data:{email:$("#email").val()},success:function(t){var e=JSON.parse(t);e.success?($(".modal").modal("hide"),$("#forgot-pwd-confirm").modal("show")):($("#forgot-pwd-form .message-box").removeClass("hide"),$("#forgot-pwd-form .message").html(e.message))}})})})}),$(".confirmationBox").off("click").on("click",function(t){if(t.preventDefault(),confirm("Are you sure you want to ban this user?")){var e=$(this),i=e.data("uniqueid");$.post(e.attr("href"),{uid:i},function(t){var n=JSON.parse(t);n.error?alert("Something went wrong"):(alert("This UID # "+i+" has been banned"),e.parents("tr").fadeOut().delay(1e3).queue(function(t){$(this).remove(),t()}))})}}),$('[data-toggle="popover-upload"]').popover({html:!0,placement:function(t,e){return $(window).width()<550?"bottom":"left"},container:"body",content:function(){return $("#popover-upload_choice").html()}}).on("shown.bs.popover",function(t){var e=$(this);$(this).addClass("active"),_mip.track("Gnav","Click","Upload"),$(".popover .menu .slct").off("click").on("click",function(t){_mip.currentQuest=$(t.currentTarget).closest(".slct").attr("data-quest"),_mip.upload(),e.popover("hide")})}).on("hidden.bs.popover",function(t){$(this);$(this).removeClass("active")}),$("#srchInNav > img, .icon-search-close").click(function(){$("#wrapper").removeClass("open"),$("#wrapper").toggleClass("srchopen")}),$("#iconsInNav .hamburger").click(function(){$(this).toggleClass("is-active"),$(this).parents(".box").toggleClass("is-visible"),$("#wrapper").toggleClass("open"),$('[data-toggle="popover"]').popover("hide"),$("#wrapper").removeClass("srchopen"),$("#wrapper").hasClass("open")?(_mip.track("Hamburger","Click","Open"),$(".sortd, .gnav").css({"z-index":1})):(_mip.track("Hamburger","Click","Close"),setTimeout(function(){$(".sortd, .gnav").css({"z-index":990})},500))}),$("#lboxes").click(function(t){if($(t.target).hasClass("hamburger")||$(t.target).parent().hasClass("hamburger")){var e=$(t.target);e.parent().hasClass("hamburger")&&(e=e.parent()),t.preventDefault(),t.stopPropagation(),e.hasClass("is-active")?(e.popover("hide"),e.removeClass("is-active"),e.parents(".box").removeClass("is-visible")):(e.popover("show"),$("#lboxes .hamburger").removeClass("is-active"),e.addClass("is-active"),e.parents(".box").addClass("is-visible"))}}),$('[data-toggle="popover-lboxedit"]').popover({trigger:"manual",html:!0,container:"#lboxes",placement:"top",content:function(){var t="";return window._user_ID=$(this).data("id"),window._edit_TITLE=$(this).parent().find(".title h1"),window._short_URI=$(this).closest(".lb").attr("data-likebox-key"),t+="<ul class='likebox-menu'>",t+="<li><a data-id='"+_user_ID+"' data-modal='modal-email-likebox'><i class='fa fa-envelope'></i></a></li>",t+="<li><a data-id='"+_user_ID+"' data-modal='modal-share-likebox'><i class='fa fa-share-alt'></i></a></li>",t+="<li><a data-id='"+_user_ID+"' data-modal='modal-edit-likebox'><i class='fa fa-pencil'></i></a></li>",t+="<li><a data-id='"+_user_ID+"' data-modal='modal-remove-likebox'><i class='fa fa-trash'></i></a></li>",t+="</ul>"}}).on("shown.bs.popover",function(){$(".likebox-menu li a").click(function(t){var e=$(this).data("modal"),i=$("#morgue-modal-init").find(".modal-body").html($("#"+e).html());i.find(".btn").before("<input type='hidden' name='id' value='"+_user_ID+"'>"),"modal-edit-likebox"==e&&i.find("input[name='title']").val(_edit_TITLE.text()),$("#morgue-modal-init").modal("show"),$("#morgue-modal-init").find(".uri").html("http://mrg.bz/"+window._short_URI),$("#morgue-modal-init").find(".form-uri").val("http://mrg.bz/"+window._short_URI),$("#morgue-modal-init").find('[name="url"]').val("http://mrg.bz/"+window._short_URI),$("#morgue-modal-init").find(".shrtwtr").attr({href:"http://twitter.com/share?text=&url=http://mrg.bz/"+window._short_URI}),$("#morgue-modal-init").find(".shrface").attr({href:"https://www.facebook.com/sharer/sharer.php?u=http://mrg.bz/"+window._short_URI})})}),$("#create-likebox").click(function(t){$("#morgue-modal-init").find(".modal-body").html($("#modal-create-likebox").html()),$("#morgue-modal-init").modal("show")}),$("#morgue-modal-init").on("click","#openemail",function(t){$("#morgue-modal-init").find(".modal-body").html($("#modal-email-likebox").html()),$("#morgue-modal-init").modal("show"),$("#morgue-modal-init").find(".uri").html("http://mrg.bz/"+window._short_URI),$("#morgue-modal-init").find(".form-uri").val("http://mrg.bz/"+window._short_URI)}),$(".purchase-quest-form").bind("submit",function(t){$('.purchase-quest-form [name="confirm"]').val().length<=0&&($.ajax({method:"GET",url:"/quest/confirmTitle/"+encodeURIComponent($('.purchase-quest-form [name="title"]').val()),success:function(t){var e=JSON.parse(t);e.error?$(".errors").html("<li>"+e.message+"</li>"):($("#modal-confirm-quest").modal("show"),$('#modal-confirm-quest [name="title"]').val(e.hashtag),$("#create-quest-confirm-form").bind("submit",function(t){$('#create-quest-confirm-form [name="title"]').val().length<=0?t.preventDefault():$.ajax({method:"GET",url:"/quest/confirmTitle/"+encodeURIComponent($('#create-quest-confirm-form [name="title"]').val()),success:function(t){var e=JSON.parse(t);if(e.error)$(".errors").html("<li>"+e.message+"</li>");else{var i=$('#create-quest-confirm-form [name="title"]').val();$('.purchase-quest-form [name="confirm"]').val(i),$('.purchase-quest-form [name="title"]').val(i),$("#modal-confirm-quest").modal("hide"),$(".errors").html(""),$(".purchase-quest-form").submit()}}}),t.preventDefault()}))}}),t.preventDefault())}),$("#likebox-int").on("shown.bs.modal",function(){function t(){$("#create_box").click(function(t){var e=$(".box-name").val();return""!==e&&(_mip.createlikeBox(e,s,r,n),$(".box-name").val("")),!1})}function e(){$(".boxslct li").click(function(t){var e=$(t.target).data("id");$(t.target).hasClass("active")?(_mip.removeFromlikeBox(e,s,r),$(t.target).removeClass("active")):(_mip.addTolikeBox(e,s,r),$(t.target).addClass("active"))})}function i(){$(".page-number a").click(function(t){var e=$(t.target).data("page-nav"),i=parseInt($("#page").val()),o=parseInt($("#page_count").val());if("prev"==e){if(0>=i-1)return!1;i-=1}else if("next"==e){if(i+1>o)return!1;i+=1}n(i)})}function n(t){t||(t=1),$.getJSON("/likebox/im/"+s+"/"+t,function(t){$(o).find(".pagination-text").html(t.page+" of "+t.page_count),$(o).find(".likeboxes-content").html(Mustache.to_html($("#likeboxes-content").html(),t)),e()})}var o=this,r=$(o).data("dt"),a=$(o).data("img"),s=r.id;$.getJSON("/likebox/im/"+s,function(n){jQuery.extend(n,{src:a}),$(o).find(".modal-body").html(Mustache.to_html($("#likebox-int-add").html(),n)),t(),e(),i()})}).on("hidden.bs.modal",function(){$(this).find(".modal-content").off("click"),$(this).find(".modal-body").html("")}),$(".affiliates").click(function(t){_mip.track("Affiliate","Tab",$(t.target).attr("id")),_scrolld.changeAffiliate($(t.target).attr("id"))});new _mip.loading_animation("ldr-mdl"),new _mip.loading_animation("ldr-inf"),new _mip.loading_animation("ldr-inf2")});var didScroll,lastScrollTop=0,delta=5,navbarHeight=55;$(window).scroll(function(t){didScroll=!0,removeAllPopovers(),checkGNavPos()}),window.requestInterval(function(){didScroll&&(hasScrolled(),didScroll=!1)},250),window.requestInterval(function(){checkGNavPos()},50),Array.prototype.max=function(){return Math.max.apply(null,this)},Array.prototype.min=function(){return Math.min.apply(null,this)},Array.prototype.duplicate=function(){for(var t=this.length,e=0;t>e;e++)this[t+e]=this[e];return this},Array.prototype.remove=function(t){return-1!==this.indexOf(t)?(this.splice(this.indexOf(t),1),!0):!1},Array.prototype.add=function(t){return-1!==this.indexOf(t)?!1:(this.push(t),!0)},String.prototype.sanitize=function(){var t=this,e=[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/"/g,"&quot;"]];for(var i in e)t=t.replace(e[i][0],e[i][1]);return t},jQuery.fn.single_double_click=function(t,e,i){return this.each(function(){var n=0,o=this;jQuery(this).click(function(r){n++,1==n&&setTimeout(function(){1==n?t.call(o,r):e.call(o,r),n=0},i||300)})})},function(){var t=function(){};window.console||(window.console={log:t,info:t,warn:t,debug:t,error:t})}(),function(e){e.scrolldMasonry=function(n,o){var r,a,s,l,c,u,d,h,p,f,m,g=this,v=n,y="init",w=0,b=0,_=5,x=!0,$=[],k=signals.Signal,C=new k,T={data:"",box:!1,affiliate:"",offset:0,buffer:200,onPageChange:function(t){},onPageRender:function(t){}},I={req:{},resp:{},o:{},doServerCall:function(){var t={};t.page=parseFloat(this.o.page),t.limit=this.o.limit,t.terms=this.o.terms,t.approve=this.o.approve,t.keywrdng=this.o.keywrdng,t.quest=this.o.quest,t.sort=this.o.sort,t.af=this.o.affiliate,t.author=this.o.author,this.req=e.ajax({url:_uri,method:"GET",data:t,dataType:"json"}).done(function(t){!t||t.error?"out of range"==t.error:(this.resp=t,this.resp.page=parseFloat(this.resp.page),this.resp.limit=parseFloat(this.resp.limit),I.dir="undefined"==typeof I.dir?1:I.dir,"undefined"!=typeof this.resp.pagecount&&(this.resp.page_count=this.resp.pagecount),typeof this.resp.page_count!=0/0&&parseFloat(this.resp.page_count)>0&&(b=a.page_last=I.o.page_count=parseFloat(this.resp.page_count)),"undefined"!=typeof this.resp.terms&&this.resp.terms.length>0&&a.hasTerms(),this.resp.success?C.dispatch("render"):a.interfaceState("empty"))}.bind(I))},setParam:function(t,e){I.o[t]="undefined"!=typeof t?e:""},cancel:function(){}},S={_this:this,num:4,gtr:_,maxW:1200,range:[1,1],colW:0,cols:[],elms:[],changeCols:function(t,e){(t!=this.num||e)&&(this.resetCols(t),this.assignImagesToCols(1,!0),this.setPositions())},resetCols:function(t){e(v).removeClass(function(t,e){return(e.match(/(^|\s)masn-\S+/g)||[]).join(" ")}).addClass("masn-"+t+"-col"),this.num=t,this.cols=[],this.colW=(this.maxW-this.gtr*(this.num-1))/this.num;for(var i=0;i<this.num;++i)this.cols.push({height:0,top:0,left:(i*this.colW+this.gtr*i)/this.maxW*100,elms:[]})},resetAllTopsAllCols:function(){for(var i=0;i<this.cols.length;++i){var n=this.cols[i].elms.length<=0?0:this.cols[i].elms[0].position().top;if(0!==n)for(var o=0;o<this.cols[i].elms.length;++o){var r=this.cols[i].elms[o];t=e(r).position().top,e(r).css("top",t-n)}}},setPositions:function(){U("positioning"),this.setPgRange();var i,n=this;for(i=0;i<this.num;i++)this.cols[i].top=this.cols[i].elms.length>0?e(this.cols[i].elms[0]).position().top:0;var o=Math.min.apply(null,this.cols.map(function(t){return t.top}));this.cols.map(function(t,r){var a,s=0;for(i=0;i<t.elms.length;++i){var l=t.elms[i];0===i?(a=e(l).position().top-o,n.cols[i].top=a,e(l).css({top:a})):e(l).css({top:a+s}),e(l).css({left:t.left+"%"}),a=e(l).position().top,s=parseFloat(e(l).height())+n.gtr}n.cols[r].height=a+s}),this.range[0]<=1&&this.resetAllTopsAllCols();var r=this.findTallesColHeight();this.cols.map(function(n){for(i=0;i<n.elms.length;++i){var o=n.elms[i];t=e(o).position().top,e(o).css("top",t/r*100+"%")}}),x&&e(v).css({"padding-bottom":n.cols.length>1?r/(e(v).width()+30)*100+"%":0}),this.setPgRange(),this.setLoaderDivs(),onPageRender(),O()},assignImagesToCols:function(t,e){for(i=0;i<this.elms.length;++i)(this.elms[i].col<0||e)&&(-1==t?this.prependToCol(this.elms[i],this.findLowestCol()):this.appendToCol(this.elms[i],this.findShortestCol()))},appendToCol:function(t,i){var n=t.dom;i=i>=0?i:0,t.col=i,e(n).css({top:isNaN(this.cols[i].height)?0:this.cols[i].height,left:this.cols[i].left+"%"}),this.cols[i].elms.push(n),isNaN(this.cols[i].height)&&(this.cols[i].height=0),this.cols[i].height+=isNaN(parseFloat(e(n).height()))?0:parseFloat(e(n).height())},prependToCol:function(t,i){var n=t.dom,o=parseFloat(e(n).height());i=i>=0?i:0,t.col=i,e(n).css({top:this.cols[i].top-o,left:this.cols[i].left+"%"}),this.cols[i].elms.unshift(n),this.cols[i].top-=o},setPgRange:function(){var t=[];for(i=0;i<this.elms.length;++i)(parseFloat(this.elms[i].dom.data("page"))>0||!x)&&t.push(parseFloat(this.elms[i].dom.data("page")));this.range=t.length>0?[t.min(),t.max()]:[1,1],a.page_top=this.range[0],a.page_bottom=this.range[1]},optimize:function(){for(var t=this,i=0;i<this.elms.length;++i)(parseFloat(this.elms[i].dom.data("page"))<w-2||parseFloat(this.elms[i].dom.data("page"))>w+2)&&(N(this.elms[i].dom)||(U("optimize"),D(this.elms[i].id),e(this.elms[i].dom).remove()));if("optimize"==y){this.elms=this.cleanOutElementsArray(this.elms,!0);for(var n=0;n<this.num;++n)this.cols[n].elms=t.cleanOutElementsArray(this.cols[n].elms);return U("static"),!0}return!1},cleanOutElementsArray:function(t,i){return t=t.filter(function(t){return t=i?t.dom:t,e(t).parent().length?!0:!1})},setLoaderDivs:function(){P();Math.max.apply(null,this.cols.map(function(t){return t.height}));a.interfaceState(w>1?"loading-top":"loading-bottom"),e(".inf-loader.bottom").removeClass("init")},prependElement:function(t){this.elms.unshift(t),v.prepend(t.dom)},addElement:function(t){this.elms.push(t),v.append(t.dom)},findTallesColHeight:function(){var t=this.cols.map(function(t){return t.height||0});return t.max()},findShortestCol:function(){var t=this.cols.map(function(t){return t.height||0});return t.indexOf(t.min())},findLowestCol:function(){var t=this.cols.map(function(t){return t.top||0});return t.indexOf(t.max())},clear:function(){this.cols=[],this.elms=[],v.html("")}},E=function(t){U("render");var e=I.resp.doc;if("undefined"==typeof e)a.interfaceState("empty");else if(e.length<=0)a.interfaceState("empty");else{for(var i=0;i<e.length;++i)A(e[i].unique_id)||(-1==I.dir?S.prependElement(new M(e[i],parseFloat(I.resp.page))):S.addElement(new M(e[i],parseFloat(I.resp.page))));S.assignImagesToCols(I.dir),S.setPositions(),r.resetPos(),a.interfaceState("set")}},A=function(t){if(l){if($.indexOf(t)>=0)return!0;$.push(t)}return!1},D=function(t){var e=$.indexOf(t);e>=0&&$.splice(e,1)},O=function(){U("static"),r.resetPos(),p=setTimeout(function(){"static"==y&&S.optimize()&&S.setPositions()},500)},P=function(){"static"==y&&e(".scrolld-item").each(function(t){return N(this)?(w=parseFloat(e(this).data("page")),w=!w||0>=w?1:w,r.setPos(this),1):void 0})},M=function(t,i){this.id=t.unique_id,this.data=t,this.col=-1,this.data.file_width&&"undefined"!=typeof this.data.file_width||(this.data.file_height=400,this.data.file_width=400),this.dom=e("<div></div>").html(Mustache.to_html(m,this.data)).addClass("scrolld-item thumb"),this.dom.data("id",this.id),this.dom.data("page",parseFloat(i)),this.dom.attr({"data-id":this.id}),this.dom.attr({"data-jpg":t.file_path_large}),t.hashtag&&this.dom.attr({"data-hashtag":t.hashtag}),this.dom.data("affiliate",I.o.affiliate),t.affil&&(this.dom.data("affl_thumb",t.file_path_large),this.dom.data("affl_uri",t.uri),this.dom.addClass("affiliate")),t.liked?this.dom.find(".notLiked").hide():this.dom.find(".hasLiked").hide(),e(this.dom).find(".hldr").css({"padding-top":u?"100%":this.data.file_height/this.data.file_width*100+"%"}),d||e(this.dom).click(function(e){_mip.clickd(e,t.unique_id)})},N=function(t){var i=e(t),n=e(window),o=n.scrollTop(),r=o+n.height(),a=i.offset().top,s=a+i.height();return r>=s&&a>=o},R=function(){if(!e("html").hasClass("modal-open")){var t=0;if(1!=S.range[0]&&e(window).scrollTop()<=100&&(t=-1),S.range[1]!=I.o.page_count&&e(window).scrollTop()+e(window).height()>=e(document).height()-200&&(t=1),0!==t){var i=L(t);i&&i>0&&isFinite(i)&&"static"==y&&j(i,t)}}},L=function(t){var e=!1;return e=0>t?S.range[0]-1:S.range[1]+1,"undefined"!=typeof I.o.page_count&&e>I.o.page_count||0>=e?!1:e},j=function(t,e){if(t=t||1,P(),"init"==y||"static"==y){if(b>0&&t>b)return;U("request"),I.o.page=parseFloat(t),I.dir=e,I.doServerCall()}},F=function(t){("static"==y||t)&&S.changeCols(q())},q=function(){if(!x)return 1;var t=4,i=e(window).width();return i>=1200?t=4:1200>i&&i>=850?t=3:850>i&&i>600?t=2:600>i&&(t=1),t},U=function(t){clearTimeout(p),y=t};this.changeAffiliate=function(t){this.destroy(),I.setParam("affiliate",t),I.setParam("author",""),I.setParam("page",1),a.setAffiliate(t),z(),j(1)},this.changeSort=function(t){this.destroy(),I.setParam("sort",t),I.setParam("page",1),a.gotoTop(),z(),j(1)},this.refresh=function(t){this.destroy(),z(),j(1)},this.destroy=function(){I.req.abort(),a.clear(),$=[],S.clear(),S.resetCols(q()),U("init")},this.showLog=function(){console.log(S.cols)},this._vars=function(t){var e={page:parseFloat(I.o.page),affiliate:I.o.affiliate,terms:I.o.terms,approve:I.o.approve,keywrdng:I.o.keywrdng,quest:I.o.quest,sort:I.o.sort,author:I.o.author,mdate:I.o.mdate};return"undefined"==typeof e.affiliate&&(e.affiliate="morguefile"),"undefined"==typeof e.page&&(e.page=1),t&&(e.terms=encodeURIComponent(e.terms),e.quest=encodeURIComponent(e.quest),e.author=encodeURIComponent(e.author)),e.isLbox=h,e},this.update=function(t){this.destroy();for(var e in t)I.setParam(e,t[e]);I.setParam("page",1),z(),j(1)},this.getURL=function(t){var e=this._vars();for(var i in t)"undefined"!==t[i]&&(e[i]=t[i]);return s.getURI(e)};var z=function(){P(),0>=w&&(w=1);var t=g._vars(!0);t.page=parseFloat(w),s.setURI(t),S.setLoaderDivs()},W=function(){g.settings=e.extend({},T,o),g.el=n,_uri=g.settings.data,l=g.settings.cacheElm,c=g.settings.uri,u=g.settings.isSquare||!1,d=g.settings.isNotClickble||!1,h=g.settings.box||!1,_=g.settings.gutter,x="undefined"==typeof g.settings.isMasonry?x:g.settings.isMasonry,m=e("#"+g.settings.mustache).html(),C.add(E),e(n).pagepos(),r=e(n).data("pagepos"),e(n).prettyuri(f),s=e(n).data("prettyuri"),s.template(c),e(n).pageinterface(),a=e(n).data("pageinterface"),a.interfaceState("init");var t=["page","limit","terms","approve","keywrdng","quest","sort","affiliate","author","uri"];for(var i in t)I.setParam(t[i],g.settings[t[i]]);S.resetCols(q()),j(I.o.page),window.requestInterval(R,50),window.requestInterval(F,50),onPageRender=g.settings.onPageRender,onPageChange=g.settings.onPageRender,e(window).scroll(function(){z()}),a.setAffiliate(I.o.affiliate),a.scrlld=g};W()}}(jQuery),function(t){var e=function(e){var i=(t(e),""),n="";this.template=function(t){i=t},this.setURI=function(t){var e=this.getURI(t);n!=e&&history.pushState&&(history.pushState(null,null,e),n=e)},this.getURI=function(t){var e=[];if(("undefined"==typeof t.affiliate||t.affiliate.length<=0)&&(t.affiliate="morguefile"),"undefined"==typeof t.terms&&(t.terms=""),("undefined"==typeof t.author||"morguefile"!=t.affiliate)&&(t.author=""),("undefined"==typeof t.quest||"morguefile"!=t.affiliate)&&(t.quest=""),t.author.length>0&&t.terms.length<=0&&(t.terms="all"),"morguefile"!=t.affiliate&&(t.sort=""),i)e=Mustache.to_html(i,t).replace(/([^:]\/)\/+/g,"$1");else{for(var n=window.location.href.split("/"),o=[n[0]+"//"+n[2]+"/"+(""!==n[3]?n[3]:"search"),t.affiliate,t.page,t.terms,t.quest,t.author,t.mdate],r=0;r<o.length&&!("undefined"==typeof o[r]||o[r].length<=0);++r)e.push(o[r]);e=e.join("/")}return e}};t.fn.prettyuri=function(){return this.each(function(){var i=t(this);if(!i.data("prettyuri")){var n=new e(this);i.data("prettyuri",n)}})}}(jQuery),function(t){var e=function(e){{var i,n;t(e)}this.resetPos=function(){_mip.isRendering=!0;var e=t(i).position(),o=e?e.top:0;o>0&&(t(window).scrollTop(o-n),setTimeout(function(){_mip.isRendering=!1},400))},this.setPos=function(e){i=e;var o=t(i).position();n=o?o.top-t(window).scrollTop():0}};t.fn.pagepos=function(){return this.each(function(){var i=t(this);if(!i.data("pagepos")){var n=new e(this);i.data("pagepos",n)}})}}(jQuery),function(t){var e=function(e){var i,n,o,r=(t(e),this);this.clear=function(){i=!1,n=!1,r.page_top=1,r.page_bottom=1,r.page_last=1,r.af="Morguefile",r.isEmpty=!1},this.interfaceState=function(e){this.isEmpty||(s(e),"empty"!=e||i?t("#noResponse").hide():(this.isEmpty=!0,l(),t(".scrllInterface").show())),n&&a()},this.hasTerms=function(){n=!0,a()},this.setAffiliate=function(e){e&&"morguefile"!=e||(e="Morguefile"),t(".affiliates li").removeClass("active"),t('[data-af="'+e.toLowerCase()+'"]').addClass("active"),"Morguefile"==e?t(".sortd").show():t(".sortd").hide()},this.gotoTop=function(){o=!0};var a=function(){t(".page-jumbotron.scrllInterface").hide(),t(".topRowPromos.scrllInterface").hide()},s=function(e){i=t(".scrolld-item").length>0?!0:!1,t(".inf-loader.top").hide(),t(".inf-loader.bottom").hide(),"set"==e&&(r.page_top<=1?(t(".scrllInterface").show(),t(".inf-loader.top").hide()):t(".scrllInterface").hide(),r.page_bottom==r.page_last?(t(".scrllInterfaceEnd").show(),t(".inf-loader.bottom").hide()):t(".scrllInterfaceEnd").hide(),o&&t(".scrllInterface").hide(),o=!1),r.page_top>1&&t(".inf-loader.top").show(),r.page_bottom<r.page_last&&i&&t(".inf-loader.bottom").show(),n&&a()},l=function(){var e=r.scrlld._vars(),i="undefined"!=typeof e.terms?e.terms.split(",").join(" "):"";t("#noResponse").show(),t("#altSearch").val(i),t("#altSearchCount").html(""),t.ajax({method:"GET",url:"/image/jsoncount/",data:{terms:i,af:"istock"},success:function(e){var i=JSON.parse(e);if(i.success){var n;if(parseFloat(i.count)>=4){for(var o=1;4>=o;++o)n=t("<div></div>").html('<div class="hldr" style="background-image: url(\''+i.doc[o].file_path_large+'\');" data-img="'+i.doc[o].unique_id+'"></div>'),t("#altSearchImgs").append(n);t("#altSearchImgs").append(n),t("#altSearchCount").html(i.count+" results")}_mip.track("iStock_ads","View","RelatedImgsSrch")}}})};this.clear()};t.fn.pageinterface=function(){return this.each(function(){var i=t(this);if(!i.data("pageinterface")){var n=new e(this);i.data("pageinterface",n)}})}}(jQuery),function(t){var e=function(e,i){var n,o,r,a,s=t(e),l=function(){n=t(s).find(".tags"),o=t(s).find(".search"),r=[],a={},t(n).attr("data-terms").length>0&&(r=t(n).attr("data-terms").split(",")),t(n).attr("data-author").length>0&&(a.author=t(n).attr("data-author")),d(),g(),c()},c=function(){s.find(".icon-search").off("click").on("click",function(e){e.button=!0,1!=t(o).attr("data-animating")&&u(e)}),t(o).off("keydown").keydown(function(t){u(t)}),t(o).autocompleteSearch({source:"/image/autocomplete/",delay:50,minLength:1,select:function(e,i){return"user"==i.item.type?(window.location="/creative/"+i.item.value,!1):"quest"==i.item.type?(window.location="/quest/"+i.item.value,!1):(e.button=!0,t(o).val(i.item.value),void u(e))}})},u=function(e){var i=t(o).val();13!==e.keyCode&&!e.button||""===i||v(i)||(e.preventDefault(),e.stopPropagation(),_scrolld&&!_hasQuest?(_mip.track("Search","Image",i),p(i)):(i=encodeURIComponent(i),_mip.track("Search","Image",i,"","/search/morguefile/1/"+i.replace(/s/g,"%20"))))},d=function(){var e;o.val(""),t(n).find(".tag-choice").remove(),a.author&&(e=h(a.author,"author"),t(n).prepend(e));for(var i=0;i<r.length;++i)v(r[i])||(e=h(r[i],"terms"),t(n).prepend(e))},h=function(e,i){var n='<span class="tag-label txt"></span><a class="tag-close"></a>';"author"==i&&(n='<span class="tag-label search-by">Creative: </span>'+n);var o=t("<li></li>").attr("data-tag",i).attr("data-key",e).addClass("tag-choice").html(n);return t(o).find(".tag-label.txt").text(e),t(o).find(".tag-close").off("click").click(function(e){var i=t(e.target).closest(".tag-choice");f(t(i).attr("data-tag"),t(i).attr("data-key"))}),o},p=function(t){r=[t],m()},f=function(t,e){"author"==t?a.author="":r.remove(e),m()},m=function(){t(".modal").modal("hide"),t(".scrllInterface").hide(),t("html,body").scrollTop(0),d(),g(),_scrolld.update(a)},g=function(){a.terms=r.join(","),a.page=1},v=function(e){return e=t.trim(e),e=e.toLowerCase(),"search photos"==e?!0:!1};this.changeCreative=function(t){"undefined"!=typeof t&&(a.author=t),m()},this.getTerms=function(){return r.join(",")},l()};t.fn.searchbar=function(){return this.each(function(){var i=t(this);if(!i.data("searchbar")){var n=new e(this);i.data("searchbar",n)}})}}(jQuery),$.widget("ui.autocompleteSearch",$.ui.autocomplete,{_renderItem:function(t,e){return $("<li>").attr("data-value",e.value).attr("data-type",e.type).append($("<a>").html(e.label)).appendTo(t)}}),function(t,e){{var i=(document.createElement("canvas"),document.createElement("img"),{}),n=Array(),o=!1;setInterval(function(){$(window).trigger("tick"),l()},100)}t.clickd=function(e,i){var n,o,r=_mutil.targt(e),a=$(r).data("linktyp");if(a){if(n=$(r).closest(".scrolld-item")){var s,l=$(n).data();switch(o=l.id,a){case"like":l.affiliate?t.track("Affiliate","Likebox",l.affiliate):t.track("Image_thumb","Likebox",o),t.like(o,n);break;case"affiliate":s=$(n).attr("data-affl_uri"),s||(s=$(n).data("affl_uri")),t.track("Affiliate","Click",l.affiliate),window.open(s,"_blank");break;case"img":t.track("Image_thumb","Click",o),_mipim.view(o);break;case"download":_mipim.download(o),t.track("Image_thumb","Download",o);break;case"edit":_mipim.edit(o),t.track("Image_thumb","Edit",o);break;case"share":_mipim.share(o),t.track("Image_thumb","Share",o)}}}else $(r).hasClass("avatar")||_mipim.view(i)},t.like=function(e,i,n){__mipo.logged_in?__mipo.isPro?($("#likebox-int").data("dt",n?{id:e}:$(i).data()),$("#likebox-int").data("img",$(i).find('img[data-linktyp="img"]').attr("src")),$("#likebox-int").modal("show")):t.addTolikeBox(0,e,$(i).data()):t.error({msg:"not logged in"})},t.joinclick=function(t,e,i){$(".modal").modal("hide"),$("#join").modal("show"),$("#join-form").find('input[name="username"]').val(""),$("#join-form").find('input[name="user_email"]').val(""),$("#join-form").find('input[name="password"]').val(""),$("#join-form").find('input[name="user_location"]').val(""),$("#join-form .message-box").addClass("hide"),$("#join").on("shown.bs.modal",function(t){$("#join-form").validator().off("submit").on("submit",function(t){return t.preventDefault(),$("#pwd").val()!==$("#confirmPwd").val()?($("#join-form .message-box").removeClass("hide"),$("#join-form .message").html("The password and confirm password isn't matched. Please try again."),!1):($("#join-form .message-box").addClass("hide"),$("#join-form .message").html(""),void $.ajax({method:"POST",url:"/join",data:{username:$("#join-form").find('input[name="username"]').val(),user_email:$("#join-form").find('input[name="user_email"]').val(),password:$("#join-form").find('input[name="password"]').val(),user_location:$("#join-form").find('input[name="user_location"]').val()},success:function(t){var e=JSON.parse(t);e.success?($(".modal").modal("hide"),$("#join-confirm").modal("show")):($("#join-form .message-box").removeClass("hide"),
$("#join-form .message").html(e.message))}}))})})},t.sendMessage=function(t){$("#modal-send-message").modal("show"),$("#modal-send-message").find("form").off("submit").on("submit",function(e){e.preventDefault(),e.stopPropagation();var i=$(this).serializeArray();$.ajax({url:"/creative/sendmessage/"+t,type:"POST",success:function(t){$("#modal-send-message").modal("hide")},error:function(t){},data:i,cache:!1})})},t.follow=function(e,i){__mipo.logged_in?$.ajax({url:"/creative/follow/"+e,type:"POST",success:function(t){t=JSON.parse(t);var e=$(i).find(".follow");$(e).text(t.isFollowing?"Unfollow":"Follow")},error:function(t){},data:{},cache:!1}):t.error({msg:"not logged in"})},t.addTolikeBox=function(e,i,n){$("#imgScrllPage").find("[data-id='"+i+"']").find(".notLiked, .hasLiked").addClass("hasPulse"),$.ajax({url:"/likebox/add/",type:"POST",success:function(e){e=JSON.parse(e),e.boxlist&&(__mipo.likebox=e.boxlist),t.setLikedBtn(e)},error:function(t){},data:{id:e,img:i,affiliate:n.affiliate,affl_thumb:n.affl_thumb,affl_uri:n.affl_uri},cache:!1})},t.removeFromlikeBox=function(e,i,n){$.ajax({url:"/likebox/remove/",type:"POST",success:function(e){e=JSON.parse(e),e.boxlist&&(__mipo.likebox=e.boxlist),t.setLikedBtn(e)},error:function(t){},data:{id:e,img:i,affiliate:n.affiliate},cache:!1})},t.setLikedBtn=function(t){$("#imgScrllPage").find("[data-id='"+t.unique_id+"']").find(".notLiked").hide(),$("#imgScrllPage").find("[data-id='"+t.unique_id+"']").find(".hasLiked").hide(),t.liked?$("#imgScrllPage").find("[data-id='"+t.unique_id+"']").find(".hasLiked").show():$("#imgScrllPage").find("[data-id='"+t.unique_id+"']").find(".notLiked").show(),$(".hasPulse").removeClass("hasPulse")},t.gotoLikeBox=function(t){window.location="/likebox/"+t},t.gotoLikeBoxId=function(t){window.location="/likebox/id/"+t},t.createlikeBox=function(e,i,n,o){$.ajax({url:"/likebox/create/",type:"POST",success:function(t){t.boxlist&&(__mipo.likebox=t.boxlist),o&&o()},error:function(t){},data:{title:e,img:i,affiliate:t.getCurrentAffiliate(),affl_thumb:n.affl_thumb,affl_uri:n.affl_uri},cache:!1})},t.getCurrentAffiliate=function(){var t,e="morguefile";return"undefined"!=typeof _scrolld&&(t=_scrolld._vars(),e=t.affiliate),e},t.setCookie=function(t,e,i){i||(i=new Date,i.setMonth(i.getMonth()+12)),document.cookie=t+"="+e+";expires="+i+";path=/"},t.getCookie=function(t){var e="; "+document.cookie,i=e.split("; "+t+"=");return 2==i.length?i.pop().split(";").shift():void 0},t.show_afterdown_prompt=function(){$("#modal-prmo-istock").modal("show");var e=pickRndmiSTCK();t.track("iStock_ads","View","AfterDownload_"+e.id),$("#modal-prmo-istock .istck_hotspt").off("click").on("click",function(){t.track("iStock_ads","AfterDownload_"+e.id,"Click"),window.open("http://istockphoto.7eer.net/c/160458/258922/4205?subId1=PromoBox_"+e.id+"&sharedid=PromoBox_"+e.id+"&url=http://www.istockphoto.com/plans-and-pricing"),$("#modal-prmo-istock").modal("close")}),$("#modal-prmo-istock .istckMsg").html(e.msg)},t.show_loading=function(){$("#modal-loading").modal("show")},t.hide_loading=function(){$("#modal-loading").modal("hide")},t.loading_animation=function(t){if($("#"+t).length>0)var e,i=!0,n=new Vivus(t,{duration:60,type:"oneByOne"},function(){e=setTimeout(function(){"flipd"==$("#"+t).attr("class")?$("#"+t).attr("class",""):$("#"+t).attr("class","flipd"),i?(i=!1,n.play(-1)):(i=!0,n.play(1))},500)})},t.error=function(e){e.showlogin?(t.loginRedirect=e,t.showLogin()):($("#modal-error").modal("show"),$("#modal-error").find(".err").html(e.msg))},t.track=function(t,e,i,n,o){var r={eventCategory:t,eventAction:e,eventLabel:String(i)||"",eventValue:parseFloat(n)||0,hitCallback:function(){"undefined"!=typeof o&&(window.location=o)},hitCallbackFail:function(){"undefined"!=typeof o&&(window.location=o)}};ga("send","event",r)},t.upload_choice=function(t){$("#upload_choice").toggleClass("active")},t.upload_clear=function(e){for(var o in n)"function"==typeof n[o].destroy&&n[o].destroy();t.currentQuest="",i={},n=Array()},t.showLogin=function(){$("#login").modal("show"),$("#login-form .message-box").addClass("hide"),$("#login").on("shown.bs.modal",function(t){$("#login-form").validator().on("submit",function(t){t.preventDefault(),$("#login-form .message-box").addClass("hide"),$("#login-form .message").html(""),$.ajax({method:"POST",url:"/login",data:{username:$("#userName").val(),password:$("#password").val(),rememberMe:$("#rememberMe").is(":checked")?$("#rememberMe").val():null},success:function(t){var e=JSON.parse(t);e.success?window.location.href="/":($("#login-form .message-box").removeClass("hide"),$("#login-form .message").html(e.message))}})})})},t.createQuest=function(){__mipo.logged_in?__mipo.isPro?($("#morgue-modal-init").modal("show").find(".modal-body").html($("#modal-create-quest").html()),$("#morgue-modal-init").find("form").unbind("submit").bind("submit",function(t){$.ajax({method:"GET",url:"/quest/confirmTitle/"+encodeURIComponent($('#create-quest-form [name="title"]').val()),success:function(t){var e=JSON.parse(t);e.error?$("#morgue-modal-init").find(".errors").html("<li>"+e.message+"</li>"):($("#morgue-modal-init").find(".errors").html(""),$("#morgue-modal-init").find("textarea").hide(),$("#morgue-modal-init").find("h2").text("Confirm quest title").after("<p>Make sure this quest title is correct. Once a quest is created, its title can not be changed.</p>"),$('#create-quest-form [name="title"]').val(e.hashtag),$("#morgue-modal-init").find("form").unbind("submit").bind("submit",function(t){$("#morgue-modal-init").find(".errors").html("");var e=$("#morgue-modal-init").find("form").serializeArray();$.ajax({method:"POST",data:e,url:"/quest/create"}).done(function(t){var e=JSON.parse(t);e.error?$("#morgue-modal-init").find(".errors").html("<li>"+e.message+"</li>"):window.location="/quest/created/"+encodeURIComponent(e.hashtag)}),t.preventDefault()}))}}),t.preventDefault()})):(t.track("Pro","Promo","CreateQuest"),$("#modal-gopro-quest").modal("show")):t.error({showlogin:"createQuest",msg:"not logged in"})},t.uploadWinQuest=function(e){return t.currentQuest=e,t.upload(),!1},t.fileWasUploaded=!1,t.upload=function(e){if(__mipo.logged_in){if(!t.getCookie("mf16-agreeupld"))return void $.ajax({method:"GET",data:{},url:"/image/hasagreedup/"}).done(function(i){var n=JSON.parse(i);n.hasAgreed===!1?(t.track("Agree","View","Upload"),$("#modal-agree-upload").modal("show"),$("#modal-agree-upload").find("form").off("submit").on("submit",function(i){t.track("Agree","Click","Upload"),i.preventDefault(),i.stopPropagation(),$.ajax({method:"POST",data:{},url:"/image/agreedup/"}).done(function(t){$("#modal-agree-upload").modal("hide"),r(e)})})):(t.setCookie("mf16-agreeupld",1),r(e))});r(e)}else t.error({showlogin:"upload",msg:"not logged in"})};var r=function(e){if($("#modal-upload").modal("show"),$("#modal-upload").removeClass("empty"),$("#modal-upload .headr").hide(),$("#modal-upload .progress").hide(),$("#modal-upload .headr button, #modal-upload .upload-empty").unbind("click").click(function(){$("#modal-upload .headr input").click()}),$("#modal-upload .headr input").off("change").on("change",function(e){t.upload(e.target.files)}),$("#modal-upload").off("hidden.bs.modal").on("hidden.bs.modal",function(){t.upload_clear(),t.fileWasUploaded&&(__mipo.isPro?$("#upload-confirm-pro").modal("show"):$("#upload-confirm").modal("show")),t.fileWasUploaded=!1}),t.currentQuest?(t.track("UploadWindow","Quest",t.currentQuest),$("#modal-upload").find("h5.title").html("Upload to Quest: "+t.currentQuest)):(t.track("Upload","View","Image"),$("#modal-upload").find("h5.title").html("Upload to Morguefile")),e&&e.length>0){for(var o,r=0;r<e.length;r++)if(o=e[r],o.type.match("image.*")){o._id=_mutil.guid();var s=new c(o);n.push(s),i[o._id]={elm:s,file:o,quest:t.currentQuest,done:!1,error:!1,size:parseFloat(o.size),loaded:0,percen:0,init:!1,name:o.name,start:a(s)}}}else $("#modal-upload").addClass("empty")},a=function(e){return function(){this.init=!0;var i=this,n=new FormData,o=t.currentQuest||"";n.append("file-"+this.file._id,this.file),$.ajax({url:"/image/upload/"+encodeURIComponent(o),type:"POST",xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",s.bind(i),!1),t},beforeSend:function(t){},success:function(n){i.elm.uploaded(n),t.fileWasUploaded=!0,$(e._elm).addClass("active")},error:function(t){},data:n,cache:!1,contentType:!1,processData:!1})}},s=function(t){this.loaded=t.loaded,this.percen=t.loaded/t.total*100,this.percen>=100&&(this.done=!0,t.target.removeEventListener("progress",s,!1))},l=function(){var t=0,e=0;for(var n in i){var r=i[n];r.init||r.start(),t+=parseFloat(r.size),e+=r.loaded}if(t>0){var a=Math.round(e/t*100);$("#modal-upload .progress-bar").css("width",a+"%"),o||(o=!0,$("#modal-upload .headr").hide(),$("#modal-upload .progress").fadeIn("fast")),a>=100&&(i={})}else o&&(o=!1,$("#modal-upload .progress").fadeOut("fast",function(){$("#modal-upload .headr").fadeIn()}))},c=function(t){{var e=this;t._id}return e.dt={},e.dbid=0,e.tmr=0,e.uploaded=function(t){e.dt=JSON.parse(t),e.dbid=e.dt.imgid},e._elm=$(Mustache.to_html($("#upload_elm_template_simpl").html(),t)),$("#modal-upload .upload-stage ul").append(e._elm),e};t.chip={_id:0,_elm:"",createChip:function(e,i){var n=$("<div></div>").addClass("ky").text($.trim(e)).attr("contenteditable","false").data("keyid",i);return t.chip.registerChip(n),_elm=n,n},registerChip:function(t){_elm=t,_elm._id=_mutil.guid(),$(_elm).click(function(t){t.offsetX>$(this).width()?$(this).trigger("update",["delete",_elm._id]):$(this).trigger("clickd",["id",_elm._id])})}}}(window._mip=window._mip||{}),function(t,e){function i(t,e,i){"closed"!=l?t!=r?o():(i&&(s=jQuery.extend({},i),a=s.author_id),e!=l&&(l=e,$(c).find(".modal-body").fadeOut("slow",function(){n(),$(c).find(".modal-body").fadeIn("slow")}))):(_mip.show_loading(),l=e,r=t,$.getJSON("/image/im/"+r,function(t){s=t,a=s.author_id;var e="#modal-image";$("#modal-loading").modal("hide"),$(e).off("shown.bs.modal").on("shown.bs.modal",function(){n(this),$("body, html").addClass("modal-open"),$(e+' [rel="tooltip"]').tooltip(),Modernizr.touch&&($(e).css("overflow","hidden"),setTimeout(function(){$(e).css("overflow","auto")},450))}),$(e).off("hidden.bs.modal").on("hidden.bs.modal",function(){o(this),$("body, html").removeClass("modal-open")}),$(e).modal("show")})),$("#modal-image").removeClass("img-view"),$("#modal-image").removeClass("img-view-edit"),$("#modal-image").addClass("edit"==l?"img-view-edit":"img-view")}function n(e){switch(e&&(c=e),$(c).data("id",s.unique_id),l){case"view":s.ifhasKeys=("undefined"!=typeof s.tags&&s.tags&&s.tags.length)>1?!0:!1,$(c).find(".modal-body").html(Mustache.to_html($("#imgwin_view_template").html(),s)),$(c).find(".keys li").click(function(t){_mip.track("Image_modal","Tag","",$(this).text(),"/search/morguefile/1/"+encodeURIComponent($(this).text()))}),$(c).find("#edit-add-quest").append("<input type='hidden' name='imgid' value='"+s.unique_id+"'>"),$(c).find("#edit-add-quest").append("<input type='hidden' name='authid' value='"+s.author_id+"'>"),$(c).find(".tools li").click(function(e){switch($(this).attr("data-linktyp")){case"download":_mip.track("Image_modal","Download",r),t.download(r);break;case"edit":_mip.track("Image_modal","Edit",r),t.edit(r);break;case"share":_mip.track("Image_modal","Share",r),t.share(r)}}),$(c).find("#addtoQuest").off("click").click(function(t){_mip.track("Image_modal","AddtoquestClick",r),$(c).find(".img-viewData").fadeOut("fast",function(){$(c).find(".img-addToQuest").fadeIn("fast"),$(c).find("#addtodb").off("click").click(function(t){_mip.track("Image_modal","AddtoquestSubmit",r),t.preventDefault();var e=$("#edit-add-quest").serializeArray();e.push({name:"formName",value:"edit-add-quest"}),$(c).find(".error").html(""),$.ajax({method:"POST",data:e,url:"/quest/add"}).done(function(t){var e=JSON.parse(t);e.error?$(c).find(".error").html(e.message):$(c).find(".img-addToQuest").fadeOut("fast",function(){$(c).find(".img-viewData").fadeIn("fast"),$(c).find("#removeFromQuest").show(),$(c).find("#addtoQuest").hide()})})})}),t.preventDefault(),t.stopPropagation()}),$(c).find("#removeFromQuest").off("click").click(function(t){t.preventDefault(),t.stopPropagation(),dataSend={},dataSend.imgid=$(this).attr("data-imgid"),dataSend.hashtag=$(this).attr("data-quest"),$(c).find(".error").html(""),_mip.track("Image_modal","Removefromquest",dataSend.imgid),$.ajax({method:"POST",data:dataSend,url:"/quest/remove"}).done(function(t){var e=JSON.parse(t);e.error?$(c).find(".error").html(e.message):($(c).find("#removeFromQuest").hide(),$(c).find("#addtoQuest").show())})}),$(c).find("#goToQuest").off("click").click(function(t){window.location="/quest/"+encodeURIComponent($(this).attr("data-quest"))}),$(c).find("#quest-hastag").off("focus").focus(function(t){return $(this).autocomplete({appendTo:"#modal-image .img-addToQuest .auto",minLength:3,source:"/quest/autocomplete"}),!1}),$(c).find(".tools .follow").text(s.isFollowing?"Unfollow":"Follow"),$(c).find(".tools .follow").click(function(t){_mip.track("Image_modal","Follow",r),_mip.follow(a,c)}),$(c).find(".tools .like").click(function(t){_mip.track("Image_modal","Likebox",r),_mip.like(r,c)}),$(c).find(".tools .comment").click(function(t){_mip.track("Image_modal","Comment",r,"","/image/conversation/"+r)});break;case"share":$(c).find(".modal-body").html(Mustache.to_html($("#imgwin_share_template").html(),s));break;case"edit":$(c).find(".modal-body").html(Mustache.to_html($("#imgwin_edit_template").html(),s)),new _mip.loading_animation("ldr-edit"),t.img=$(".hero"),t.initload=!0,$(c).find(".hero").load(function(e){if(t.initload){t.initload=!1,t.originalSrc=t.img.attr("src"),t.filteredSrc=t.img.attr("src"),t.imgWrapper=$(t.img).closest(".img"),t.offsetWidth=$(t.img)[0].offsetWidth,t.offsetHeight=$(t.img)[0].offsetHeight,t.naturalWidth=$(t.img)[0].naturalWidth,t.naturalHeight=$(t.img)[0].naturalHeight,t.ratio=parseFloat(t.offsetWidth/t.offsetHeight),t.src_suffix=-1!=t.img.attr("src").indexOf("cdn.morguefile.com")?t.img.attr("src").replace("https://cdn.morguefile.com/imageData/public/files/",""):t.originalSrc.split(_imgFltr.url_suffix)[1],$(".fltr-scrll").html("");for(var i=0;i<_imgFltr.filtrs.length;++i){var n=_imgFltr.filtrs[i],o="";if("css"==n.type)o='<li data-preset="'+n.name+'" data-type="css"><figure class="filter-'+n.name+'"><img src="'+t.img.attr("src")+'"/></figure></li>';else if("cloudinary"==n.type){var a=_imgFltr.url_prefix+n.uricld+_imgFltr.url_suffix+t.src_suffix;o='<li data-preset="'+n.uricld+'" data-type="cloudinary"><figure><img src="'+a+'"/></figure></li>'}$(".fltr-scrll").append(o)}$(".fltr-scrll").prepend('<li data-preset="original"><figure><img src="'+t.img.attr("src")+'"/></figure></li>'),$(".fltr-scrll li img").addClass(t.offsetWidth<t.offsetHeight?"portrait":"landscape");var s=$(".fltr-scrll");s.owlCarousel({items:7,itemsMobile:[479,3],itemsTablet:[600,4],itemsDesktopSmall:[990,5],itemsDesktop:[1200,7]}),$(".next").click(function(){s.trigger("owl.next")}),$(".prev").click(function(){s.trigger("owl.prev")}),$(".fltr-scrll li").on("click",function(t){var e=$(this).attr("data-preset"),i=$(this).attr("data-type");_imgFltr.changefilter(e,i),_mip.track("File","Filter","Click",r)}),$(c).find(".continue").on("click",function(t){_imgFltr.saveFile(r),_mip.track("File","Filter","Save",r)}),_imgFltr.reset(),_imgFltr.activate(c)}else $(t.imgWrapper).removeClass("loading")})}}function o(t){$(t).hasClass("img-view"),$(t).find(".icons").off("click"),$(t).find(".modal-body").html(""),$(t).unbind(),r=0,s={},l="closed"}var r=0,a=0,s={},l=(new signals.Signal,"closed"),c="";t.view=function(t){_mip.track("Image_modal","View",t),i(t,"view")},t.download=function(e){return _mip.getCookie("mf16-agreedown")?void t.doDownload(e):void $.ajax({method:"GET",data:{},url:"/image/hasagreeddown/"+e}).done(function(i){var n=JSON.parse(i);n.hasAgreed===!1?($("#modal-agree-download").modal("show"),_mip.track("Agree","View","Download",e),$("#modal-agree-download").find("form").off("submit").on("submit",function(i){i.preventDefault(),i.stopPropagation(),_mip.track("Agree","Click","Download"),$.ajax({method:"POST",data:{},url:"/image/agreeddown/"}).done(function(i){$("#modal-agree-download").modal("hide"),t.doDownload(e)})})):(_mip.setCookie("mf16-agreedown",1),t.doDownload(e))})},t.doDownload=function(t){var e="B3beW45g36",i=_mip.getCookie(e);setTimeout(function(){window.location="/image/download/"+t},500),setTimeout(function(){if(!i){var t=new Date;t.setDate(t.getDate()+1),_mip.setCookie(e,1,t),_mip.show_afterdown_prompt()}},1e3),_mip.track("Download","Img","",t)},t.share=function(t,e){i(t,"share",e)},t.showEmailShareImg=function(t){__mipo.logged_in?(_mip.track("ShareEmail","Click",t),$("#modal-shareimg-email").off("shown.bs.modal").on("shown.bs.modal",function(){$(this).find(".uri").html(t),$(this).find(".form-uri").val(t),$(this).find("form").off("submit").on("submit",function(e){_mip.track("ShareEmail","Submit",t),e.preventDefault(),e.stopPropagation();var i=$(this).serializeArray();return $.ajax({method:"POST",data:i,url:"/image/email"}).done(function(t){var e=JSON.parse(t);e.error?$("#morgue-modal-init").find(".errors").html("<li>"+e.message+"</li>"):$("#email-image-confirm").modal("show")}),!1})}),$("#modal-shareimg-email").modal("show")):_mip.error({msg:"not logged in"})},_mip.showLikesForImg=function(t){_mip.listingScrlldModal("/image/likes/"+t,"scrollDImgLkdtemplate")},_mip.listingScrlldModal=function(t,e){_mip.getlistingScrlldData(t+"/1",e),$("#listing").off("hide.bs.modal").on("hide.bs.modal",function(){$("#listing").infiniteScrollHelper("destroy"),$("#listingScrlld").html("")}),$("#listing").off("show.bs.modal").on("show.bs.modal",function(){$(this).css({"overflow-y":"scroll"}),$(this).infiniteScrollHelper({loadMore:function(e,i){_mip.getlistingScrlldData(t+"/"+e,"scrollDImgLkdtemplate",i)}})}),c=$("#listing").modal("show")},_mip.getlistingScrlldData=function(t,e,i){$.getJSON(t,function(t){for(var n=0;n<t.doc.length;n++){var o=$("<div></div>").html(Mustache.to_html($("#"+e).html(),t.doc[n]));$("#listingScrlld").append(o)}i&&i(t.page_count)})},t.edit=function(t){__mipo.logged_in&&__mipo.isPro?i(t,"edit"):(_mip.track("Pro","Promo","Edit"),$("#modal-gopro-edit").modal("show"))}}(window._mipim=window._mipim||{}),function(t,e){var i,n,o,r;t.filtrs=[{name:"fltr1",type:"cloudinary",uricld:"e_contrast:20/b_rgb:fff,c_fill,e_screen,l_overlay_1977_cvbycn,o_39,fl_tiled/e_brightness:10/e_saturation:30"},{name:"fltr2",type:"cloudinary",uricld:"e_hue:-8/e_saturation:-25/e_brightness:13/e_contrast:4,o_96/c_scale,e_brightness_hsb,w_1.0,fl_relative,h_1.0,l_overlay_aden_xnvsax,o_30,z_0"},{name:"fltr3",type:"cloudinary",uricld:"c_scale,e_overlay,h_1.0,l_overlay_earlybird_plm0qu,o_60,w_1.0,fl_relative/c_scale,e_screen,h_1.0,l_overlay_earlybird_plm0qu,o_59,w_1.0,fl_relative"},{name:"fltr4",type:"cloudinary",uricld:"c_scale,e_negate,l_overlay_nashville_yejwz9,o_62,fl_tiled"},{name:"fltr5",type:"cloudinary",uricld:"e_contrast:25/c_scale,e_screen,h_1.0,l_overlay_nashville_yejwz9,w_1.0,fl_relative/e_saturation:-39"},{name:"fltr6",type:"cloudinary",uricld:"e_saturation:38/c_scale,cs_srgb,e_screen,h_1.0,l_overlay_toaster_mjv15l,w_1.0,fl_relative,z_0.8"},{name:"fltr7",type:"cloudinary",uricld:"e_saturation:-39/e_blue:-8/e_brightness:22/e_fill_light:24"},{name:"fltr8",type:"cloudinary",uricld:"e_blackwhite"},{name:"fltr9",type:"cloudinary",uricld:"e_blue:-8/a_0,c_scale,e_negate,h_1.0,l_overlay_ramp_eh8do7,o_21,w_1.0,fl_relative/a_180,c_scale,e_screen,h_1.0,l_overlay_ramp_eh8do7,o_28,w_1.0,fl_relative"},{name:"fltr10",type:"cloudinary",uricld:"e_saturation:-66/e_contrast:100/c_scale,e_multiply,h_1.0,l_overlay_earlybird_plm0qu,o_43,w_1.0,fl_relative/e_brightness:41"},{name:"fltr11",type:"cloudinary",uricld:"e_grayscale"}],t.adjusts={brightness:{min:-100,max:100,step:10},contrast:{min:-100,max:100,step:10},saturation:{min:-100,max:100,step:10},sharpen:{min:0,max:500,step:10}},t.settings={adjustments:{brightness:0,contrast:0,saturation:0,sharpen:0},filter:{name:"",type:""},crop:{x:0,y:0,w:0,h:0},cropArea:{x:0,y:0,w:0,h:0}},t.url_prefix="https://res.cloudinary.com/morguefile/image/upload/",t.url_suffix="/v1455655213/prod/",t.activate=function(e){{var i=($(e).find(".img").first(),"");$(_mipim.img)[0].naturalWidth,$(_mipim.img)[0].naturalWidth}t.modal=$(e),t.settings.cropArea={x1:0,x2:0,y1:0,y2:0,w:0,h:0},$(e).find("#adjust_draw .adjust-menu a").on("click",function(n){i=$(n.target).attr("data-type"),$(e).find("#adjust_draw .sldr .sld").html('<input id="sldrAdjst" data-slider-id="sldrAdjstSlider" type="text" data-slider-min="'+t.adjusts[i].min+'" data-slider-max="'+t.adjusts[i].max+'" data-slider-step="'+t.adjusts[i].step+'" data-slider-value="'+t.settings.adjustments[i]+'" data-slider-type="'+i+'"/>'),$(e).find("#adjust_draw .sldr .type").html('<span class="'+i+'-icon type-icon"></span>'),$(e).find("#adjust_draw .sldr").show(),$(e).find("#adjust_draw .adjust-menu").hide(),r=_mutil.cloneObject(t.settings),o=$("#sldrAdjst").slider().on("slideStop",function(e){var i=$(e.currentTarget).attr("data-slider-type");t.makeAdjustment(i,e.value)})}),$(e).find("#adjust_draw .commit").on("click",function(t){$(e).find("#adjust_draw .sldr").hide(),$(e).find("#adjust_draw .adjust-menu").show()}),$(e).find("#adjust_draw .cancel").on("click",function(n){t.settings.adjustments[i]=0,t.apply(),$(e).find("#adjust_draw .sldr").hide(),$(e).find("#adjust_draw .adjust-menu").show()}),$(e).find('a[data-toggle="tab"]').on("shown.bs.tab",function(t){"#crop_draw"==$(t.target).attr("href")?l():s()});{var n=new Cropper(_mipim.img[0],{crop:function(e){if($(".cropper-container").is(":visible")){var i=$(".cropper-canvas img").position();t.settings.crop={x:0-i.left+e.detail.x,y:0-i.top+e.detail.y,w:e.detail.width,h:e.detail.height,scale:e.detail.scaleX,rotate:e.detail.rotate},a()}},zoomable:!1,built:function(){s()}});$("#sldrAdjstScl").slider().on("slide",function(t){n.scale(t.value/100)})}$(e).find("#crop_draw .commit").on("click",function(e){t.cropImage()}),$(e).find("#crop_draw .crop-lock-size").on("change",function(t){if(this.checked){var e=n.getData();n.setAspectRatio(e.width/e.height)}else n.setAspectRatio(0)});var a=function(){var i=$(e).find("#crop_draw .crop-width");$(i).is(":focus")||$(e).find("#crop_draw .crop-width").val(parseInt(t.settings.crop.w)),i=$(e).find("#crop_draw .crop-height"),$(i).is(":focus")||$(e).find("#crop_draw .crop-height").val(parseInt(t.settings.crop.h))},s=function(){$(".cropper-hidden").attr({style:"display:block !important"}),$(".cropper-container").hide()},l=function(){$(".cropper-hidden").hide(),$(".cropper-container").show()}},t.cropImage=function(){t.settings.cropped=!0,t.apply(),$('.nav-tabs a[href="#fltr_draw"]').tab("show")}.bind(t),t.setCropArea=function(){},t.getCropArea=function(){t.settings.cropArea.w=parseInt($("#crop_draw .crop-width").val()),t.settings.cropArea.h=parseInt($("#crop_draw .crop-height").val())},t.changefilter=function(e,i){t.settings.filter="original"==e?{name:"",type:""}:{name:e,type:i},t.apply()},t.makeAdjustment=function(e,i){t.settings.adjustments[e]=i,t.apply()},t.reset=function(){i=$(_mipim.img).width(),n=$(_mipim.img).height(),t.settings={adjustments:{brightness:0,contrast:0,saturation:0,sharpen:0},filter:{name:"",type:""},crop:{x:0,y:0,w:0,h:0},cropArea:{x:0,y:0,w:0,h:0}}},t.apply=function(){var e="",i="";if($(_mipim.imgWrapper).attr("class","img").addClass("loading"),t.settings.cropped&&0!==t.settings.crop.w&&0!==t.settings.crop.h){var n=parseFloat(Math.round(100*t.settings.crop.scale)/100).toFixed(1);e+="w_"+n+",h_"+n+",c_scale/x_"+parseInt(t.settings.crop.x)+",y_"+parseInt(t.settings.crop.y)+",w_"+parseInt(t.settings.crop.w)+",h_"+parseInt(t.settings.crop.h)+",c_crop/"}""===t.settings.filter.name?$(_mipim.img).attr("src",_mipim.originalSrc):"css"==t.settings.filter.type?($(_mipim.imgWrapper).removeClass("loading").addClass("filter-"+t.settings.filter.name),$(_mipim.img).attr("src",_mipim.originalSrc)):e+=t.settings.filter.name,e+="/",e+="e_brightness:"+t.settings.adjustments.brightness+"/",e+="e_contrast:"+t.settings.adjustments.contrast+"/",e+="e_saturation:"+t.settings.adjustments.saturation+"/",e+="e_sharpen:"+t.settings.adjustments.sharpen,""!==e&&(i=t.url_prefix+e+t.url_suffix+_mipim.src_suffix,_mipim.filteredSrc=i,$(_mipim.img).attr("src",i))},t.saveFile=function(e){var i="",n="";if(t.settings.cropped&&0!==t.settings.crop.w&&0!==t.settings.crop.h){var o=parseFloat(Math.round(100*t.settings.crop.scale)/100).toFixed(1);i+="w_"+o+",h_"+o+",c_scale/x_"+parseInt(t.settings.crop.x)+",y_"+parseInt(t.settings.crop.y)+",w_"+parseInt(t.settings.crop.w)+",h_"+parseInt(t.settings.crop.h)+",c_crop/"}""!==t.settings.filter.name&&(i+=t.settings.filter.name+"/"),i+="e_brightness:"+t.settings.adjustments.brightness+"/",i+="e_contrast:"+t.settings.adjustments.contrast+"/",i+="e_saturation:"+t.settings.adjustments.saturation+"/",i+="e_sharpen:"+t.settings.adjustments.sharpen,n=t.url_prefix+i+t.url_suffix+_mipim.src_suffix,$.ajax({url:"/image/imageedit/"+e,type:"POST",data:{url:n},cache:!1,success:function(t){t=JSON.parse(t),_mipim.share(e,t)},error:function(t){console.log(data)}})}}(window._imgFltr=window._imgFltr||{}),function(t,e){t.resize=function(t,e,i,n){var o=document.createElement("canvas"),r=document.createElement("img"),a=new FileReader;a.onload=function(a){r.src=a.target.result,r.onload=function(r){var a=o.getContext("2d");a.drawImage(this,0,0);var s=this.width,l=this.height;s>l?s>e&&(l*=e/s,s=e):l>i&&(s*=i/l,l=i),o.width=s,o.height=l,a=o.getContext("2d"),a.drawImage(this,0,0,s,l);var c={uri:o.toDataURL("image/png"),title:t.name};n(c)}},a.readAsDataURL(t)}}(window._img=window._img||{}),function(t,e){t.guid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},t.cloneObject=function(t){if(null===t||"object"!=typeof t)return t;var e=t.constructor();for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},t.targt=function(t){if(!Modernizr.touch)return t.target;if(null!==t.originalEvent.changedTouches&&"object"==typeof t.originalEvent.changedTouches){var e=t.originalEvent.changedTouches[0];return document.elementFromPoint(e.clientX,e.clientY)}},t.getQueryParameterByName=function(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),n=i.exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},t.getPathFromUrl=function(t){return t||(t=window.location.href),t.split(/[?#]/)[0]}}(window._mutil=window._mutil||{}),function(t){function e(){this.fake=!0,this.boundary="--------FormData"+Math.random(),this._fields=[]}t.FormData||(e.prototype.append=function(t,e){this._fields.push([t,e])},e.prototype.toString=function(){var t=this.boundary,e="";return this._fields.forEach(function(i){if(e+="--"+t+"\r\n",i[1].name){var n=i[1];e+='Content-Disposition: form-data; name="'+i[0]+'"; filename="'+n.name+'"\r\n',e+="Content-Type: "+n.type+"\r\n\r\n",e+=n.getAsBinary()+"\r\n"}else e+='Content-Disposition: form-data; name="'+i[0]+'";\r\n\r\n',e+=i[1]+"\r\n"}),e+="--"+t+"--"},t.FormData=e)}(window);var ___ad_prompt=!1;